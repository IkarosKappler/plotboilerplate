/*!
 * PlotBoilerplate,
 * Git branch https://github.com/IkarosKappler/plot-boilerplate/commit/53f2faf
 */!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){i(2),i(3),i(4),i(5),i(6),i(7),i(8),i(9),i(10),i(11),i(12),i(13),i(14),i(15),t.exports=i(16)},function(t,e){!function(t){"use strict";var e=function(){for(var t in this.draggable=!0,this.isSelected=!1,e.model)this[t]=e.model[t]};e.model={draggable:!0,isSelected:!1},t.VertexAttr=e}(window)},function(t,e){!function(t){"use strict";var e=function(t){this.drag=[],this.dragStart=[],this.dragEnd=[],this.vertex=t};e.prototype.addDragListener=function(t){this.drag.push(t)},e.prototype.addDragStartListener=function(t){this.dragStart.push(t)},e.prototype.addDragEndListener=function(t){this.dragEnd.push(t)},e.prototype.fireDragEvent=function(t){i(this,this.drag,t)},e.prototype.fireDragStartEvent=function(t){i(this,this.dragStart,t)},e.prototype.fireDragEndEvent=function(t){i(this,this.dragEnd,t)};var i=function(t,e,i){for(var s in void 0===i.params&&(i.params={}),i.params.vertex=t.vertex,e)e[s](i)};t.VertexListeners=e}(window)},function(t,e){var i,s;i=window||t.exports,(s=i.Vertex=function(t,e){"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),this.attr=new VertexAttr,this.listeners=new VertexListeners(this)}).prototype.set=function(t,e){return"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),this},s.prototype.add=function(t,e){return"number"==typeof t?(this.x+=t,"number"==typeof e&&(this.y+=e)):(this.x+=t.x,this.y+=t.y),this},s.prototype.addXY=function(t,e){return this.x+=t,this.y+=e,this},s.prototype.sub=function(t,e){return"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y?(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=e),this},s.prototype.equals=function(t){var e=Math.abs(this.x-t.x)<1e-6,i=Math.abs(this.y-t.y)<1e-6;return e&&i},s.prototype.clone=function(){return new s(this.x,this.y)},s.prototype.distance=function(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))},s.prototype.scale=function(t,e){return e&&void 0!==e||(e=new s(0,0)),this.x=e.x+(this.x-e.x)*t,this.y=e.y+(this.y-e.y)*t,this},s.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},s.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},s.prototype.inv=function(){return this.x=-this.x,this.y=-this.y,this},s.prototype.toString=function(){return"("+this.x+","+this.y+")"}},function(t,e,i){(function(t){var e;(e=window||t.export).Grid=function(t,e){this.center=t,this.size=e},e.Grid.utils={baseLog:function(t,e){return Math.log(t)/Math.log(e)},mapRasterScale:function(t,e){var i=1;return e>=1?(i=Math.abs(Math.floor(1/Grid.utils.baseLog(t,e))),i=1/Math.pow(t,i)):i=Math.abs(Math.floor(Grid.utils.baseLog(1/t,1/(e+1)))),i}}}).call(this,i(0)(t))},function(t,e,i){(function(t){!function(t){var e=function(t,e){this.a=t,this.b=e};e.prototype.length=function(){return Math.sqrt(Math.pow(this.b.x-this.a.x,2)+Math.pow(this.b.y-this.a.y,2))},e.prototype.sub=function(t){return new e(this.a.sub(t),this.b.sub(t))},e.prototype.normalize=function(){this.b.set(this.a.x+(this.b.x-this.a.x)/this.length(),this.a.y+(this.b.y-this.a.y)/this.length())},e.prototype.scale=function(t){this.b.set(this.a.x+(this.b.x-this.a.x)*t,this.a.y+(this.b.y-this.a.y)*t)},e.prototype.angle=function(t){var e=this.b.clone().sub(this.a),i=t.b.clone().sub(t.a);return Math.atan2(i.x,i.y)-Math.atan2(e.x,e.y)},e.prototype.vertAt=function(t){return new Vertex(this.a.x+(this.b.x-this.a.x)*t,this.a.y+(this.b.y-this.a.y)*t)},e.prototype.intersection=function(t){var e=(t.b.y-t.a.y)*(this.b.x-this.a.x)-(t.b.x-t.a.x)*(this.b.y-this.a.y);if(0==e)return null;var i=this.a.y-t.a.y,s=this.a.x-t.a.x,n=(t.b.x-t.a.x)*i-(t.b.y-t.a.y)*s,r=(this.b.x-this.a.x)*i-(this.b.y-this.a.y)*s;return i=n/e,s=r/e,new Point(this.a.x+i*(this.b.x-this.a.x),this.a.y+i*(this.b.y-this.a.y))},e.prototype.toSVGString=function(t){t=t||{};var e=[];return e.push("<line"),t.className&&e.push(' class="'+t.className+'"'),e.push(' x1="'+this.a.x+'"'),e.push(' y1="'+this.a.y+'"'),e.push(' x2="'+this.b.x+'"'),e.push(' y2="'+this.b.y+'"'),e.push(" />"),e.join("")},this.toString=function(){return"{ a : "+this.a.toString()+", b : "+this.b.toString()+" }"},t.Line=e}(window||t.export)}).call(this,i(0)(t))},function(t,e){!function(t){"use strict";var e=function(t,e,i,s){Object.call(this),this.startPoint=t,this.startControlPoint=i,this.endPoint=e,this.endControlPoint=s,this.curveIntervals=30,this.segmentCache=[],this.segmentLengths=[],this.arcLength=null,this.updateArcLengths()};e.START_POINT=0,e.START_CONTROL_POINT=1,e.END_CONTROL_POINT=2,e.END_POINT=3,(e.prototype=new Object).constructor=e,e.prototype.START_POINT=0,e.prototype.START_CONTROL_POINT=1,e.prototype.END_CONTROL_POINT=2,e.prototype.END_POINT=3,e.prototype.moveCurvePoint=function(t,e,i,s){t==this.START_POINT?(this.getStartPoint().add(e),i&&this.getStartControlPoint().add(e)):t==this.START_CONTROL_POINT?this.getStartControlPoint().add(e):t==this.END_CONTROL_POINT?this.getEndControlPoint().add(e):t==this.END_POINT?(this.getEndPoint().add(e),i&&this.getEndControlPoint().add(e)):console.log("[IKRS.CubicBezierCurve.moveCurvePoint] pointID '"+t+"' invalid."),s&&this.updateArcLengths()},e.prototype.translate=function(t){this.startPoint.add(t),this.startControlPoint.add(t),this.endControlPoint.add(t),this.endPoint.add(t)},e._scalePoint=function(t,e,i){t.sub(e),t.setX(t.x*i.x),t.setY(t.y*i.y),t.add(e)},e.prototype.getLength=function(){return this.arcLength},e.prototype.locateCurveByPoint=function(t){for(var e=0;e<this.bezierCurves.length;e++)if(this.bezierCurves[e].startPoint.equals(t)||this.bezierCurves[e].endPoint.equals(t))return e;return-1},e.prototype.computeVerticalAreaSize=function(t,e,i){if(0==e)throw"Cannot compute bezier curve's vertical area size with delta=0.";if(this.segmentCache.length<=1)return 0;for(var s=0,n=0;n+1<this.segmentCache.length;n++)s+=this._computeVerticalAreaSizeForSegment(t,e,i,n);return s},e.prototype._computeVerticalAreaSizeForSegment=function(t,e,i,s){if(s+1>=this.segmentCache.length)return 0;var n=this.segmentCache[s],r=this.segmentCache[s+1],o=r.y-n.y,a=t-n.x,h=t-r.x,c=h+(a-h)/2;return i?Math.abs(o*c):o*c},e.prototype.computeVerticalRevolutionVolumeSize=function(t,e){if(this.segmentCache.length<=1)return 0;for(var i=0,s=0;s+1<this.segmentCache.length;s++)i+=this._computeVerticalRevolutionVolumeSizeForSegment(t,e,s);return i},e.prototype._computeVerticalRevolutionVolumeSizeForSegment=function(t,e,i){if(i+1>=this.segmentCache.length)return 0;var s=this.segmentCache[i],n=this.segmentCache[i+1],r=n.y-s.y,o=(t-s.x+(t-n.x))/2,a=Math.PI*Math.pow(o,2)*r;return e?Math.abs(a):a},e.prototype.updateArcLengths=function(){var t=new Vertex(this.startPoint.x,this.startPoint.y),e=new Vertex(0,0),i=1/this.curveIntervals;this.segmentCache=[],this.segmentCache.push(this.startPoint),this.segmentLengths=[],this.arcLength=0;for(var s=0;s<this.curveIntervals;s++){e=this.getPoint((s+1)*i),this.segmentCache.push(e);var n=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));this.segmentLengths.push(n),this.arcLength+=n,t=e,i}},e.prototype.getStartPoint=function(){return this.startPoint},e.prototype.getEndPoint=function(){return this.endPoint},e.prototype.getStartControlPoint=function(){return this.startControlPoint},e.prototype.getEndControlPoint=function(){return this.endControlPoint},e.prototype.getPointByID=function(t){if(t==this.START_POINT)return this.startPoint;if(t==this.END_POINT)return this.endPoint;if(t==this.START_CONTROL_POINT)return this.startControlPoint;if(t==this.END_CONTROL_POINT)return this.endControlPoint;throw"Invalid point ID '"+t+"'."},e.prototype.getPoint=function(t){var e=this.startPoint.x*Math.pow(1-t,3)+3*this.startControlPoint.x*t*Math.pow(1-t,2)+3*this.endControlPoint.x*Math.pow(t,2)*(1-t)+this.endPoint.x*Math.pow(t,3),i=this.startPoint.y*Math.pow(1-t,3)+3*this.startControlPoint.y*t*Math.pow(1-t,2)+3*this.endControlPoint.y*Math.pow(t,2)*(1-t)+this.endPoint.y*Math.pow(t,3);return new Vertex(e,i)},e.prototype.getPointAt=function(t){return this.getPoint(t/this.arcLength)},e.prototype.getTangent=function(t){var e=this.getStartPoint(),i=this.getStartControlPoint(),s=this.getEndControlPoint(),n=this.getEndPoint(),r=t*t,o=1-2*t+r,a=-3*e.x*o+i.x*(3*o-6*(t-r))+s.x*(6*(t-r)-3*r)+3*n.x*r,h=-3*e.y*o+i.y*(3*o-6*(t-r))+s.y*(6*(t-r)-3*r)+3*n.y*r;return new Vertex(a,h)},e.prototype.convertU2T=function(t){return Math.max(0,Math.min(1,t/this.arcLength))},e.prototype.getTangentAt=function(t){return this.getTangent(this.convertU2T(t))},e.prototype.getPerpendicularAt=function(t){return this.getPerpendicular(this.convertU2T(t))},e.prototype.getPerpendicular=function(t){var e=this.getTangent(t);return new Vertex(e.y,-e.x)},e.prototype.computeBoundingBox=function(){return BoundingBox2.computeFromPoints(this.segmentCache)},e.prototype.clone=function(){return new e(this.getStartPoint().clone(),this.getEndPoint().clone(),this.getStartControlPoint().clone(),this.getEndControlPoint().clone())},e.prototype.equals=function(t){return!!t&&(!!(t.startPoint&&t.endPoint&&t.startControlPoint&&t.endControlPoint)&&(this.startPoint.equals(t.startPoint)&&this.endPoint.equals(t.endPoint)&&this.startControlPoint.equals(t.startControlPoint)&&this.endControlPoint.equals(t.endControlPoint)))},e.prototype.toSVGPathData=function(){var t=[];return t.push("M "),t.push(this.startPoint.x),t.push(" "),t.push(this.startPoint.y),t.push(" C "),t.push(this.startControlPoint.x),t.push(" "),t.push(this.startControlPoint.y),t.push(" "),t.push(this.endControlPoint.x),t.push(" "),t.push(this.endControlPoint.y),t.push(" "),t.push(this.endPoint.x),t.push(" "),t.push(this.endPoint.y),t.join("")},e.prototype.toJSON=function(t){return"{ "+(t?"\n\t":"")+'"startPoint" : ['+this.getStartPoint().x+","+this.getStartPoint().y+"], "+(t?"\n\t":"")+'"endPoint" : ['+this.getEndPoint().x+","+this.getEndPoint().y+"], "+(t?"\n\t":"")+'"startControlPoint": ['+this.getStartControlPoint().x+","+this.getStartControlPoint().y+"], "+(t?"\n\t":"")+'"endControlPoint" : ['+this.getEndControlPoint().x+","+this.getEndControlPoint().y+"]"+(t?"\n\t":"")+" }"},e.fromJSON=function(t){var i=JSON.parse(t);return e.fromObject(i)},e.fromObject=function(t){if("object"!=typeof t)throw"[IKRS.CubicBezierCurve.fromObject] Can only build from object.";if(!t.startPoint)throw'[IKRS.CubicBezierCurve.fromObject] Object member "startPoint" missing.';if(!t.endPoint)throw'[IKRS.CubicBezierCurve.fromObject] Object member "endPoint" missing.';if(!t.startControlPoint)throw'[IKRS.CubicBezierCurve.fromObject] Object member "startControlPoint" missing.';if(!t.endControlPoint)throw'[IKRS.CubicBezierCurve.fromObject] Object member "endControlPoint" missing.';return new e(new Vertex(t.startPoint[0],t.startPoint[1]),new Vertex(t.endPoint[0],t.endPoint[1]),new Vertex(t.startControlPoint[0],t.startControlPoint[1]),new Vertex(t.endControlPoint[0],t.endControlPoint[1]))},e.fromArray=function(t){if(!Array.isArray(t))throw"[IKRS.CubicBezierCurve.fromArray] Can only build from object.";if(4!=t.length)throw"[IKRS.CubicBezierCurve.fromArray] Can only build from array with four elements.";return new e(t[0],t[1],t[2],t[3])},t.CubicBezierCurve=e}(window)},function(t,e){!function(t){"use strict";var e=function(t){Object.call(this),t||(t=[]),this.totalArcLength=0,this.adjustCircular=!1,this.bezierCurves=[];for(var e=1;e<t.length;e++){var i=new THREE.Box2(t[e].x-t[e-1].x,t[e].y-t[e-1].y),s=new CubicBezierCurve(t[e-1],t[e],new Vertex(t[e-1].x,t[e-1].y-i.min/2),new Vertex(t[e].x+i.max/2,t[e].y));this.bezierCurves.push(s),this.totalArcLength+=s.getLength(),this.bezierCurves.length>=2&&this.adjustSuccessorControlPoint(this.bezierCurves.length-2,!0,!0)}};e.prototype.constructor=e,e.START_POINT=0,e.START_CONTROL_POINT=1,e.END_CONTROL_POINT=2,e.END_POINT=3,e.prototype.START_POINT=0,e.prototype.START_CONTROL_POINT=1,e.prototype.END_CONTROL_POINT=2,e.prototype.END_POINT=3,e.prototype.addCurve=function(t){if(null==t||void 0===t)throw"Cannot add null curve to bézier path.";this.bezierCurves.push(t),this.bezierCurves.length>1?(t.startPoint=this.bezierCurves[this.bezierCurves.length-2].endPoint,this.adjustSuccessorControlPoint(this.bezierCurves.length-2,!0,!0)):this.totalArcLength+=t.getLength()},e.prototype.locateCurveByStartPoint=function(t){for(var e in this.bezierCurves)if(this.bezierCurves[e].startPoint.equals(t))return e;return-1},e.prototype.locateCurveByStartControlPoint=function(t){for(var e in this.bezierCurves)if(this.bezierCurves[e].startControlPoint.equals(t))return e;return-1},e.prototype.locateCurveByEndControlPoint=function(t){for(var e in this.bezierCurves)if(this.bezierCurves[e].endControlPoint.equals(t))return e;return-1},e.prototype.getLength=function(){return this.totalArcLength},e.prototype.computeVerticalAreaSize=function(t,e){for(var i=this.computeBoundingBox().xMax,s=0,n=0;n<this.bezierCurves.length;n++)s+=this.bezierCurves[n].computeVerticalAreaSize(i,t,e);return s},e.prototype.computeVerticalRevolutionVolumeSize=function(t){for(var e=this.computeBoundingBox().xMax,i=0,s=0;s<this.bezierCurves.length;s++)i+=this.bezierCurves[s].computeVerticalRevolutionVolumeSize(e,t);return i},e.prototype.updateArcLengths=function(){this.totalArcLength=0;for(var t=0;t<this.bezierCurves.length;t++)this.bezierCurves[t].updateArcLengths(),this.totalArcLength+=this.bezierCurves[t].getLength()},e.prototype.getCurveCount=function(){return this.bezierCurves.length},e.prototype.getCurveAt=function(t){return this.bezierCurves[t]},e.prototype.removeEndPoint=function(){if(this.bezierCurves.length<=1)return!1;for(var t=[this.bezierCurves.length-1],e=0;e<this.bezierCurves.length-1;e++)t[e]=this.bezierCurves[e];return this.totalArcLength-=this.bezierCurves[this.bezierCurves.length-1].getLength(),this.bezierCurves=t,!0},e.prototype.removeStartPoint=function(){if(this.bezierCurves.length<=1)return!1;for(var t=[this.bezierCurves.length-1],e=1;e<this.bezierCurves.length;e++)t[e-1]=this.bezierCurves[e];return this.totalArcLength-=this.bezierCurves[0].getLength(),this.bezierCurves=t,!0},e.prototype.joinAt=function(t){if(t<0||t>=this.bezierCurves.length)return!1;var e=this.bezierCurves[t-1],i=this.bezierCurves[t],s=e.getStartControlPoint().clone();s.sub(e.getStartPoint()),s.multiplyScalar(2),s.add(e.getStartPoint());var n=i.getEndControlPoint().clone();n.sub(i.getEndPoint()),n.multiplyScalar(2),n.add(i.getEndPoint());for(var r=new IKRS.CubicBezierCurve(e.getStartPoint(),i.getEndPoint(),s,n),o=[this.bezierCurves.length-1],a=0;a<t-1;a++)o[a]=this.bezierCurves[a];o[t-1]=r;for(a=t;a+1<this.bezierCurves.length;a++)o[a]=this.bezierCurves[a+1];return this.bezierCurves=o,this.updateArcLengths(),!0},e.prototype.splitAt=function(t,e){if(t<0||t>=this.bezierCurves.length)return!1;var i=this.bezierCurves[t];if(e<1||e-1>=i.segmentCache.length)return!1;for(var s=this.bezierCurves.length;s>t;s--)this.bezierCurves[s]=this.bezierCurves[s-1];for(var n=0,r=0;r<e;r++)n+=i.segmentLengths[r];var o=i.getTangentAt(n);o=o.multiplyScalar(.25);var a=i.segmentCache[e].clone();a.sub(o);var h=i.segmentCache[e].clone();h.add(o);var c=i.getStartControlPoint().clone();c.sub(i.getStartPoint()),c.multiplyScalar(.25),c.add(i.getStartPoint());var l=i.getEndControlPoint().clone();l.sub(i.getEndPoint()),l.multiplyScalar(.25),l.add(i.getEndPoint());var u=new CubicBezierCurve(i.getStartPoint(),i.segmentCache[e],c,a),d=new CubicBezierCurve(i.segmentCache[e],i.getEndPoint(),h,l);return this.bezierCurves[t]=u,this.bezierCurves[t+1]=d,this.totalArcLength-=i.getLength(),this.totalArcLength+=u.getLength(),this.totalArcLength+=d.getLength(),!0},e.prototype.translate=function(t){for(var e=0;e<this.bezierCurves.length;e++){(i=this.bezierCurves[e]).getStartPoint().add(t),i.getStartControlPoint().add(t),i.getEndControlPoint().add(t)}var i;(i=this.bezierCurves[this.bezierCurves.length-1]).getEndPoint().add(t),this.updateArcLengths()},e.prototype.scale=function(t,i){for(var s=0;s<this.bezierCurves.length;s++){var n=this.bezierCurves[s];e._scalePoint(n.getStartPoint(),t,i),e._scalePoint(n.getStartControlPoint(),t,i),e._scalePoint(n.getEndControlPoint(),t,i)}this.bezierCurves.length>0&&e._scalePoint(this.bezierCurves[this.bezierCurves.length-1].getEndPoint(),t,i),this.updateArcLengths()},e._scalePoint=function(t,e,i){t.sub(e),t.setX(t.x*i.x),t.setY(t.y*i.y),t.add(e)},e.prototype.getPointAt=function(t){if(t<0||t>this.totalArcLength)return console.log("[IKRS.BezierPath.getPointAt(u)] u is out of bounds: "+t+"."),null;for(var e=0,i=0;e<this.bezierCurves.length&&i+this.bezierCurves[e].getLength()<t;)i+=this.bezierCurves[e].getLength(),e++;if(e>=this.bezierCurves.length)return this.bezierCurves[this.bezierCurves.length-1].getEndPoint().clone();var s=t-i;return this.bezierCurves[e].getPointAt(s)},e.prototype.getPoint=function(t){return this.getPointAt(t*this.totalArcLength)},e.prototype.getTangent=function(t){return this.getTangentAt(t*this.totalArcLength)},e.prototype.getTangentAt=function(t){if(t<0||t>this.totalArcLength)return console.warn("[BezierPath.getTangentAt(u)] u is out of bounds: "+t+"."),null;for(var e=0,i=0;e<this.bezierCurves.length&&i+this.bezierCurves[e].getLength()<t;)i+=this.bezierCurves[e].getLength(),e++;var s=t-i;return this.bezierCurves[e].getTangentAt(s)},e.prototype.getPerpendicular=function(t){return this.getPerpendicularAt(t*this.totalArcLength)},e.prototype.getPerpendicularAt=function(t){if(t<0||t>this.totalArcLength)return console.log("[IKRS.BezierPath.getPerpendicularAt(u)] u is out of bounds: "+t+"."),null;for(var e=0,i=0;e<this.bezierCurves.length&&i+this.bezierCurves[e].getLength()<t;)i+=this.bezierCurves[e].getLength(),e++;var s=t-i;return this.bezierCurves[e].getPerpendicularAt(s)},e.prototype.computeBoundingBox=function(){if(0==this.bezierCurves.length)return new BoundingBox(0,0,0,0);for(var t=this.bezierCurves[0].computeBoundingBox(),e=1;e<this.bezierCurves.length;e++){var i=this.bezierCurves[e].computeBoundingBox();t.xMin=Math.min(t.xMin,i.xMin),t.xMax=Math.max(t.xMax,i.xMax),t.yMin=Math.min(t.yMin,i.yMin),t.yMax=Math.max(t.yMax,i.yMax)}return t},e.prototype.moveCurvePoint=function(t,e,i){if(this.getCurveAt(t).moveCurvePoint(e,i,!0,!0),e==this.START_POINT&&(t>0||this.adjustCircular))this.getCurveAt(t-1<0?this.bezierCurves.length+(t-1):t-1).moveCurvePoint(this.END_CONTROL_POINT,i,!0,!1);else if(e==this.END_POINT&&(t+1<this.bezierCurves.length||this.adjustCircular)){this.getCurveAt((t+1)%this.bezierCurves.length).moveCurvePoint(this.START_CONTROL_POINT,i,!0,!1)}else e==this.START_CONTROL_POINT&&t>0?this.adjustPredecessorControlPoint(t,!0,!1):e==this.END_CONTROL_POINT&&t+1<this.getCurveCount()&&this.adjustSuccessorControlPoint(t,!0,!1);this.updateArcLengths()},e.prototype.adjustPredecessorControlPoint=function(t,e,i){if(!this.adjustCircular&&t<=0)return!1;var s=this.getCurveAt(t),n=this.getCurveAt(t-1<0?this.getCurveCount()+(t-1):t-1);return this.adjustNeighbourControlPoint(s,n,s.getStartPoint(),s.getStartControlPoint(),n.getEndPoint(),n.getEndControlPoint(),e,i)},e.prototype.adjustSuccessorControlPoint=function(t,e,i){if(!this.adjustCirculat&&t+1>this.getCurveCount())return!1;var s=this.getCurveAt(t),n=this.getCurveAt((t+1)%this.getCurveCount());return this.adjustNeighbourControlPoint(s,n,s.getEndPoint(),s.getEndControlPoint(),n.getStartPoint(),n.getStartControlPoint(),e,i)},e.prototype.adjustNeighbourControlPoint=function(t,e,i,s,n,r,o,a){var h=new Vertex(s.x-i.x,s.y-i.y),c=new Vertex(r.x-n.x,r.y-n.y),l=Math.sqrt(Math.pow(h.x,2)+Math.pow(h.y,2)),u=Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2));l<=.1||(r.set(n.x-h.x*(u/l),n.y-h.y*(u/l)),e.updateArcLengths())},e.prototype.clone=function(){for(var t=new e(null),i=0;i<this.bezierCurves.length;i++)t.bezierCurves.push(this.bezierCurves[i].clone()),i>0&&(t.bezierCurves[i-1].endPoint=t.bezierCurves[i].startPoint);return t.updateArcLengths(),t},e.prototype.equals=function(t){if(!t)return!1;if(!t.bezierCurves)return!1;if(void 0===t.bezierCurves.length)return!1;if(t.bezierCurves.length!=this.bezierCurves.length)return!1;for(var e=0;e<this.bezierCurves.length;e++)if(!this.bezierCurves[e].equals(t.bezierCurves[e]))return!1;return!0},e.prototype.toSVGString=function(t){t=t||{};var e=[];e.push("<path"),t.className&&e.push(' class="'+t.className+'"'),e.push(' d="');for(var i=0;i<this.bezierCurves.length;i++)i>0&&e.push(" "),e.push(this.bezierCurves[i].toSVGPathData());return e.push('" />'),e.join("")},e.prototype.toJSON=function(t){var e=[];e.push("[");for(var i=0;i<this.bezierCurves.length;i++)i>0&&e.push(","),t?e.push("\n\t"):e.push(" "),e.push(this.bezierCurves[i].toJSON(t));return 0!=this.bezierCurves.length&&e.push(" "),e.push("]"),e.join("")},e.fromJSON=function(t){var e=JSON.parse(t);return IKRS.BezierPath.fromArray(e)},e.fromArray=function(t){if(!Array.isArray(t))throw"[IKRS.BezierPath.fromArray] Passed object must be an array.";if(t.length<1)throw"[IKRS.BezierPath.fromArray] Passed array must contain at least one bezier curve (has "+t.length+").";for(var i=new e(null),s=null,n=0;n<t.length;n++){var r=null;r=0 in t[n]&&1 in t[n]&&2 in t[n]&&3 in t[n]?CubicBezierCurve.fromArray(t[n]):CubicBezierCurve.fromObject(t[n]),s&&(r.startPoint=s.endPoint),i.bezierCurves.push(r),i.totalArcLength+=r.getLength(),s=r}return i},e.prototype.toReducedListRepresentation=function(t){void 0===t&&(t=1);var i=[];i.push("[");for(var s=0;s<this.bezierCurves.length;s++){var n=this.bezierCurves[s];i.push(e._roundToDigits(n.getStartPoint().x,t,!1)),i.push(","),i.push(e._roundToDigits(n.getStartPoint().y,t,!1)),i.push(","),i.push(e._roundToDigits(n.getStartControlPoint().x,t,!1)),i.push(","),i.push(IKRS.BezierPath._roundToDigits(n.getStartControlPoint().y,t,!1)),i.push(","),i.push(e._roundToDigits(n.getEndControlPoint().x,t,!1)),i.push(","),i.push(e._roundToDigits(n.getEndControlPoint().y,t,!1)),i.push(",")}if(0!=this.bezierCurves.length){n=this.bezierCurves[this.bezierCurves.length-1];i.push(e._roundToDigits(n.getEndPoint().x,t,!1)),i.push(","),i.push(e._roundToDigits(n.getEndPoint().y,t,!1))}return i.push("]"),i.join("")},e.fromReducedListRepresentation=function(t){var i=JSON.parse(t);if(!i.length)throw console.log("Cannot parse bezier path from non-array object nor from empty point list."),"Cannot parse bezier path from non-array object nor from empty point list.";if(i.length<8)throw console.log("Cannot build bezier path. The passed array must contain at least 8 elements (numbers)."),"Cannot build bezier path. The passed array must contain at least 8 elements (numbers).";var s=new e(null),n=null,r=null,o=null,a=null,h=0;do{0==h&&(n=new Vertex(i[h],i[h+1])),r=new Vertex(i[h+2],i[h+3]),o=new Vertex(i[h+4],i[h+5]),a=new Vertex(i[h+6],i[h+7]);var c=new CubicBezierCurve(n,a,r,o);s.bezierCurves.push(c),n=a,h+=6}while(h+2<i.length);return s.updateArcLengths(),s},e._roundToDigits=function(t,e,i){if(e<=0)return Math.round(t);var s=Math.pow(10,e),n=""+(t=Math.round(t*s))/s,r=n.lastIndexOf(".");if(-1==r&&(r=n.length),i)for(var o=i-(n.length-r-1);o-- >0;)n+="&nbsp;";return n},t.BezierPath=e}(window)},function(t,e,i){(function(t){var e;(e=window||t.export).Polygon=function(t,e){void 0===t&&(t=[]),this.vertices=t,this.isOpen=e},e.Polygon.prototype.containsVert=function(t){for(var e=!1,i=0,s=this.vertices.length-1;i<this.vertices.length;s=i++){var n=this.vertices[i].x,r=this.vertices[i].y,o=this.vertices[s].x,a=this.vertices[s].y;r>t.y!=a>t.y&&t.x<(o-n)*(t.y-r)/(a-r)+n&&(e=!e)}return e},e.Polygon.prototype.toQuadraticBezierData=function(){if(this.vertices.length<3)return[];var t=[],e=this.vertices[0],i=this.vertices[1],s=new Vertex(e.x+(i.x-e.x)/2,e.y+(i.y-e.y)/2);t.push(s);for(var n=this.isOpen?this.vertices.length:this.vertices.length+1,r=1;r<n;r++)e=this.vertices[r%this.vertices.length],i=this.vertices[(r+1)%this.vertices.length],s=new Vertex(e.x+(i.x-e.x)/2,e.y+(i.y-e.y)/2),t.push(e),t.push(s),e=i;return t},e.Polygon.prototype.toQuadraticBezierSVGString=function(){var t=this.toQuadraticBezierData();if(0==t.length)return"";for(var e=["M "+t[0].x+" "+t[0].y],i=1;i<t.length;i+=2)e.push("Q "+t[i].x+" "+t[i].y+", "+t[i+1].x+" "+t[i+1].y);return e.join(" ")},e.Polygon.prototype.toCubicBezierData=function(t){if(void 0===t&&(t=1),this.vertices.length<3)return[];var e=[],i=this.vertices[0],s=this.vertices[1],n=new Vertex(i.x+(s.x-i.x)/2,i.y+(s.y-i.y)/2);e.push(n);for(var r=this.isOpen?this.vertices.length-1:this.vertices.length,o=0;o<r;o++){i=this.vertices[o%this.vertices.length],s=this.vertices[(o+1)%this.vertices.length];var a=this.vertices[(o+2)%this.vertices.length],h=new Vertex(i.x+(s.x-i.x)/2,i.y+(s.y-i.y)/2),c=new Vertex(s.x+(a.x-s.x)/2,s.y+(a.y-s.y)/2),l=new Vertex(h.x+(s.x-h.x)*t,h.y+(s.y-h.y)*t),u=new Vertex(c.x+(s.x-c.x)*t,c.y+(s.y-c.y)*t);e.push(l),e.push(u),e.push(c)}return e},e.Polygon.prototype.toCubicBezierSVGString=function(t){var e=this.toCubicBezierData(t);if(0==e.length)return"";for(var i=["M "+e[0].x+" "+e[0].y],s=1;s<e.length;s+=3)i.push("C "+e[s].x+" "+e[s].y+", "+e[s+1].x+" "+e[s+1].y+", "+e[s+2].x+" "+e[s+2].y);return i.join(" ")},e.Polygon.prototype.toSVGString=function(t){t=t||{};var e=[];if(e.push("<path"),t.className&&e.push(' class="'+t.className+'"'),e.push(' d="'),this.vertices.length>0){e.push("M "),e.push(this.vertices[0].x),e.push(" "),e.push(this.vertices[0].y);for(var i=1;i<this.vertices.length;i++)e.push(" L "),e.push(this.vertices[i].x),e.push(" "),e.push(this.vertices[i].y);this.isOpen||e.push(" Z")}return e.push('" />'),e.join("")}}).call(this,i(0)(t))},function(t,e,i){(function(t){var e,i;e=window||t.export,(i=function(t,e){this.center=t,this.axis=e}).prototype.toSVGString=function(t){t=t||{};var e=[];return e.push("<ellipse"),t.className&&e.push(' class="'+t.className+'"'),e.push(' cx="'+this.center.x+'"'),e.push(' cy="'+this.center.y+'"'),e.push(' rx="'+this.axis.x+'"'),e.push(' ry="'+this.axis.y+'"'),e.push(" />"),e.join("")},e.VEllipse=i}).call(this,i(0)(t))},function(t,e){!function(t){window.MouseHandler=function(t){var e=null,i=null,s=-1,n={},r={},o={};function a(t){return{x:t.pageX-t.target.offsetLeft,y:t.pageY-t.target.offsetTop}}function h(n,r){var o=a(n);return n.params={element:t,name:r,pos:o,button:s,leftButton:0==s,middleButton:1==s,rightButton:2==s,mouseDownPos:e,draggedFrom:i,wasDragged:null!=e&&(e.x!=o.x||e.y!=o.y),dragAmount:null!=e?{x:o.x-i.x,y:o.y-i.y}:{x:0,y:0}},n}function c(e){r[e]||(t.addEventListener(e,o[e]),r[e]=!0)}function l(e){r[e]&&(t.removeEventListener(e,o[e]),delete r[e])}function u(t){throw"This MouseHandler already has a '"+t+"' callback. To keep the code simple there is only room for one."}o.mousemove=function(t){n.mousemove&&n.mousemove(h(t,"mousemove")),i&&n.drag&&n.drag(h(t,"drag")),e&&(i=a(t))},o.mouseup=function(t){n.mouseup&&n.mouseup(h(t,"mouseup")),i=null,e=null,s=-1},o.mousedown=function(t){i=a(t),e=a(t),s=t.button,n.mousedown&&n.mousedown(h(t,"mousedown"))},o.click=function(t){n.click&&n.click(h(t,"mousedown"))},o.wheel=function(t){n.wheel&&n.wheel(h(t,"wheel"))},this.drag=function(t){if(n.drag)throw"This MouseHandler already has a 'drag' callback.";return n.drag=t,c("mousedown"),c("mousemove"),c("mouseup"),n.drag=t,this},this.move=function(t){return n.mousemove&&u("mousemove"),c("mousemove"),n.mousemove=t,this},this.up=function(t){return n.mouseup&&u("mouseup"),c("mouseup"),n.mouseup=t,this},this.down=function(t){return n.mousedown&&u("mousedown"),c("mousedown"),n.mousedown=t,this},this.click=function(t){return n.click&&u("click"),c("click"),n.click=t,this},this.wheel=function(t){return n.wheel&&u("wheel"),c("wheel"),n.wheel=t,this},this.destroy=function(){console.log("destroy"),l("mousedown"),l("mousemove"),l("moseup"),l("click"),l("wheel")}}}()},function(t,e){!function(t){"use strict";var e=function(t){t=t||{},this.element=t.element?t.element:window,this.downListeners=[],this.pressListeners=[],this.upListeners=[],this.keyStates=[],this.trackAllKeys=t.trackAll||!1,this._keyDownListener=null,this._keyPressListener=null,this._keyUpListener=null,this.installListeners()},i=function(t,e){var i=!1;for(var s in e){var n=e[s];n.keyCode==t.keyCode&&(n.listener(t),i=!0)}return i},s=function(t){if("number"==typeof t)return t;if("string"!=typeof t)throw"Unknown key name or key type (should be a string or integer): "+t;if(e.KEY_CODES[t])return e.KEY_CODES[t];throw"Unknown key (cannot resolve key code): "+t};e.KEY_CODES={break:3,backspace:8,delete:8,tab:9,clear:12,enter:13,shift:16,ctrl:17,alt:18,pause:19,break:19,capslock:20,hangul:21,hanja:25,escape:27,conversion:28,"non-conversion":29,spacebar:32,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,select:41,print:42,execute:43,printscreen:44,insert:45,delete:46,help:47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,":":58,"semicolon (firefox)":59,equals:59,"<":60,"equals (firefox)":61,"ß":63,"@ (firefox)":64,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,windows:91,leftcommand:91,chromebooksearch:91,rightwindowkey:92,windowsmenu:93,rightcommant:93,sleep:95,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,numpadperiod:108,subtract:109,decimalpoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,f13:124,f14:125,f15:126,f16:127,f17:128,f18:129,f19:130,f20:131,f21:132,f22:133,f23:134,f24:135,numlock:144,scrolllock:145,"^":160,"!":161,"#":163,$:164,"ù":165,pagebackward:166,pageforward:167,refresh:168,closingparen:169,"*":170,"~+*":171,home:172,minus:173,mute:173,unmute:173,decreasevolumelevel:174,increasevolumelevel:175,next:176,previous:177,stop:178,"play/pause":179,email:180,mute:181,unmute:181,semicolon:186,"ñ":186,equal:187,comma:188,dash:189,period:190,forwardslash:191,"ç":191,"grave accent":192,"æ":192,"ö":192,"?":193,"/":193,"°":193,numpadperiod:194,openbracket:219,backslash:220,closebracket:221,"å":221,singlequote:222,"ø":222,"ä":222,"`":223,altgr:225,"GNOME Compose Key":230,"ç":231,XF86Forward:233,XF86Back:234,"non-conversion":235,alphanumeric:240,hiragana:242,katakana:242,"half-width":243,"full-width":243,kanji:244,unlocktrackpad:251,toggletouchpad:255},e.prototype.installListeners=function(){var t=this;this.element.addEventListener("keydown",this.keyDownListener=function(e){!function(t,e){(i(t,e.downListeners)||e.trackAllKeys)&&(e.keyStates[t.keyCode]="down")}(e,t)}),this.element.addEventListener("keypress",this.keyPressListener=function(e){!function(t,e){i(t,e.pressListeners)}(e,t)}),this.element.addEventListener("keyup",this.keyUpListener=function(e){!function(t,e){(i(t,e.upListeners)||e.trackAllKeys)&&delete e.keyStates[t.keyCode]}(e,t)})},e.prototype.releaseListeners=function(){this.element.removeEventListener("keydown",this.keyDownListener),this.element.removeEventListener("keypress",this.keyPressListener),this.element.removeEventListener("keyup",this.keyUpListener)},e.prototype.down=function(t,e){return this.downListeners.push({key:t,keyCode:s(t),listener:e}),this},e.prototype.press=function(t,e){return this.pressListeners.push({key:t,keyCode:s(t),listener:e}),this},e.prototype.up=function(t,e){return this.upListeners.push({key:t,keyCode:s(t),listener:e}),this},e.prototype.isDown=function(t){return!!this.keyStates[s(t)]},t.KeyHandler=e}(window)},function(t,e,i){(function(t){!function(t){"use strict";t.drawutils=function(t,e){this.ctx=t,this.offset=new Vertex(0,0),this.scale=new Vertex(1,1),this.fillShapes=e},t.drawutils.prototype.line=function(t,e,i){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+e.x*this.scale.x,this.offset.y+e.y*this.scale.y),this.ctx.strokeStyle=i,this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.restore()},t.drawutils.prototype._fillOrDraw=function(t){this.fillShapes?(this.ctx.fillStyle=t,this.ctx.fill()):(this.ctx.strokeStyle=t,this.ctx.stroke())},t.drawutils.prototype.cubicBezier=function(t,e,i,s,n){t instanceof CubicBezierCurve?this.cubicBezier(t.startPoint,t.endPoint,t.startControlPoint,t.endControlPoint,e):(this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y),this.ctx.bezierCurveTo(this.offset.x+i.x*this.scale.x,this.offset.y+i.y*this.scale.y,this.offset.x+s.x*this.scale.x,this.offset.y+s.y*this.scale.y,this.offset.x+e.x*this.scale.x,this.offset.y+e.y*this.scale.y),this.ctx.lineWidth=2,this._fillOrDraw(n),this.ctx.restore())},t.drawutils.prototype.handle=function(t,e){this.point(t,"rgb(0,32,192)"),this.square(e,5,"rgba(0,128,192,0.5)")},t.drawutils.prototype.cubicBezierCurveHandleLines=function(t){this.cubicBezierHandleLines(t.startPoint,t.endPoint,t.startControlPoint,t.endControlPoint)},t.drawutils.prototype.handleLine=function(t,e){this.line(t,e,"rgb(192,192,192)")},t.drawutils.prototype.dot=function(t,e){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+this.scale.x*t.x,this.offset.y+this.scale.y*t.y),this.ctx.lineTo(this.offset.x+this.scale.x*t.x+1,this.offset.y+this.scale.y*t.y+1),this.ctx.closePath(),this._fillOrDraw(e),this.ctx.restore()},t.drawutils.prototype.point=function(t,e){this.ctx.beginPath(),this.ctx.arc(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,3,0,2*Math.PI,!1),this.ctx.closePath(),this._fillOrDraw(e)},t.drawutils.prototype.circle=function(t,e,i){this.ctx.beginPath(),this.ctx.ellipse(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,e*this.scale.x,e*this.scale.y,0,0,2*Math.PI),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.ellipse=function(t,e,i,s){this.ctx.beginPath(),this.ctx.ellipse(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,e*this.scale.x,i*this.scale.y,0,0,2*Math.PI),this.ctx.closePath(),this._fillOrDraw(s)},t.drawutils.prototype.square=function(t,e,i){this.ctx.beginPath(),this.ctx.rect(this.offset.x+(t.x-e/2)*this.scale.x,this.offset.y+(t.y-e/2)*this.scale.y,e*this.scale.x,e*this.scale.y),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.grid=function(t,e,i,s,n,r){console.log("draw grid"),this.ctx.beginPath();for(var o=0;o<e/2;)this.ctx.moveTo(this.offset.x+(t.x+o)*this.scale.x,this.offset.y-(t.y-.5*i)*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x+o)*this.scale.x,this.offset.y-(t.y+.5*i)*this.scale.y),o+=s;for(o=s;o<e/2;)this.ctx.moveTo(this.offset.x+(t.x-o)*this.scale.x,this.offset.y-(t.y-.5*i)*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x-o)*this.scale.x,this.offset.y-(t.y+.5*i)*this.scale.y),o+=s;for(var a=0;a<i/2;)this.ctx.moveTo(this.offset.x-(t.x-.5*e)*this.scale.x,this.offset.y+(t.y+a)*this.scale.y),this.ctx.lineTo(this.offset.x-(t.x+.5*e)*this.scale.x,this.offset.y+(t.y+a)*this.scale.y),a+=n;for(a=n;a<i/2;)this.ctx.moveTo(this.offset.x-(t.x-.5*e)*this.scale.x,this.offset.y+(t.y-a)*this.scale.y),this.ctx.lineTo(this.offset.x-(t.x+.5*e)*this.scale.x,this.offset.y+(t.y-a)*this.scale.y),a+=n;this.ctx.closePath(),this._fillOrDraw(r)},t.drawutils.prototype.raster=function(t,e,i,s,n,r){this.ctx.save(),this.ctx.beginPath();for(var o=0,a=-Math.ceil(.5*e/s)*s;a<e/2;a+=s){o++;for(var h=-Math.ceil(.5*i/n)*n;h<i/2;h+=n)1==o&&0,this.ctx.moveTo(this.offset.x+(t.x+a)*this.scale.x-4,this.offset.y+(t.y+h)*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x+a)*this.scale.x+4,this.offset.y+(t.y+h)*this.scale.y),this.ctx.moveTo(this.offset.x+(t.x+a)*this.scale.x,this.offset.y+(t.y+h)*this.scale.y-4),this.ctx.lineTo(this.offset.x+(t.x+a)*this.scale.x,this.offset.y+(t.y+h)*this.scale.y+4)}this.ctx.strokeStyle=r,this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore()},t.drawutils.prototype.diamondHandle=function(t,e,i){this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x-e/2,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y-e/2),this.ctx.lineTo(this.offset.x+t.x*this.scale.x+e/2,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y+e/2),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.squareHandle=function(t,e,i){this.ctx.beginPath(),this.ctx.rect(this.offset.x+t.x*this.scale.x-e/2,this.offset.y+t.y*this.scale.y-e/2,e,e),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.circleHandle=function(t,e,i){this.ctx.beginPath(),this.ctx.arc(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,3,0,2*Math.PI,!1),this.ctx.closePath(),this._fillOrDraw(i)},t.drawutils.prototype.crosshair=function(t,e,i){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x-e,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x+e,this.offset.y+t.y*this.scale.y),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y-e),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y+e),this.ctx.strokeStyle=i,this.ctx.lineWidth=.5,this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore()},t.drawutils.prototype.polygon=function(t,e){if(!(t.vertices.length<=1)){this.ctx.save(),this.ctx.beginPath(),this.ctx.setLineDash([3,5]),this.ctx.lineWidth=1,this.ctx.moveTo(this.offset.x+t.vertices[0].x*this.scale.x,this.offset.y+t.vertices[0].y*this.scale.y);for(var i=0;i<t.vertices.length;i++)this.ctx.lineTo(this.offset.x+t.vertices[i].x*this.scale.x,this.offset.y+t.vertices[i].y*this.scale.y);!t.isOpen&&t.vertices.length>2&&this.ctx.closePath(),this._fillOrDraw(e),this.ctx.setLineDash([]),this.ctx.restore()}},t.drawutils.prototype.arcto=function(t,e,i,s,n,r,o,a,h,c){t=this.offset.x+this.scale.x*t,e=this.offset.y+this.scale.y*e,a=this.offset.x+this.scale.x*a,h=this.offset.y+this.scale.y*h,i*=this.scale.x,s*=this.scale.y;var l=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},u=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(l(t)*l(e))},d=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(u(t,e))},f=Math.cos(n)*(t-a)/2+Math.sin(n)*(e-h)/2,p=-Math.sin(n)*(t-a)/2+Math.cos(n)*(e-h)/2,g=Math.pow(f,2)/Math.pow(i,2)+Math.pow(p,2)/Math.pow(s,2);g>1&&(i*=Math.sqrt(g),s*=Math.sqrt(g));var y=(r==o?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(s,2)-Math.pow(i,2)*Math.pow(p,2)-Math.pow(s,2)*Math.pow(f,2))/(Math.pow(i,2)*Math.pow(p,2)+Math.pow(s,2)*Math.pow(f,2)));isNaN(y)&&(y=0);var v=y*i*p/s,x=y*-s*f/i,w=(t+a)/2+Math.cos(n)*v-Math.sin(n)*x,m=(e+h)/2+Math.sin(n)*v+Math.cos(n)*x,b=d([1,0],[(f-v)/i,(p-x)/s]),C=[(f-v)/i,(p-x)/s],P=[(-f-v)/i,(-p-x)/s],z=d(C,P);u(C,P)<=-1&&(z=Math.PI),u(C,P)>=1&&(z=0);var S=i>s?i:s,T=i>s?1:i/s,M=i>s?s/i:1;this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.translate(w,m),this.ctx.rotate(n),this.ctx.scale(T,M),this.ctx.arc(0,0,S,b,b+z,1-o),this.ctx.scale(1/T,1/M),this.ctx.rotate(-n),this.ctx.translate(-w,-m),this._fillOrDraw(c),this.ctx.restore()},t.drawutils.prototype.text=function(t,e,i,s){s=s||{},this.fillShapes?(this.ctx.fillStyle="black",this.ctx.fillText(t,e,i)):(this.ctx.strokeStyle="black",this.ctx.strokeText(t,e,i))},t.drawutils.prototype.label=function(t,e,i,s){this.ctx.save(),this.ctx.translate(e,i),void 0!==s&&this.ctx.rotate(s),this.ctx.fillStyle="black",this.fillShapes?this.ctx.fillText(t,0,0):this.ctx.strokeText(t,0,0),this.ctx.restore()}}(window||t.export)}).call(this,i(0)(t))},function(t,e){!function(t){"use strict";var e=function(t){this.wrapper=document.getElementById(t),this.blanket=this.wrapper.getElementsByClassName("overlay-blanket")[0],this.content=this.blanket.getElementsByClassName("overlay-content")[0],s(this.wrapper,{display:"none",position:"fixed",left:"0px",top:"0px",width:"100vw",height:"100vh"}),s(this.blanket,{width:"100%",height:"100%",display:"flex","align-items":"center","justify-content":"center",background:"rgba(0,0,0,0.15)"}),s(this.content,{width:"500px",height:"500px","max-width":"50%","max-height":"50%",background:"rgba(255,255,255,0.8)",border:"1px solid grey","border-radius":"5px",position:"relative"}),this._headLine=document.createElement("h3"),this._contentNode=document.createElement("div"),this._buttonLine=document.createElement("div"),this.content.innerHTML="",this.content.appendChild(this._headLine),this.content.appendChild(this._contentNode),this.content.appendChild(this._buttonLine),this._textArea=null,s(this._headLine,{width:"calc(100% - 10px)",overflow:"hidden","border-bottom":"1px solid grey",margin:"6px 0px",padding:"0px 5px 3px"}),s(this._contentNode,{width:"calc(100% - 10px)",overflow:"hidden",margin:"0px",padding:"0px 5px",position:"absolute",top:"30px",height:"calc(100% - 60px)"}),s(this._buttonLine,{width:"calc(100% - 10px)",overflow:"hidden",position:"absolute",top:"auto",bottom:"0px","text-align":"right"}),r(this._headLine,"od-hl"),r(this._contentNode,"od-cn"),r(this._buttonLine,"od-bl")};function i(t,e){if("string"==typeof e&&"close"==e)i(t,{label:"Close",action:function(){n(t)}});else if("string"==typeof e&&"ok"==e)console.log("add ok button"),i(t,{label:"OK",action:function(){n(t)}});else{var s=document.createElement("button");s.type="button",s.innerHTML=e.label?e.label:"no-label","function"==typeof e.action?s.addEventListener("click",e.action):"close"==e.action&&s.addEventListener("click",function(){n(t)}),t._buttonLine.appendChild(s)}}function s(t,e){for(var i in e)t.style[i]=e[i]}function n(t){t.wrapper.style.display="none"}function r(t,e){var i=t.className.split(" ");-1==i.indexOf(e)&&(i.push(e),t.className=i.join(" "))}e.prototype.show=function(t,e,s,n){if(this._headLine.innerHTML=e||"Please confirm",this.setMessage(t,n),this._buttonLine.innerHTML="",s)for(var r in s)i(this,s[r]);else i(this,"ok");this.wrapper.style.display="inherit"},e.prototype.setMessage=function(t,e){e={}||e,"string"==typeof t?(this._contentNode.innerHTML=t,e.messageClass&&r(this._contentNode,e.messageClass)):(this._contentNode.innerHTML="",this._contentNode.appendChild(t))},e.prototype.showTextArea=function(t,e,i,s){this._textArea=document.createElement("textarea"),this._textArea.innerHTML=t||"",this._textArea.style.width="100%",this._textArea.style.height="95%",this._textArea.style.border="0px",s&&s.messageClass&&(this._textArea.className=s.messageClass),this.show(this._textArea,e,i,s)},e.prototype.hide=function(){n(this)},t.overlayDialog=e}(window)},function(t,e){!function(t){"use strict";var e=function(t,e,i){t.style["transform-origin"]="0 0",t.style.transform=1==e&&1==i?null:"scale("+e+","+i+")"};!function(t){var e=function(t,e){this.item=t,this.type=e,this.vindex=null,this.pindex=null,this.cindex=null};e.VERTEX="vertex",e.prototype.isVertex=function(){return this.type==e.VERTEX},e.prototype.setVIndex=function(t){return this.vindex=t,this},t.Draggable=e}(t),VertexAttr.model={bezierAutoAdjust:!1,renderTime:0,selectable:!0};var i=function(s){if(void 0===(s=s||{}).canvas)throw"No canvas specified.";this.config={fullSize:void 0===s.fullSize||s.fullSize,fitToParent:void 0===s.fitToParent||s.fitToParent,scaleX:s.scaleX||1,scaleY:s.scaleY||1,rasterGrid:void 0===s.rasterGrid||s.rasterGrid,drawOrigin:void 0===s.drawOrigin||s.drawOrigin,rasterAdjustFactor:"number"==typeof s.rasterAdjustFactor?s.rasterAdjustFactor:2,autoAdjustOffset:void 0===s.autoAdjustOffset||s.autoAdjustOffset,offsetAdjustXPercent:"number"==typeof s.offsetAdjustXPercent?s.offsetAdjustXPercent:50,offsetAdjustYPercent:"number"==typeof s.offsetAdjustYPercent?s.offsetAdjustYPercent:50,backgroundColor:s.backgroundColor||"#ffffff",redrawOnResize:void 0===s.redrawOnResize||s.redrawOnResize,defaultCanvasWidth:"number"==typeof s.defaultCanvasWidth?s.defaultCanvasWidth:1024,defaultCanvasHeight:"number"==typeof s.defaultCanvasHeight?s.defaultCanvasHeight:768,cssScaleX:"number"==typeof s.cssScaleX?s.cssScaleX:1,cssScaleY:"number"==typeof s.cssScaleY?s.cssScaleY:1,cssUniformScale:!0,rebuild:function(){o()},loadImage:function(){var t=document.getElementById("file");t.setAttribute("data-type","image-upload"),t.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))},saveFile:function(){r()},drawBezierHandleLines:void 0===s.drawBezierHandleLines||s.drawBezierHandleLines,drawBezierHandlePoints:void 0===s.drawBezierHandlePoints||s.drawBezierHandlePoints,drawHandleLines:void 0===s.drawHandleLines||s.drawHandleLines,drawHandlePoints:void 0===s.drawHandlePoints||s.drawHandlePoints,preDraw:"function"==typeof s.preDraw?s.preDraw:null,postDraw:"function"==typeof s.postDraw?s.postDraw:null,enableMouse:void 0===s.enableMouse||s.enableMouse,enableKeys:void 0===s.enableKeys||s.enableKeys},this.canvas="string"==typeof s.canvas?document.getElementById(s.canvas):s.canvas,this.ctx=this.canvas.getContext("2d"),this.draw=new drawutils(this.ctx,!1),this.draw.scale.set(this.config.scaleX,this.config.scaleY),this.fill=new drawutils(this.ctx,!0),this.fill.scale.set(this.config.scaleX,this.config.scaleY),this.grid=new Grid(new Vertex(0,0),new Vertex(50,50)),this.image=null,this.imageBuffer=null,this.canvasSize={width:1024,height:768},this.vertices=[],this.selectPolygon=null,this.draggedElements=[],this.drawables=[];var n=this;i.prototype.updateCSSscale=function(){console.log("update css scale"),this.config.cssUniformScale?e(this.canvas,this.config.cssScaleX,this.config.cssScaleX):e(this.canvas,this.config.cssScaleX,this.config.cssScaleY)},i.prototype.add=function(t,e){if(t instanceof Line)this.drawables.push(t),this.vertices.push(t.a),this.vertices.push(t.b);else if(t instanceof VEllipse)this.vertices.push(t.center),this.vertices.push(t.axis),this.drawables.push(t),t.center.listeners.addDragListener(function(e){t.axis.add(e.params.dragAmount)});else if(t instanceof Polygon)for(var i in this.drawables.push(t),t.vertices)this.vertices.push(t.vertices[i]);else{if(!(t instanceof BezierPath))throw"Cannot add drawable of unrecognized type: "+t.constructor.name;for(var i in this.drawables.push(t),t.bezierCurves)t.adjustCircular||0!=i||this.vertices.push(t.bezierCurves[i].startPoint),this.vertices.push(t.bezierCurves[i].endPoint),this.vertices.push(t.bezierCurves[i].startControlPoint),this.vertices.push(t.bezierCurves[i].endControlPoint),t.bezierCurves[i].startControlPoint.attr.selectable=!1,t.bezierCurves[i].endControlPoint.attr.selectable=!1;for(var i in t.bezierCurves)t.bezierCurves[i].startPoint.listeners.addDragListener(function(e){var i=t.locateCurveByStartPoint(e.params.vertex);t.bezierCurves[i].startPoint.addXY(-e.params.dragAmount.x,-e.params.dragAmount.y),t.moveCurvePoint(1*i,t.START_POINT,e.params.dragAmount)}),t.bezierCurves[i].startControlPoint.listeners.addDragListener(function(e){var i=t.locateCurveByStartControlPoint(e.params.vertex);t.bezierCurves[i].startPoint.attr.bezierAutoAdjust&&t.adjustPredecessorControlPoint(1*i,!0,!0)}),t.bezierCurves[i].endControlPoint.listeners.addDragListener(function(e){var i=t.locateCurveByEndControlPoint(e.params.vertex);t.bezierCurves[i%t.bezierCurves.length].endPoint.attr.bezierAutoAdjust&&t.adjustSuccessorControlPoint(1*i,!0,!0)})}(e||void 0===e)&&this.redraw()},i.prototype.drawGrid=function(){var t=Grid.utils.mapRasterScale(this.config.rasterAdjustFactor,this.draw.scale.x),e=Grid.utils.mapRasterScale(this.config.rasterAdjustFactor,this.draw.scale.y),i={w:this.grid.size.x*t,h:this.grid.size.y*e},s=this.canvasSize.width/2,n=this.canvasSize.height/2,r=this.draw.offset.clone().inv();r.x=Math.round(r.x+s)/Math.round(i.w)*i.w/this.draw.scale.x+(this.draw.offset.x-s)/this.draw.scale.x%i.w,r.y=Math.round(r.y+n)/Math.round(i.h)*i.h/this.draw.scale.y+(this.draw.offset.y-n)/this.draw.scale.x%i.h,this.config.rasterGrid?this.draw.raster(r,this.canvasSize.width/this.draw.scale.x,this.canvasSize.height/this.draw.scale.y,i.w,i.h,"rgba(0,128,255,0.125)"):this.draw.grid(r,this.canvasSize.width/this.draw.scale.x,this.canvasSize.height/this.draw.scale.y,i.w,i.h,"rgba(0,128,255,0.095)")},i.prototype.drawOrigin=function(){this.draw.crosshair({x:0,y:0},10,"#000000")},i.prototype.drawBackgroundImage=function(){},i.prototype.drawDrawables=function(t){for(var e in this.drawables){var i=this.drawables[e];if(i instanceof BezierPath)for(var s in i.bezierCurves)this.draw.cubicBezier(i.bezierCurves[s].startPoint,i.bezierCurves[s].endPoint,i.bezierCurves[s].startControlPoint,i.bezierCurves[s].endControlPoint,"#00a822"),this.config.drawBezierHandlePoints&&this.config.drawHandlePoints?(i.bezierCurves[s].startPoint.attr.bezierAutoAdjust||(this.draw.diamondHandle(i.bezierCurves[s].startPoint,7,"orange"),i.bezierCurves[s].startPoint.attr.renderTime=t),i.bezierCurves[s].endPoint.attr.bezierAutoAdjust||(this.draw.diamondHandle(i.bezierCurves[s].endPoint,7,"orange"),i.bezierCurves[s].endPoint.attr.renderTime=t),this.draw.circleHandle(i.bezierCurves[s].startControlPoint,7,"#008888"),this.draw.circleHandle(i.bezierCurves[s].endControlPoint,7,"#008888"),i.bezierCurves[s].startControlPoint.attr.renderTime=t,i.bezierCurves[s].endControlPoint.attr.renderTime=t):(i.bezierCurves[s].startPoint.attr.renderTime=t,i.bezierCurves[s].endPoint.attr.renderTime=t,i.bezierCurves[s].startControlPoint.attr.renderTime=t,i.bezierCurves[s].endControlPoint.attr.renderTime=t),this.config.drawBezierHandleLines&&this.config.drawHandleLines&&(this.draw.handleLine(i.bezierCurves[s].startPoint,i.bezierCurves[s].startControlPoint),this.draw.handleLine(i.bezierCurves[s].endPoint,i.bezierCurves[s].endControlPoint));else if(i instanceof Polygon){if(this.draw.polygon(i,"#0022a8"),!this.config.drawHandlePoints)for(var e in i.vertices)i.vertices[e].attr.renderTime=t}else i instanceof VEllipse?(this.config.drawHandleLines&&(this.draw.line(i.center.clone().add(0,i.axis.y-i.center.y),i.axis,"#c8c8c8"),this.draw.line(i.center.clone().add(i.axis.x-i.center.x,0),i.axis,"#c8c8c8")),this.draw.ellipse(i.center,Math.abs(i.axis.x-i.center.x),Math.abs(i.axis.y-i.center.y),"#2222a8"),this.config.drawHandlePoints||(i.center.attr.renderTime=t,i.axis.attr.renderTime=t)):i instanceof Line?(this.draw.line(i.a,i.b,"#a844a8"),this.config.drawHandlePoints||(i.a.attr.renderTime=t,i.b.attr.renderTime=t)):console.error("Cannot draw object. Unknown class "+i.constructor.name+".")}},i.prototype.drawSelectPolygon=function(){null!=this.selectPolygon&&this.selectPolygon.vertices.length>0&&(console.log("Drawing selectPolygon",this.selectPolygon.vertices.length,"vertices"),this.draw.polygon(this.selectPolygon,"#888888"),this.draw.crosshair(this.selectPolygon.vertices[0],3,"#008888"))},i.prototype.drawVertices=function(t){for(var e in this.vertices)this.vertices[e].attr.renderTime!=t&&this.draw.squareHandle(this.vertices[e],5,this.vertices[e].attr.isSelected?"rgba(192,128,0)":"rgb(0,128,192)")},i.prototype.redraw=function(){var t=(new Date).getTime();this.clear(),this.config.preDraw&&this.config.preDraw(),this.drawGrid(),this.config.drawOrigin&&this.drawOrigin(),this.drawBackgroundImage(),this.drawDrawables(t),this.drawVertices(t),this.drawSelectPolygon(),this.config.postDraw&&this.config.postDraw()},i.prototype.clear=function(){this.ctx.fillStyle=this.config.backgroundColor,this.ctx.fillRect(0,0,this.canvasSize.width,this.canvasSize.height)};i.prototype.clearSelection=function(t){for(var e in this.vertices)this.vertices[e].attr.isSelected=!1;return t&&this.redraw(),this};document.getElementById("file").addEventListener("change",function(t){var e=document.getElementById("file").getAttribute("data-type");"image-upload"==e?function(t){if(-1!="image/gif,image/jpeg,image/jpg,image/gif,image/png".indexOf(t.target.files[0].type)||window.confirm("This seems not to be an image ("+t.target.files[0].type+"). Continue?")){var e=new FileReader;e.onload=function(t){this.image=new Image,this.image.onload=function(){var t=document.createElement("canvas");t.width=this.image.width,t.height=this.image.height,t.getContext("2d").drawImage(this.image,0,0,this.image.width,image.height),alert("Sorry, not yet implemented.")},this.image.src=t.target.result},e.readAsDataURL(t.target.files[0])}}(t):console.warn("Unrecognized upload type: "+e)});var r=function(){var t=(new SVGBuilder).build(n.drawables,{canvasSize:n.canvasSize,offset:n.draw.offset,zoom:n.draw.scale}),e=new Blob([t],{type:"image/svg;charset=utf-8"});saveAs(e,"plot-boilerplate.svg")},o=function(){};i.prototype.resizeCanvas=function(){var t=function(t,e){n.canvas.width=t,n.canvas.height=e,n.canvasSize.width=t,n.canvasSize.height=e,n.config.autoAdjustOffset&&(n.draw.offset.x=n.fill.offset.x=t*(n.config.offsetAdjustXPercent/100),n.draw.offset.y=n.fill.offset.y=e*(n.config.offsetAdjustYPercent/100))};if(n.config.fullSize&&!n.config.fitToParent)t(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight);else if(n.config.fitToParent){t(n.canvas.parentNode.clientWidth-2,n.canvas.parentNode.clientHeight-2)}else t(n.config.defaultCanvasWidth,n.config.defaultCanvasHeight);n.config.redrawOnResize&&n.redraw()},t.addEventListener("resize",this.resizeCanvas),this.resizeCanvas(),i.prototype.selectVerticesInPolygon=function(t){for(var e in this.vertices)t.containsVert(this.vertices[e])&&(this.vertices[e].attr.isSelected=!0)};var a=function(t){for(var e in n.vertices){var i=n.vertices[e];if(i.distance(t)<7)return new Draggable(i,Draggable.VERTEX).setVIndex(e)}return!1};i.prototype.transformMousePosition=function(t,e){return{x:(t/this.config.cssScaleX-this.draw.offset.x)/this.draw.scale.x,y:(e/this.config.cssScaleY-this.draw.offset.y)/this.draw.scale.y}};if(this.config.enableMouse?new MouseHandler(this.canvas).down(function(t){if(1==t.which){var e=a(n.transformMousePosition(t.params.pos.x,t.params.pos.y));if(e){if("vertex"==e.type&&n.vertices[e.vindex].attr.isSelected)for(var i in n.vertices)n.vertices[i].attr.isSelected&&(n.draggedElements.push(new Draggable(n.vertices[i],Draggable.VERTEX).setVIndex(i)),n.vertices[i].listeners.fireDragStartEvent(t));else n.draggedElements.push(e),"bpath"==e.type?n.paths[e.pindex].bezierCurves[e.cindex].getPointByID(e.pid).listeners.fireDragStartEvent(t):"vertex"==e.type&&n.vertices[e.vindex].listeners.fireDragStartEvent(t);n.redraw()}}}).drag(function(t){if(t.params.dragAmount.x/=n.config.cssScaleX,t.params.dragAmount.y/=n.config.cssScaleY,h.isDown("alt")||h.isDown("ctrl"))n.draw.offset.add(t.params.dragAmount),n.fill.offset.set(n.draw.offset),n.redraw();else for(var e in t.params.dragAmount.x/=n.draw.scale.x,t.params.dragAmount.y/=n.draw.scale.y,n.draggedElements){var i=n.draggedElements[e];"bpath"==i.type?(n.paths[i.pindex].moveCurvePoint(i.cindex,i.pid,t.params.dragAmount),n.paths[i.pindex].bezierCurves[i.cindex].getPointByID(i.pid).listeners.fireDragEvent(t)):"vertex"==i.type&&(n.vertices[i.vindex].add(t.params.dragAmount),n.vertices[i.vindex].listeners.fireDragEvent(t))}n.redraw()}).up(function(t){if(1==t.which){for(var e in t.params.wasDragged||function(t,e){var i=a(n.transformMousePosition(t,e));if(i)if(h.isDown("shift")){if("bpath"==i.type){let t=n.paths[i.pindex].bezierCurves[i.cindex].getPointByID(i.pid);t.attr.selectable&&(t.attr.isSelected=!t.attr.isSelected)}else if("vertex"==i.type){let t=n.vertices[i.vindex];t.attr.selectable&&(t.attr.isSelected=!t.attr.isSelected)}n.redraw()}else h.isDown("y")&&(n.vertices[i.vindex].attr.bezierAutoAdjust=!n.vertices[i.vindex].attr.bezierAutoAdjust,console.log("bezierAutoAdjust="+n.vertices[i.vindex].attr.bezierAutoAdjust),n.redraw());else if(null!=n.selectPolygon){var s=n.transformMousePosition(t,e);n.selectPolygon.vertices.push(s),n.redraw()}}(t.params.pos.x,t.params.pos.y),n.draggedElements){var i=n.draggedElements[e];"bpath"==i.type?n.paths[i.pindex].bezierCurves[i.cindex].getPointByID(i.pid).listeners.fireDragEndEvent(t):"vertex"==i.type&&n.vertices[i.vindex].listeners.fireDragEndEvent(t)}n.draggedElements=[],n.redraw()}}).wheel(function(t){t.deltaY<0?(n.draw.scale.x=n.fill.scale.x=n.config.scaleX=1.25*n.config.scaleX,n.draw.scale.y=n.fill.scale.y=n.config.scaleY=1.25*n.config.scaleY):t.deltaY>0&&(n.draw.scale.x=n.fill.scale.x=n.config.scaleX=Math.max(n.config.scaleX/1.25,.01),n.draw.scale.y=n.fill.scale.y=n.config.scaleY=Math.max(n.config.scaleY/1.25,.01)),n.redraw()}):console.log("Mouse interaction disabled."),this.config.enableKeys)var h=new KeyHandler({trackAll:!0}).down("enter",function(){console.log("ENTER was hit.")}).press("enter",function(){console.log("ENTER was pressed.")}).up("enter",function(){console.log("ENTER was released.")}).down("alt",function(){console.log("alt was hit.")}).press("alt",function(){console.log("alt was pressed.")}).up("alt",function(){console.log("alt was released.")}).down("ctrl",function(){console.log("ctrl was hit.")}).press("ctrl",function(){console.log("ctrl was pressed.")}).up("ctrl",function(){console.log("ctrl was released.")}).down("escape",function(){console.log("ESCAPE was hit."),n.clearSelection(!0)}).down("shift",function(){console.log("SHIFT was hit."),n.selectPolygon=new Polygon,n.redraw()}).up("shift",function(){console.log("SHIFT was released."),null!=n.selectPolygon&&(n.selectVerticesInPolygon(n.selectPolygon),n.selectPolygon=null,n.redraw())}).down("y",function(){console.log("y was hit.")}).up("y",function(){console.log("y was released.")}).down("e",function(){console.log("e was hit. shift is pressed?",h.isDown("shift"))}).up("windows",function(){console.log("windows was released.")});else console.log("Keyboard interaction disabled.");window.dialog=new overlayDialog("dialog-wrapper"),this.updateCSSscale(),this.redraw(),this.canvas.focus()};i.prototype.createGUI=function(){var t=new dat.gui.GUI,e=this;t.remember(this.config);var i=t.addFolder("Editor settings"),s=i.addFolder("Canvas size");s.add(this.config,"fullSize").onChange(function(){e.resizeCanvas()}).title("Toggles the fullpage mode."),s.add(this.config,"fitToParent").onChange(function(){e.resizeCanvas()}).title("Toggles the fit-to-parent mode to fit to parent container (overrides fullsize)."),s.add(this.config,"defaultCanvasWidth").min(1).step(10).onChange(function(){e.resizeCanvas()}).title("Specifies the fallback width."),s.add(this.config,"defaultCanvasHeight").min(1).step(10).onChange(function(){e.resizeCanvas()}).title("Specifies the fallback height."),s.add(this.config,"cssScaleX").min(.01).step(.01).max(1).onChange(function(){e.config.cssUniformScale&&(e.config.cssScaleY=e.config.cssScaleX),e.updateCSSscale()}).title("Specifies the visual x scale (CSS).").listen(),s.add(this.config,"cssScaleY").min(.01).step(.01).max(1).onChange(function(){e.config.cssUniformScale&&(e.config.cssScaleX=e.config.cssScaleY),e.updateCSSscale()}).title("Specifies the visual y scale (CSS).").listen(),s.add(this.config,"cssUniformScale").onChange(function(){e.config.cssUniformScale&&(e.config.cssScaleY=e.config.cssScaleX),e.updateCSSscale()}).title("CSS uniform scale (x-scale equlsa y-scale).");var n=i.addFolder("Draw settings");return n.add(this.config,"drawBezierHandlePoints").onChange(function(){e.redraw()}).title("Draw Bézier handle points."),n.add(this.config,"drawBezierHandleLines").onChange(function(){e.redraw()}).title("Draw Bézier handle lines."),n.add(this.config,"drawHandlePoints").onChange(function(){e.redraw()}).title("Draw handle points (overrides all other settings)."),n.add(this.config,"drawHandleLines").onChange(function(){e.redraw()}).title("Draw handle lines in general (overrides all other settings)."),i.add(this.config,"scaleX").title("Scale x.").min(.01).max(10).step(.01).onChange(function(){e.draw.scale.x=e.fill.scale.x=e.config.scaleX,e.redraw()}).listen(),i.add(this.config,"scaleY").title("Scale y.").min(.01).max(10).step(.01).onChange(function(){e.draw.scale.y=e.fill.scale.y=e.config.scaleY,e.redraw()}).listen(),i.add(this.config,"rasterGrid").title("Draw a fine raster instead a full grid.").onChange(function(){e.redraw()}).listen(),i.add(this.config,"redrawOnResize").title("Automatically redraw the data if window or canvas is resized.").listen(),i.addColor(this.config,"backgroundColor").onChange(function(){e.redraw()}).title("Choose a background color."),t.addFolder("Export").add(this.config,"saveFile").name("Save a file").title("Save as SVG."),t},i.utils={safeMergeByKeys:function(t,e){for(var i in t)if(e.hasOwnProperty(i)){var s=typeof t[i];try{"boolean"==s?t[i]=!!JSON.parse(e[i]):"number"==s?t[i]=1*JSON.parse(e[i]):("function"==s&&typeofextension[i],t[i]=e[i])}catch(t){console.error("error in key ",i,e[i],t)}}return t}},t.PlotBoilerplate=i}(window)},function(t,e,i){(function(t){t.export,PlotBoilerplate.RectSelector=function(t,e,i,s){var n=document.getElementById(e),r={xMin:0,yMin:0,xMax:0,yMax:0};new MouseHandler(n).up(function(t){0==t.button&&(n.style.display="none",console.log("xMin",r.xMin,"yMin",r.yMin,"xMax",r.xMax,"yMax",r.yMax),r.xMin!=r.xMax&&r.yMin!=r.yMax&&s(r))}),new MouseHandler(t.canvas).down(function(e){if(0==e.button){n.style.display="inherit",n.style.left=e.clientX+"px",n.style.top=e.clientY+"px",n.style.width="1px",n.style.height="1px";var s=t.transformMousePosition(e.params.mouseDownPos.x,e.params.mouseDownPos.y);r.xMin=r.xMax=i.unNormalizeX(s.x),r.yMin=r.yMax=i.unNormalizeY(s.y)}}).up(function(t){0==t.button&&(console.log("up"),n.style.display="none",console.log("xMin",r.xStart,"yMin",r.yStart,"xMax",r.xEnd,"yMax",r.yEnd),r.xMin!=r.xMax&&r.yMin!=r.yMax&&s(r))}).drag(function(e){if(0==e.button){var s=e.params.mouseDownPos.x,o=e.params.mouseDownPos.y,a=e.params.pos.x,h=e.params.pos.y,c=t.transformMousePosition(e.params.pos.x,e.params.pos.y);r.xMax=i.unNormalizeX(c.x),r.yMax=i.unNormalizeY(c.y),n.style.width=a-s+"px",n.style.height=h-o+"px"}})}}).call(this,i(0)(t))}]);