(()=>{"use strict";var t={318:(t,e,i)=>{i.r(e),i.d(e,{AlloyFinger:()=>o,default:()=>a});const s=t=>Math.sqrt(t.x*t.x+t.y*t.y);class r{constructor(t){this.handlers=[],this.el=t}add(t){this.handlers.push(t)}del(t){t||(this.handlers=[]);for(var e=this.handlers.length;e>=0;e--)this.handlers[e]===t&&this.handlers.splice(e,1)}dispatch(...t){for(var e=0,i=this.handlers.length;e<i;e++){const t=this.handlers[e];"function"==typeof t&&t.apply(this.el,arguments)}}}const n=(t,e)=>{const i=new r(t);return i.add(e),i};class o{constructor(t,e){this.element="string"==typeof t?document.querySelector(t):t,this.start=this.start.bind(this),this.move=this.move.bind(this),this.end=this.end.bind(this),this.cancel=this.cancel.bind(this),this.element.addEventListener("touchstart",this.start,!1),this.element.addEventListener("touchmove",this.move,!1),this.element.addEventListener("touchend",this.end,!1),this.element.addEventListener("touchcancel",this.cancel,!1),this.preV={x:null,y:null},this.pinchStartLen=null,this.zoom=1,this.isDoubleTap=!1;const i=()=>{};this.rotate=n(this.element,e.rotate||i),this.touchStart=n(this.element,e.touchStart||i),this.multipointStart=n(this.element,e.multipointStart||i),this.multipointEnd=n(this.element,e.multipointEnd||i),this.pinch=n(this.element,e.pinch||i),this.swipe=n(this.element,e.swipe||i),this.tap=n(this.element,e.tap||i),this.doubleTap=n(this.element,e.doubleTap||i),this.longTap=n(this.element,e.longTap||i),this.singleTap=n(this.element,e.singleTap||i),this.pressMove=n(this.element,e.pressMove||i),this.twoFingerPressMove=n(this.element,e.twoFingerPressMove||i),this.touchMove=n(this.element,e.touchMove||i),this.touchEnd=n(this.element,e.touchEnd||i),this.touchCancel=n(this.element,e.touchCancel||i),this._cancelAllHandler=this.cancelAll.bind(this),globalThis&&"function"==typeof globalThis.addEventListener&&globalThis.addEventListener("scroll",this._cancelAllHandler),this.delta=null,this.last=null,this.now=null,this.tapTimeout=null,this.singleTapTimeout=null,this.longTapTimeout=null,this.swipeTimeout=null,this.x1=this.x2=this.y1=this.y2=null,this.preTapPosition={x:null,y:null}}start(t){if(!t.touches)return;const e=this;this.now=Date.now(),this.x1=t.touches[0].pageX,this.y1=t.touches[0].pageY,this.delta=this.now-(this.last||this.now),this.touchStart.dispatch(t,this.element),null!==this.preTapPosition.x&&(this.isDoubleTap=this.delta>0&&this.delta<=250&&Math.abs(this.preTapPosition.x-this.x1)<30&&Math.abs(this.preTapPosition.y-this.y1)<30,this.isDoubleTap&&clearTimeout(this.singleTapTimeout)),this.preTapPosition.x=this.x1,this.preTapPosition.y=this.y1,this.last=this.now;const i=this.preV;if(t.touches.length>1){this._cancelLongTap(),this._cancelSingleTap();const e={x:t.touches[1].pageX-this.x1,y:t.touches[1].pageY-this.y1};i.x=e.x,i.y=e.y,this.pinchStartLen=s(i),this.multipointStart.dispatch(t,this.element)}this._preventTap=!1,this.longTapTimeout=setTimeout((()=>{e.longTap.dispatch(t,e.element),e._preventTap=!0}).bind(e),750)}move(t){if(!t.touches)return;const e=t,i=this.preV,r=t.touches.length,n=t.touches[0].pageX,o=t.touches[0].pageY;if(this.isDoubleTap=!1,r>1){const t=e.touches[1].pageX,r=e.touches[1].pageY,c={x:e.touches[1].pageX-n,y:e.touches[1].pageY-o};null!==i.x&&(this.pinchStartLen>0&&(e.zoom=s(c)/this.pinchStartLen,this.pinch.dispatch(e,this.element)),e.angle=(l=((t,e)=>{const i=s(t)*s(e);if(0===i)return 0;var r=((t,e)=>t.x*e.x+t.y*e.y)(t,e)/i;return r>1&&(r=1),Math.acos(r)})(a=c,h=i),((t,e)=>t.x*e.y-e.x*t.y)(a,h)>0&&(l*=-1),180*l/Math.PI),this.rotate.dispatch(e,this.element)),i.x=c.x,i.y=c.y,null!==this.x2&&null!==this.sx2?(e.deltaX=(n-this.x2+t-this.sx2)/2,e.deltaY=(o-this.y2+r-this.sy2)/2):(e.deltaX=0,e.deltaY=0),this.twoFingerPressMove.dispatch(e,this.element),this.sx2=t,this.sy2=r}else{if(null!==this.x2){e.deltaX=n-this.x2,e.deltaY=o-this.y2;const t=Math.abs(this.x1-this.x2),i=Math.abs(this.y1-this.y2);(t>10||i>10)&&(this._preventTap=!0)}else e.deltaX=0,e.deltaY=0;this.pressMove.dispatch(e,this.element)}var a,h,l;this.touchMove.dispatch(e,this.element),this._cancelLongTap(),this.x2=n,this.y2=o,r>1&&t.preventDefault()}end(t){if(!t.changedTouches)return;const e=t;this._cancelLongTap();const i=this;e.touches.length<2&&(this.multipointEnd.dispatch(e,this.element),this.sx2=this.sy2=null),this.x2&&Math.abs(this.x1-this.x2)>30||this.y2&&Math.abs(this.y1-this.y2)>30?(e.direction=this._swipeDirection(this.x1,this.x2,this.y1,this.y2),this.swipeTimeout=setTimeout((function(){i.swipe.dispatch(e,i.element)}),0)):(this.tapTimeout=setTimeout((function(){i._preventTap||i.tap.dispatch(e,i.element),i.isDoubleTap&&(i.doubleTap.dispatch(e,i.element),i.isDoubleTap=!1)}),0),i.isDoubleTap||(i.singleTapTimeout=setTimeout((function(){i.singleTap.dispatch(e,i.element)}),250))),this.touchEnd.dispatch(e,this.element),this.preV.x=0,this.preV.y=0,this.zoom=1,this.pinchStartLen=null,this.x1=this.x2=this.y1=this.y2=null}cancelAll(){this._preventTap=!0,clearTimeout(this.singleTapTimeout),clearTimeout(this.tapTimeout),clearTimeout(this.longTapTimeout),clearTimeout(this.swipeTimeout)}cancel(t){this.cancelAll(),this.touchCancel.dispatch(t,this.element)}_cancelLongTap(){clearTimeout(this.longTapTimeout)}_cancelSingleTap(){clearTimeout(this.singleTapTimeout)}_swipeDirection(t,e,i,s){return Math.abs(t-e)>=Math.abs(i-s)?t-e>0?"Left":"Right":i-s>0?"Up":"Down"}on(t,e){this[t]&&this[t].add(e)}off(t,e){this[t]&&this[t].del(e)}destroy(){this.singleTapTimeout&&clearTimeout(this.singleTapTimeout),this.tapTimeout&&clearTimeout(this.tapTimeout),this.longTapTimeout&&clearTimeout(this.longTapTimeout),this.swipeTimeout&&clearTimeout(this.swipeTimeout),this.element.removeEventListener("touchstart",this.start),this.element.removeEventListener("touchmove",this.move),this.element.removeEventListener("touchend",this.end),this.element.removeEventListener("touchcancel",this.cancel),this.rotate.del(),this.touchStart.del(),this.multipointStart.del(),this.multipointEnd.del(),this.pinch.del(),this.swipe.del(),this.tap.del(),this.doubleTap.del(),this.longTap.del(),this.singleTap.del(),this.pressMove.del(),this.twoFingerPressMove.del(),this.touchMove.del(),this.touchEnd.del(),this.touchCancel.del(),this.preV=this.pinchStartLen=this.zoom=this.isDoubleTap=this.delta=this.last=this.now=this.tapTimeout=this.singleTapTimeout=this.longTapTimeout=this.swipeTimeout=this.x1=this.x2=this.y1=this.y2=this.preTapPosition=this.rotate=this.touchStart=this.multipointStart=this.multipointEnd=this.pinch=this.swipe=this.tap=this.doubleTap=this.longTap=this.singleTap=this.pressMove=this.touchMove=this.touchEnd=this.touchCancel=this.twoFingerPressMove=null,globalThis&&"function"==typeof globalThis.removeEventListener&&globalThis.removeEventListener("scroll",this._cancelAllHandler)}}const a=o},126:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BezierPath=void 0;var s=i(262),r=i(510),n=i(197),o=i(421),a=function(){function t(t){this.className="BezierPath",this.START_POINT=0,this.START_CONTROL_POINT=1,this.END_CONTROL_POINT=2,this.END_POINT=3,this.uid=n.UIDGenerator.next(),t||(t=[]),this.totalArcLength=0,this.adjustCircular=!1,this.bezierCurves=[]}return t.prototype.addCurve=function(t){if(null==t||void 0===t)throw"Cannot add null curve to bÃ©zier path.";this.bezierCurves.push(t),this.bezierCurves.length>1?(t.startPoint=this.bezierCurves[this.bezierCurves.length-2].endPoint,this.adjustSuccessorControlPoint(this.bezierCurves.length-2,!0,!0)):this.totalArcLength+=t.getLength()},t.prototype.locateCurveByStartPoint=function(t){for(var e=0;e<this.bezierCurves.length;e++)if(this.bezierCurves[e].startPoint.equals(t))return e;return-1},t.prototype.locateCurveByEndPoint=function(t){for(var e=0;e<this.bezierCurves.length;e++)if(this.bezierCurves[e].endPoint.equals(t))return e;return-1},t.prototype.locateCurveByStartControlPoint=function(t){for(var e=0;e<this.bezierCurves.length;e++)if(this.bezierCurves[e].startControlPoint.equals(t))return e;return-1},t.prototype.locateCurveByEndControlPoint=function(t){for(var e=0;e<this.bezierCurves.length;e++)if(this.bezierCurves[e].endControlPoint.equals(t))return e;return-1},t.prototype.getLength=function(){return this.totalArcLength},t.prototype.updateArcLengths=function(){this.totalArcLength=0;for(var t=0;t<this.bezierCurves.length;t++)this.bezierCurves[t].updateArcLengths(),this.totalArcLength+=this.bezierCurves[t].getLength()},t.prototype.getCurveCount=function(){return this.bezierCurves.length},t.prototype.getCurveAt=function(t){return this.bezierCurves[t]},t.prototype.translate=function(t){for(var e=0;e<this.bezierCurves.length;e++)(i=this.bezierCurves[e]).getStartPoint().add(t),i.getStartControlPoint().add(t),i.getEndControlPoint().add(t);var i;return(i=this.bezierCurves[this.bezierCurves.length-1]).getEndPoint().add(t),this.updateArcLengths(),this},t.prototype.scale=function(t,e){for(var i=0;i<this.bezierCurves.length;i++){var s=this.bezierCurves[i];s.getStartPoint().scale(e,t),s.getStartControlPoint().scale(e,t),s.getEndControlPoint().scale(e,t)}return this.bezierCurves.length>0&&!this.adjustCircular&&this.bezierCurves[this.bezierCurves.length-1].getEndPoint().scale(e,t),this.updateArcLengths(),this},t.prototype.rotate=function(t,e){for(var i=0;i<this.bezierCurves.length;i++){var s=this.bezierCurves[i];s.getStartPoint().rotate(t,e),s.getStartControlPoint().rotate(t,e),s.getEndControlPoint().rotate(t,e)}this.bezierCurves.length>0&&!this.adjustCircular&&this.bezierCurves[this.bezierCurves.length-1].getEndPoint().rotate(t,e)},t.prototype.getClosestT=function(t){for(var e=-1,i=0,s=0,r=0,n=0,o=0,a=0;a<this.bezierCurves.length;a++)r=this.bezierCurves[a].getClosestT(t),s=this.bezierCurves[a].getPointAt(r).distance(t),(-1==e||s<i)&&(e=a,i=s,n=o+r*this.bezierCurves[a].getLength()),o+=this.bezierCurves[a].getLength();return Math.max(0,Math.min(1,n/this.totalArcLength))},t.prototype.getPoint=function(t){(t<0||t>this.totalArcLength)&&(console.warn("[BezierPath.getPoint(u)] u is out of bounds: "+t+"."),t=Math.min(this.totalArcLength,Math.max(t,0)));for(var e=0,i=0;e<this.bezierCurves.length&&i+this.bezierCurves[e].getLength()<t;)i+=this.bezierCurves[e].getLength(),e++;if(e>=this.bezierCurves.length)return this.bezierCurves[this.bezierCurves.length-1].getEndPoint().clone();var s=t-i;return this.bezierCurves[e].getPoint(s)},t.prototype.getPointAt=function(t){return this.getPoint(t*this.totalArcLength)},t.prototype.getTangentAt=function(t){return this.getTangent(t*this.totalArcLength)},t.prototype.getTangent=function(t){(t<0||t>this.totalArcLength)&&(console.warn("[BezierPath.getTangent(u)] u is out of bounds: "+t+"."),t=Math.min(this.totalArcLength,Math.max(0,t)));for(var e=0,i=0;e<this.bezierCurves.length&&i+this.bezierCurves[e].getLength()<t;)i+=this.bezierCurves[e].getLength(),e++;var s=t-i;return this.bezierCurves[e].getTangent(s)},t.prototype.getPerpendicularAt=function(t){return this.getPerpendicular(t*this.totalArcLength)},t.prototype.getPerpendicular=function(e){(e<0||e>this.totalArcLength)&&(console.log("[BezierPath.getPerpendicular(u)] u is out of bounds: "+e+"."),e=Math.min(this.totalArcLength,Math.max(0,e)));var i=t._locateUIndex(this,e),s=this.bezierCurves[i.i],r=e-i.uPart;return s.getPerpendicular(r)},t._locateUIndex=function(t,e){for(var i=0,s=0,r=0;i<t.bezierCurves.length&&s+t.bezierCurves[i].getLength()<e;)s+=t.bezierCurves[i].getLength(),i+1<t.bezierCurves.length&&(r+=t.bezierCurves[i].getLength()),i++;return{i,uPart:s,uBefore:r}},t.prototype.getSubPathAt=function(e,i){e=Math.max(0,e),i=Math.min(1,i);var s=e*this.totalArcLength,r=i*this.totalArcLength,n=t._locateUIndex(this,s),o=t._locateUIndex(this,r),a=(s-n.uBefore)/this.bezierCurves[n.i].getLength();if(n.i==o.i){var h=(r-o.uBefore)/this.bezierCurves[o.i].getLength(),l=this.bezierCurves[n.i].getSubCurveAt(a,h);return t.fromArray([l])}var c=[];if(n.i>o.i){l=this.bezierCurves[n.i].getSubCurveAt(a,0),c.push(l);for(var u=n.i-1;u>o.i;u--)c.push(this.bezierCurves[u].clone().reverse());h=(r-o.uBefore)/this.bezierCurves[o.i].getLength(),c.push(this.bezierCurves[o.i].getSubCurveAt(1,h))}else{for(l=this.bezierCurves[n.i].getSubCurveAt(a,1),c.push(l),u=n.i+1;u<o.i&&u<this.bezierCurves.length;u++)c.push(this.bezierCurves[u].clone());h=(r-o.uBefore)/this.bezierCurves[o.i].getLength(),c.push(this.bezierCurves[o.i].getSubCurveAt(0,h))}return t.fromArray(c)},t.prototype.moveCurvePoint=function(t,e,i){this.getCurveAt(t).moveCurvePoint(e,i,!0,!0),e==this.START_POINT&&(t>0||this.adjustCircular)?this.getCurveAt(t-1<0?this.bezierCurves.length+(t-1):t-1).moveCurvePoint(this.END_CONTROL_POINT,i,!0,!1):e==this.END_POINT&&(t+1<this.bezierCurves.length||this.adjustCircular)?this.getCurveAt((t+1)%this.bezierCurves.length).moveCurvePoint(this.START_CONTROL_POINT,i,!0,!1):e==this.START_CONTROL_POINT&&t>0?this.adjustPredecessorControlPoint(t,!0,!1):e==this.END_CONTROL_POINT&&t+1<this.getCurveCount()&&this.adjustSuccessorControlPoint(t,!0,!1),this.updateArcLengths()},t.prototype.adjustPredecessorControlPoint=function(e,i,s){if(this.adjustCircular||!(e<=0)){var r=this.getCurveAt(e),n=this.getCurveAt(e-1<0?this.getCurveCount()+(e-1):e-1);t.adjustNeighbourControlPoint(r,n,r.getStartPoint(),r.getStartControlPoint(),n.getEndPoint(),n.getEndControlPoint(),i,s)}},t.prototype.adjustSuccessorControlPoint=function(e,i,s){if(this.adjustCircular||!(e+1>this.getCurveCount())){var r=this.getCurveAt(e),n=this.getCurveAt((e+1)%this.getCurveCount());t.adjustNeighbourControlPoint(r,n,r.getEndPoint(),r.getEndControlPoint(),n.getStartPoint(),n.getStartControlPoint(),i,s)}},t.adjustNeighbourControlPoint=function(t,e,i,s,r,n,a,h){var l=new o.Vertex(s.x-i.x,s.y-i.y),c=new o.Vertex(n.x-r.x,n.y-r.y),u=Math.sqrt(Math.pow(l.x,2)+Math.pow(l.y,2)),d=Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2));u<=.1||(a?n.set(r.x-l.x*(d/u),r.y-l.y*(d/u)):n.set(r.x-l.x,r.y-l.y),e.updateArcLengths())},t.prototype.getBounds=function(){for(var t,e=new o.Vertex(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i=new o.Vertex(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),r=0;r<this.bezierCurves.length;r++)t=this.bezierCurves[r].getBounds(),e.x=Math.min(e.x,t.min.x),e.y=Math.min(e.y,t.min.y),i.x=Math.max(i.x,t.max.x),i.y=Math.max(i.y,t.max.y);return new s.Bounds(e,i)},t.prototype.clone=function(){for(var e=new t(void 0),i=0;i<this.bezierCurves.length;i++)e.bezierCurves.push(this.bezierCurves[i].clone()),i>0&&(e.bezierCurves[i-1].endPoint=e.bezierCurves[i].startPoint);return e.updateArcLengths(),e.adjustCircular=this.adjustCircular,e},t.prototype.equals=function(t){if(!t)return!1;if(!t.bezierCurves)return!1;if(void 0===t.bezierCurves.length)return!1;if(t.bezierCurves.length!=this.bezierCurves.length)return!1;for(var e=0;e<this.bezierCurves.length;e++)if(!this.bezierCurves[e].equals(t.bezierCurves[e]))return!1;return!0},t.prototype.toSVGString=function(t){t=t||{};var e=[];e.push("<path"),t.className&&e.push(' class="'+t.className+'"'),e.push(' d="');for(var i=0;i<this.bezierCurves.length;i++)i>0&&e.push(" "),e.push(this.bezierCurves[i].toSVGPathData());return e.push('" />'),e.join("")},t.prototype.toJSON=function(t){var e=[];e.push("[");for(var i=0;i<this.bezierCurves.length;i++)i>0&&e.push(","),t?e.push("\n\t"):e.push(" "),e.push(this.bezierCurves[i].toJSON(t));return 0!=this.bezierCurves.length&&e.push(" "),e.push("]"),e.join("")},t.fromJSON=function(e){var i=JSON.parse(e);return t.fromArray(i)},t.fromArray=function(e){if(!Array.isArray(e))throw"[BezierPath.fromArray] Passed object must be an array.";var i=e;if(i.length<1)throw"[BezierPath.fromArray] Passed array must contain at least one bezier curve (has "+i.length+").";for(var s=new t(void 0),n=null,o=0;o<i.length;o++){var a;if(r.CubicBezierCurve.isInstance(i[o]))a=i[o].clone();else if(0 in i[o]&&1 in i[o]&&2 in i[o]&&3 in i[o]){if(!(i[o][0]&&i[o][1]&&i[o][2]&&i[o][3]))throw"Cannot convert path data to BezierPath instance. At least one element is undefined (index="+o+"): "+i[o];a=r.CubicBezierCurve.fromArray(i[o])}else a=r.CubicBezierCurve.fromObject(i[o]);n&&(a.startPoint=n.endPoint),s.bezierCurves.push(a),n=a}return s.updateArcLengths(),s},t.prototype.toReducedListRepresentation=function(t){void 0===t&&(t=1);var e=[];e.push("[");for(var i=0;i<this.bezierCurves.length;i++){var s=this.bezierCurves[i];e.push(s.getStartPoint().x.toFixed(t)),e.push(","),e.push(s.getStartPoint().y.toFixed(t)),e.push(","),e.push(s.getStartControlPoint().x.toFixed(t)),e.push(","),e.push(s.getStartControlPoint().y.toFixed(t)),e.push(","),e.push(s.getEndControlPoint().x.toFixed(t)),e.push(","),e.push(s.getEndControlPoint().y.toFixed(t)),e.push(",")}return 0!=this.bezierCurves.length&&(s=this.bezierCurves[this.bezierCurves.length-1],e.push(s.getEndPoint().x.toFixed(t)),e.push(","),e.push(s.getEndPoint().y.toFixed(t))),e.push("]"),e.join("")},t.fromReducedListRepresentation=function(e,i){var s=JSON.parse(e);if(!s.length)throw console.log("Cannot parse bezier path from non-array object nor from empty point list."),"Cannot parse bezier path from non-array object nor from empty point list.";if(s.length<8)throw console.log("Cannot build bezier path. The passed array must contain at least 8 elements (numbers)."),"Cannot build bezier path. The passed array must contain at least 8 elements (numbers).";return t.fromReducedList(s,i)},t.fromReducedList=function(e,i){var s,n,a,h,l=new t(null),c=0;do{0==c&&(s=new o.Vertex(e[c],e[c+1])),n=new o.Vertex(e[c+2],e[c+3]),a=new o.Vertex(e[c+4],e[c+5]),h=new o.Vertex(e[c+6],e[c+7]);var u=new r.CubicBezierCurve(s,h,n,a);l.bezierCurves.push(u),s=h,c+=6}while(c+2<e.length);return l.adjustCircular=i,i&&(l.bezierCurves[l.bezierCurves.length-1].endPoint=l.bezierCurves[0].startPoint),l.updateArcLengths(),l},t.START_POINT=0,t.START_CONTROL_POINT=1,t.END_CONTROL_POINT=2,t.END_POINT=3,t}();e.BezierPath=a},262:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Bounds=void 0;var s=i(661),r=i(421),n=function(){function t(t,e){this.min=t,this.max=e,this.width=e.x-t.x,this.height=e.y-t.y}return t.prototype.toPolygon=function(){return new s.Polygon([new r.Vertex(this.min),new r.Vertex(this.max.x,this.min.y),new r.Vertex(this.max),new r.Vertex(this.min.x,this.max.y)],!1)},t.prototype.getCenter=function(){return new r.Vertex(this.min.x+(this.max.x-this.min.x)/2,this.min.y+(this.max.y-this.min.y)/2)},t.computeFromVertices=function(e){if(0==e.length)return new t(new r.Vertex(0,0),new r.Vertex(0,0));var i,s=e[0].x,n=e[0].x,o=e[0].y,a=e[0].y;for(var h in e)i=e[h],s=Math.min(s,i.x),n=Math.max(n,i.x),o=Math.min(o,i.y),a=Math.max(a,i.y);return new t(new r.Vertex(s,o),new r.Vertex(n,a))},t}();e.Bounds=n},913:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Circle=void 0;var s=i(831),r=i(197),n=i(73),o=i(421),a=function(){function t(t,e){this.className="Circle",this.uid=r.UIDGenerator.next(),this.center=t,this.radius=e}return t.prototype.containsCircle=function(t){return this.center.distance(t.center)+t.radius<this.radius},t.prototype.lineDistance=function(t){return t.getClosestPoint(this.center).distance(this.center)-this.radius},t.prototype.vertAt=function(e){return t.circleUtils.vertAt(e,this.radius).add(this.center)},t.prototype.tangentAt=function(e){var i=t.circleUtils.vertAt(e,this.radius);return new n.Vector(i,new o.Vertex(0,0)).add(this.center).perp()},t.prototype.circleIntersection=function(t){if(this.center.distance(t.center)>this.radius+t.radius)return null;if(this.center.distance(t.center)<Math.abs(this.radius-t.radius))return null;var e=this.center,i=t.center,r=e.distance(i),n=(this.radius*this.radius-t.radius*t.radius+r*r)/(2*r),a=Math.sqrt(this.radius*this.radius-n*n),h=i.clone().scale(n/r,e),l=h.x+a*(i.y-e.y)/r,c=h.y-a*(i.x-e.x)/r,u=h.x-a*(i.y-e.y)/r,d=h.y+a*(i.x-e.x)/r;return new s.Line(new o.Vertex(l,c),new o.Vertex(u,d))},t.prototype.toSVGString=function(t){t=t||{};var e=[];return e.push("<circle"),t.className&&e.push(' class="'+t.className+'"'),e.push(' cx="'+this.center.x+'"'),e.push(' cy="'+this.center.y+'"'),e.push(' r="'+this.radius+'"'),e.push(" />"),e.join("")},t.circleUtils={vertAt:function(t,e){return new o.Vertex(Math.cos(t)*e,Math.sin(t)*e)}},t}();e.Circle=a},946:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CircleSector=void 0;var s=i(197),r=function(){function t(t,e,i){this.className="CircleSector",this.uid=s.UIDGenerator.next(),this.circle=t,this.startAngle=e,this.endAngle=i}return t.prototype.toSVGString=function(e){e=e||{};var i=[];i.push("<path "),e.className&&i.push(' class="'+e.className+'"');var s=t.circleSectorUtils.describeSVGArc(this.circle.center.x,this.circle.center.y,this.circle.radius,this.startAngle,this.endAngle);return i.push(' d="'+s.join(" ")+'" />'),i.join("")},t.circleSectorUtils={polarToCartesian:function(t,e,i,s){return{x:t+i*Math.cos(s),y:e+i*Math.sin(s)}},describeSVGArc:function(e,i,s,r,n,o){void 0===o&&(o={moveToStart:!0});var a=t.circleSectorUtils.polarToCartesian(e,i,s,n),h=t.circleSectorUtils.polarToCartesian(e,i,s,r);if(2*Math.PI-Math.abs(r-n)<.001){var l=t.circleSectorUtils.describeSVGArc(e,i,s,r,r+(n-r)/2,o),c=t.circleSectorUtils.describeSVGArc(e,i,s,r+(n-r)/2,n,o);return l.concat(c)}var u,d,p=n-r;p<0?(u=Math.abs(p)<Math.PI?1:0,d=1):(u=Math.abs(p)>Math.PI?1:0,d=1);var f=[];return o.moveToStart&&f.push("M",h.x,h.y),f.push("A",s,s,0,u,d,a.x,a.y),f}},t}();e.CircleSector=r},510:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CubicBezierCurve=void 0;var s=i(262),r=i(197),n=i(421),o=i(73),a=function(){function t(e,i,s,n){this.START_POINT=t.START_POINT,this.START_CONTROL_POINT=t.START_CONTROL_POINT,this.END_CONTROL_POINT=t.END_CONTROL_POINT,this.END_POINT=t.END_POINT,this.uid=r.UIDGenerator.next(),this.startPoint=e,this.startControlPoint=s,this.endPoint=i,this.endControlPoint=n,this.curveIntervals=30,this.segmentCache=[],this.segmentLengths=[],this.arcLength=null,this.updateArcLengths()}return t.prototype.moveCurvePoint=function(t,e,i,s){t==this.START_POINT?(this.getStartPoint().add(e),i&&this.getStartControlPoint().add(e)):t==this.START_CONTROL_POINT?this.getStartControlPoint().add(e):t==this.END_CONTROL_POINT?this.getEndControlPoint().add(e):t==this.END_POINT?(this.getEndPoint().add(e),i&&this.getEndControlPoint().add(e)):console.log("[CubicBezierCurve.moveCurvePoint] pointID '"+t+"' invalid."),s&&this.updateArcLengths()},t.prototype.translate=function(t){return this.startPoint.add(t),this.startControlPoint.add(t),this.endControlPoint.add(t),this.endPoint.add(t),this},t.prototype.reverse=function(){var t=this.startPoint;return this.startPoint=this.endPoint,this.endPoint=t,t=this.startControlPoint,this.startControlPoint=this.endControlPoint,this.endControlPoint=t,this},t.prototype.getLength=function(){return this.arcLength},t.prototype.updateArcLengths=function(){var t=this.startPoint.clone(),e=new n.Vertex(0,0),i=1/this.curveIntervals;this.segmentCache=[],this.segmentCache.push(this.startPoint),this.segmentLengths=[];for(var s,r=0,o=0;o<=1;)e=this.getPointAt(o),this.segmentCache.push(e),s=t.distance(e),this.segmentLengths.push(s),r+=s,t=e,o+=i;this.arcLength=r},t.prototype.getClosestT=function(t){var e={t:0,tPrev:0,tNext:1},i=0;do{e=this.locateIntervalByDistance(t,e.tPrev,e.tNext,this.curveIntervals),i++}while(i<4&&this.getPointAt(e.tPrev).distance(this.getPointAt(e.tNext))>1);return e.t},t.prototype.locateIntervalByDistance=function(t,e,i,s){for(var r=-1,n=0,o=0,a=i-e,h=0;h<=s;h++){o=e+a*(h/s);var l=this.getPointAt(o).distance(t);(-1==r||l<n)&&(r=h,n=l)}return{t:e+a*(r/s),tPrev:e+a*(Math.max(0,r-1)/s),tNext:e+a*(Math.min(s,r+1)/s)}},t.prototype.getBounds=function(){for(var t,e=new n.Vertex(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i=new n.Vertex(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),r=0;r<this.segmentCache.length;r++)t=this.segmentCache[r],e.x=Math.min(e.x,t.x),e.y=Math.min(e.y,t.y),i.x=Math.max(i.x,t.x),i.y=Math.max(i.y,t.y);return new s.Bounds(e,i)},t.prototype.getStartPoint=function(){return this.startPoint},t.prototype.getEndPoint=function(){return this.endPoint},t.prototype.getStartControlPoint=function(){return this.startControlPoint},t.prototype.getEndControlPoint=function(){return this.endControlPoint},t.prototype.getPointByID=function(t){if(t==this.START_POINT)return this.startPoint;if(t==this.END_POINT)return this.endPoint;if(t==this.START_CONTROL_POINT)return this.startControlPoint;if(t==this.END_CONTROL_POINT)return this.endControlPoint;throw new Error("Invalid point ID '"+t+"'.")},t.prototype.getPointAt=function(t){var e=this.startPoint.x*Math.pow(1-t,3)+3*this.startControlPoint.x*t*Math.pow(1-t,2)+3*this.endControlPoint.x*Math.pow(t,2)*(1-t)+this.endPoint.x*Math.pow(t,3),i=this.startPoint.y*Math.pow(1-t,3)+3*this.startControlPoint.y*t*Math.pow(1-t,2)+3*this.endControlPoint.y*Math.pow(t,2)*(1-t)+this.endPoint.y*Math.pow(t,3);return new n.Vertex(e,i)},t.prototype.getPoint=function(t){return this.getPointAt(t/this.arcLength)},t.prototype.getTangentAt=function(t){var e=this.getStartPoint(),i=this.getStartControlPoint(),s=this.getEndControlPoint(),r=this.getEndPoint(),o=t*t,a=1-2*t+o,h=-3*e.x*a+i.x*(3*a-6*(t-o))+s.x*(6*(t-o)-3*o)+3*r.x*o,l=-3*e.y*a+i.y*(3*a-6*(t-o))+s.y*(6*(t-o)-3*o)+3*r.y*o;return new n.Vertex(h,l)},t.prototype.getSubCurveAt=function(e,i){var s=new o.Vector(this.getPointAt(e),this.getTangentAt(e)),r=new o.Vector(this.getPointAt(i),this.getTangentAt(i).inv());return s.b.add(s.a),r.b.add(r.a),s.scale(.33333333*(i-e)),r.scale(.33333333*(i-e)),new t(s.a,r.a,s.b,r.b)},t.prototype.convertU2T=function(t){return Math.max(0,Math.min(1,t/this.arcLength))},t.prototype.getTangent=function(t){return this.getTangentAt(this.convertU2T(t))},t.prototype.getPerpendicular=function(t){return this.getPerpendicularAt(this.convertU2T(t))},t.prototype.getPerpendicularAt=function(t){var e=this.getTangentAt(t);return new n.Vertex(e.y,-e.x)},t.prototype.clone=function(){return new t(this.getStartPoint().clone(),this.getEndPoint().clone(),this.getStartControlPoint().clone(),this.getEndControlPoint().clone())},t.prototype.equals=function(t){return!!t&&!!(t.startPoint&&t.endPoint&&t.startControlPoint&&t.endControlPoint)&&this.startPoint.equals(t.startPoint)&&this.endPoint.equals(t.endPoint)&&this.startControlPoint.equals(t.startControlPoint)&&this.endControlPoint.equals(t.endControlPoint)},t.isInstance=function(e){return e instanceof t},t.prototype.toSVGPathData=function(){var t=[];return t.push("M "),t.push(this.startPoint.x.toString()),t.push(" "),t.push(this.startPoint.y.toString()),t.push(" C "),t.push(this.startControlPoint.x.toString()),t.push(" "),t.push(this.startControlPoint.y.toString()),t.push(" "),t.push(this.endControlPoint.x.toString()),t.push(" "),t.push(this.endControlPoint.y.toString()),t.push(" "),t.push(this.endPoint.x.toString()),t.push(" "),t.push(this.endPoint.y.toString()),t.join("")},t.prototype.toJSON=function(t){return"{ "+(t?"\n\t":"")+'"startPoint" : ['+this.getStartPoint().x+","+this.getStartPoint().y+"], "+(t?"\n\t":"")+'"endPoint" : ['+this.getEndPoint().x+","+this.getEndPoint().y+"], "+(t?"\n\t":"")+'"startControlPoint": ['+this.getStartControlPoint().x+","+this.getStartControlPoint().y+"], "+(t?"\n\t":"")+'"endControlPoint" : ['+this.getEndControlPoint().x+","+this.getEndControlPoint().y+"]"+(t?"\n\t":"")+" }"},t.fromJSON=function(e){var i=JSON.parse(e);return t.fromObject(i)},t.fromObject=function(e){if("object"!=typeof e)throw"Can only build from object.";if(!e.startPoint)throw'Object member "startPoint" missing.';if(!e.endPoint)throw'Object member "endPoint" missing.';if(!e.startControlPoint)throw'Object member "startControlPoint" missing.';if(!e.endControlPoint)throw'Object member "endControlPoint" missing.';return new t(new n.Vertex(e.startPoint[0],e.startPoint[1]),new n.Vertex(e.endPoint[0],e.endPoint[1]),new n.Vertex(e.startControlPoint[0],e.startControlPoint[1]),new n.Vertex(e.endControlPoint[0],e.endControlPoint[1]))},t.fromArray=function(e){if(!Array.isArray(e))throw"Can only build from object.";if(4!=e.length)throw"Can only build from array with four elements.";return new t(e[0],e[1],e[2],e[3])},t.START_POINT=0,t.START_CONTROL_POINT=1,t.END_CONTROL_POINT=2,t.END_POINT=3,t}();e.CubicBezierCurve=a},843:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Grid=void 0;var i=function(){function t(t,e){this.center=t,this.size=e}return t.utils={baseLog:function(t,e){return Math.log(t)/Math.log(e)},mapRasterScale:function(e,i){var s=1;return i>=1?(s=Math.abs(Math.floor(1/t.utils.baseLog(e,i))),s=1/Math.pow(e,s)):s=Math.abs(Math.floor(t.utils.baseLog(1/e,1/(i+1)))),s}},t}();e.Grid=i},909:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.KeyHandler=void 0;var i=function(){function t(t){this.downListeners=[],this.pressListeners=[],this.upListeners=[],this.keyStates={},t=t||{},this.element=t.element?t.element:globalThis,this.downListeners=[],this.pressListeners=[],this.upListeners=[],this.keyStates=[],this.trackAllKeys=t.trackAll||!1,this.installListeners()}return t.prototype.fireEvent=function(t,e){var i=!1;for(var s in e){var r=e[s];r.keyCode==t.keyCode&&(r.listener(t),i=!0)}return i},t.prototype.fireDownEvent=function(t,e){(e.fireEvent(t,e.downListeners)||e.trackAllKeys)&&(e.keyStates[t.keyCode]="down")},t.prototype.firePressEvent=function(t,e){e.fireEvent(t,e.pressListeners)},t.prototype.fireUpEvent=function(t,e){(e.fireEvent(t,e.upListeners)||e.trackAllKeys)&&delete e.keyStates[t.keyCode]},t.key2code=function(e){if("number"==typeof e)return e;if("string"!=typeof e)throw"Unknown key name or key type (should be a string or integer): "+e;if(t.KEY_CODES[e])return t.KEY_CODES[e];throw"Unknown key (cannot resolve key code): "+e},t.prototype.installListeners=function(){var t=this;this.element.addEventListener("keydown",this._keyDownListener=function(e){t.fireDownEvent(e,t)}),this.element.addEventListener("keypress",this._keyPressListener=function(e){t.firePressEvent(e,t)}),this.element.addEventListener("keyup",this._keyUpListener=function(e){t.fireUpEvent(e,t)})},t.prototype.releaseListeners=function(){this.element.removeEventListener("keydown",this._keyDownListener),this.element.removeEventListener("keypress",this._keyPressListener),this.element.removeEventListener("keyup",this._keyUpListener)},t.prototype.down=function(e,i){return this.downListeners.push({key:e,keyCode:t.key2code(e),listener:i}),this},t.prototype.press=function(e,i){return this.pressListeners.push({key:e,keyCode:t.key2code(e),listener:i}),this},t.prototype.up=function(e,i){return this.upListeners.push({key:e,keyCode:t.key2code(e),listener:i}),this},t.prototype.isDown=function(e){return"number"==typeof e?!!this.keyStates[e]:!!this.keyStates[t.key2code(e)]},t.KEY_CODES={break:3,backspace:8,tab:9,clear:12,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,hangul:21,hanja:25,escape:27,conversion:28,"non-conversion":29,spacebar:32,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,select:41,print:42,execute:43,printscreen:44,insert:45,delete:46,help:47,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,":":58,"semicolon (firefox)":59,equals:59,"<":60,"equals (firefox)":61,Ã:63,"@ (firefox)":64,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,windows:91,leftcommand:91,chromebooksearch:91,rightwindowkey:92,windowsmenu:93,rightcommant:93,sleep:95,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,numpadperiod:108,subtract:109,decimalpoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,f13:124,f14:125,f15:126,f16:127,f17:128,f18:129,f19:130,f20:131,f21:132,f22:133,f23:134,f24:135,numlock:144,scrolllock:145,"^":160,"!":161,"#":163,$:164,Ã¹:165,pagebackward:166,pageforward:167,refresh:168,closingparen:169,"*":170,"~+*":171,minus:173,decreasevolumelevel:174,increasevolumelevel:175,next:176,previous:177,stop:178,"play/pause":179,email:180,mute:181,unmute:181,semicolon:186,Ã±:186,equal:187,comma:188,dash:189,period:190,forwardslash:191,Ã§:191,"grave accent":192,Ã¦:192,Ã¶:192,"?":193,"/":193,"Â°":193,openbracket:219,backslash:220,closebracket:221,Ã¥:221,singlequote:222,Ã¸:222,Ã¤:222,"`":223,altgr:225,"GNOME Compose Key":230,XF86Forward:233,XF86Back:234,alphanumeric:240,hiragana:242,katakana:242,"half-width":243,"full-width":243,kanji:244,unlocktrackpad:251,toggletouchpad:255},t}();e.KeyHandler=i},831:function(t,e,i){var s,r=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Line=void 0;var n=i(72),o=i(421),a=function(t){function e(i,s){var r=t.call(this,i,s,(function(t,i){return new e(t,i)}))||this;return r.className="Line",r}return r(e,t),e.prototype.intersection=function(t){var e=this.denominator(t);if(0==e)return null;var i=this.a.y-t.a.y,s=this.a.x-t.a.x,r=(t.b.x-t.a.x)*i-(t.b.y-t.a.y)*s,n=(this.b.x-this.a.x)*i-(this.b.y-this.a.y)*s;i=r/e,s=n/e;var a=this.a.x+i*(this.b.x-this.a.x),h=this.a.y+i*(this.b.y-this.a.y);return isNaN(i)||isNaN(a)||isNaN(h)?void 0:new o.Vertex(a,h)},e.prototype.toSVGString=function(t){t=t||{};var e=[];return e.push("<line"),t.className&&e.push(' class="'+t.className+'"'),e.push(' x1="'+this.a.x+'"'),e.push(' y1="'+this.a.y+'"'),e.push(' x2="'+this.b.x+'"'),e.push(' y2="'+this.b.y+'"'),e.push(" />"),e.join("")},e}(n.VertTuple);e.Line=a},293:function(t,e){var i,s=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function s(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandler=e.XWheelEvent=e.XMouseEvent=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(MouseEvent);e.XMouseEvent=r;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(WheelEvent);e.XWheelEvent=n;var o=function(){function t(t,e){this.mouseDownPos=void 0,this.mouseDragPos=void 0,this.mouseButton=-1,this.listeners={},this.installed={},this.handlers={},this.name=e,this.element=t,this.mouseDownPos=null,this.mouseDragPos=null,this.mouseButton=-1,this.listeners={},this.installed={},this.handlers={};var i=this;this.handlers.mousemove=function(t){i.listeners.mousemove&&i.listeners.mousemove(i.mkParams(t,"mousemove")),i.mouseDragPos&&i.listeners.drag&&i.listeners.drag(i.mkParams(t,"drag")),i.mouseDownPos&&(i.mouseDragPos=i.relPos(t))},this.handlers.mouseup=function(t){i.listeners.mouseup&&i.listeners.mouseup(i.mkParams(t,"mouseup")),i.mouseDragPos=void 0,i.mouseDownPos=void 0,i.mouseButton=-1},this.handlers.mousedown=function(t){i.mouseDragPos=i.relPos(t),i.mouseDownPos=i.relPos(t),i.mouseButton=t.button,i.listeners.mousedown&&i.listeners.mousedown(i.mkParams(t,"mousedown"))},this.handlers.click=function(t){i.listeners.click&&i.listeners.click(i.mkParams(t,"click"))},this.handlers.wheel=function(t){i.listeners.wheel&&i.listeners.wheel(i.mkParams(t,"wheel"))},this.element.addEventListener("mousemove",this.handlers.mousemove),this.element.addEventListener("mouseup",this.handlers.mouseup),this.element.addEventListener("mousedown",this.handlers.mousedown),this.element.addEventListener("click",this.handlers.click),this.element.addEventListener("wheel",this.handlers.wheel)}return t.prototype.relPos=function(t){return{x:t.offsetX,y:t.offsetY}},t.prototype.mkParams=function(t,e){var i=this.relPos(t),s=t;return s.params={element:this.element,name:e,isTouchEvent:!1,pos:i,button:this.mouseButton,leftButton:0==this.mouseButton,middleButton:1==this.mouseButton,rightButton:2==this.mouseButton,mouseDownPos:this.mouseDownPos,draggedFrom:this.mouseDragPos,wasDragged:null!=this.mouseDownPos&&(this.mouseDownPos.x!=i.x||this.mouseDownPos.y!=i.y),dragAmount:null!=this.mouseDownPos?{x:i.x-this.mouseDragPos.x,y:i.y-this.mouseDragPos.y}:{x:0,y:0}},s},t.prototype.listenFor=function(t){this.installed[t]||(this.installed[t]=!0)},t.prototype.unlistenFor=function(t){this.installed[t]&&delete this.installed[t]},t.prototype.drag=function(t){return this.listeners.drag&&this.throwAlreadyInstalled("drag"),this.listeners.drag=t,this.listenFor("mousedown"),this.listenFor("mousemove"),this.listenFor("mouseup"),this},t.prototype.move=function(t){return this.listeners.mousemove&&this.throwAlreadyInstalled("mousemove"),this.listenFor("mousemove"),this.listeners.mousemove=t,this},t.prototype.up=function(t){return this.listeners.mouseup&&this.throwAlreadyInstalled("mouseup"),this.listenFor("mouseup"),this.listeners.mouseup=t,this},t.prototype.down=function(t){return this.listeners.mousedown&&this.throwAlreadyInstalled("mousedown"),this.listenFor("mousedown"),this.listeners.mousedown=t,this},t.prototype.click=function(t){return this.listeners.click&&this.throwAlreadyInstalled("click"),this.listenFor("click"),this.listeners.click=t,this},t.prototype.wheel=function(t){return this.listeners.wheel&&this.throwAlreadyInstalled("wheel"),this.listenFor("wheel"),this.listeners.wheel=t,this},t.prototype.throwAlreadyInstalled=function(t){throw"This MouseHandler already has a '"+t+"' callback. To keep the code simple there is only room for one."},t.prototype.destroy=function(){this.unlistenFor("mousedown"),this.unlistenFor("mousemove"),this.unlistenFor("moseup"),this.unlistenFor("click"),this.unlistenFor("wheel"),this.element.removeEventListener("mousemove",this.handlers.mousemove),this.element.removeEventListener("mouseup",this.handlers.mousedown),this.element.removeEventListener("mousedown",this.handlers.mousedown),this.element.removeEventListener("click",this.handlers.click),this.element.removeEventListener("wheel",this.handlers.wheel)},t}();e.MouseHandler=o},699:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PBImage=void 0;var s=i(197),r=function(){function t(t,e,i){this.className="PBImage",this.uid=s.UIDGenerator.next(),this.image=t,this.upperLeft=e,this.lowerRight=i}return t.prototype.toSVGString=function(t){return console.warn("PBImage is not yet SVG serializable. Returning empty SVG string."),""},t}();e.PBImage=r},919:(t,e,i)=>{e.H4=void 0;var s=i(318),r=i(149),n=i(349),o=i(829),a=i(126),h=i(262),l=i(913),c=i(946),u=i(843),d=i(909),p=i(831),f=i(293),y=i(699),g=i(661),v=i(212),x=i(112),m=i(965),b=i(73),w=i(421),C=i(861),P=function(){function t(e){if(this.renderTime=0,C.VertexAttr.model={bezierAutoAdjust:!1,renderTime:0,selectable:!0,isSelected:!1,draggable:!0,visible:!0},void 0===e.canvas)throw"No canvas specified.";var i=t.utils.fetch;this.config={canvas:e.canvas,fullSize:i.val(e,"fullSize",!0),fitToParent:i.bool(e,"fitToParent",!0),scaleX:i.num(e,"scaleX",1),scaleY:i.num(e,"scaleY",1),offsetX:i.num(e,"offsetX",0),offsetY:i.num(e,"offsetY",0),rasterGrid:i.bool(e,"rasterGrid",!0),rasterScaleX:i.num(e,"rasterScaleX",1),rasterScaleY:i.num(e,"rasterScaleY",1),rasterAdjustFactor:i.num(e,"rasterAdjustdFactror",2),drawOrigin:i.bool(e,"drawOrigin",!1),autoAdjustOffset:i.val(e,"autoAdjustOffset",!0),offsetAdjustXPercent:i.num(e,"offsetAdjustXPercent",50),offsetAdjustYPercent:i.num(e,"offsetAdjustYPercent",50),backgroundColor:e.backgroundColor||"#ffffff",redrawOnResize:i.bool(e,"redrawOnResize",!0),defaultCanvasWidth:i.num(e,"defaultCanvasWidth",t.DEFAULT_CANVAS_WIDTH),defaultCanvasHeight:i.num(e,"defaultCanvasHeight",t.DEFAULT_CANVAS_HEIGHT),canvasWidthFactor:i.num(e,"canvasWidthFactor",1),canvasHeightFactor:i.num(e,"canvasHeightFactor",1),cssScaleX:i.num(e,"cssScaleX",1),cssScaleY:i.num(e,"cssScaleY",1),cssUniformScale:i.bool(e,"cssUniformScale",!0),saveFile:function(){h.hooks.saveFile(h)},setToRetina:function(){h._setToRetina()},autoDetectRetina:i.bool(e,"autoDetectRetina",!0),enableSVGExport:i.bool(e,"enableSVGExport",!0),preClear:i.func(e,"preClear",null),preDraw:i.func(e,"preDraw",null),postDraw:i.func(e,"postDraw",null),enableMouse:i.bool(e,"enableMouse",!0),enableTouch:i.bool(e,"enableTouch",!0),enableKeys:i.bool(e,"enableKeys",!0),enableMouseWheel:i.bool(e,"enableMouseWheel",!0),enableGL:i.bool(e,"enableGL",!1)},this.drawConfig={drawVertices:!0,drawBezierHandleLines:i.bool(e,"drawBezierHandleLines",!0),drawBezierHandlePoints:i.bool(e,"drawBezierHandlePoints",!0),drawHandleLines:i.bool(e,"drawHandleLines",!0),drawHandlePoints:i.bool(e,"drawHandlePoints",!0),drawGrid:i.bool(e,"drawGrid",!0),bezier:{color:"#00a822",lineWidth:2,handleLine:{color:"rgba(180,180,180,0.5)",lineWidth:1}},polygon:{color:"#0022a8",lineWidth:1},triangle:{color:"#6600ff",lineWidth:1},ellipse:{color:"#2222a8",lineWidth:1},ellipseSector:{color:"#a822a8",lineWidth:2},circle:{color:"#22a8a8",lineWidth:2},circleSector:{color:"#2280a8",lineWidth:1},vertex:{color:"#a8a8a8",lineWidth:1},selectedVertex:{color:"#c08000",lineWidth:2},line:{color:"#a844a8",lineWidth:1},vector:{color:"#ff44a8",lineWidth:1},image:{color:"#a8a8a8",lineWidth:1}},this.grid=new u.Grid(new w.Vertex(0,0),new w.Vertex(50,50)),this.canvasSize={width:t.DEFAULT_CANVAS_WIDTH,height:t.DEFAULT_CANVAS_HEIGHT};var s="string"==typeof e.canvas?document.querySelector(e.canvas):e.canvas;if("canvas"===s.tagName.toLowerCase())if(this.canvas=s,this.eventCatcher=this.canvas,this.config.enableGL&&void 0===n.drawutilsgl&&(console.warn("Cannot use webgl. Package was compiled without experimental gl support. Please use plotboilerplate-glsupport.min.js instead."),console.warn("Disabling GL and falling back to Canvas2D."),this.config.enableGL=!1),this.config.enableGL){var a=this.canvas.getContext("webgl");this.draw=new n.drawutilsgl(a,!1),this.fill=this.draw.copyInstance(!0),console.warn("Initialized with experimental mode enableGL=true. Note that this is not yet fully implemented.")}else a=this.canvas.getContext("2d"),this.draw=new r.drawutils(a,!1),this.fill=new r.drawutils(a,!0);else{if("svg"!==s.tagName.toLowerCase())throw"Element is neither a canvas nor an svg element.";if(void 0===o.drawutilssvg)throw"The svg draw library is not yet integrated part of PlotBoilerplate. Please include ./src/js/utils/helpers/drawutils.svg into your document.";this.canvas=s,this.draw=new o.drawutilssvg(this.canvas,new w.Vertex,new w.Vertex,this.canvasSize,!1,this.drawConfig,!1),this.fill=this.draw.copyInstance(!0),this.canvas.parentElement?(this.eventCatcher=document.createElement("div"),this.eventCatcher.style.position="absolute",this.eventCatcher.style.left="0",this.eventCatcher.style.top="0",this.eventCatcher.style.cursor="pointer",this.canvas.parentElement.style.position="relative",this.canvas.parentElement.appendChild(this.eventCatcher)):this.eventCatcher=document.body}this.draw.scale.set(this.config.scaleX,this.config.scaleY),this.fill.scale.set(this.config.scaleX,this.config.scaleY),this.vertices=[],this.selectPolygon=null,this.draggedElements=[],this.drawables=[],this.console=console,this.hooks={saveFile:t._saveFile};var h=this;globalThis.addEventListener("resize",(function(){return h.resizeCanvas()})),this.resizeCanvas(),e.autoDetectRetina&&this._setToRetina(),this.installInputListeners(),this.updateCSSscale(),this.redraw(),this.canvas.focus()}var e;return t._saveFile=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=new o.drawutilssvg(e,t.draw.offset,t.draw.scale,t.canvasSize,!1,t.drawConfig),s=i.copyInstance(!0);i.beginDrawCycle(0),s.beginDrawCycle(0),t.config.preClear&&t.config.preClear(),i.clear(t.config.backgroundColor),t.config.preDraw&&t.config.preDraw(i,s),t.drawAll(0,i,s),t.drawVertices(0,i),t.config.postDraw&&t.config.postDraw(i,s),i.endDrawCycle(0),s.endDrawCycle(0);var r=(new XMLSerializer).serializeToString(e),n=new Blob([r],{type:"image/svg;charset=utf-8"});if("function"!=typeof globalThis.saveAs)throw"Cannot save file; did you load the ./utils/savefile helper function and the eligrey/SaveFile library?";(0,globalThis.saveAs)(n,"plotboilerplate.svg")},t.prototype._setToRetina=function(){this.config.autoDetectRetina=!0;var t=globalThis.devicePixelRatio||1;this.config.cssScaleX=this.config.cssScaleY=1/t,this.config.canvasWidthFactor=this.config.canvasHeightFactor=t,this.resizeCanvas(),this.updateCSSscale()},t.prototype.fitToView=function(t){var e=new w.Vertex(this.canvasSize.width/2,this.canvasSize.height/2),i=this.canvasSize.width/this.canvasSize.height,s=t.width/t.height,r=new w.Vertex(t.max.x-t.width/2,t.max.y-t.height/2).inv().addXY(this.canvasSize.width/2,this.canvasSize.height/2);if(this.setOffset(r),i<s){var n=this.canvasSize.width/t.width;this.setZoom(n,n,e)}else n=this.canvasSize.height/t.height,this.setZoom(n,n,e);this.redraw()},t.prototype.setConsole=function(t){this.console=t},t.prototype.updateCSSscale=function(){this.config.cssUniformScale?t.utils.setCSSscale(this.canvas,this.config.cssScaleX,this.config.cssScaleX):t.utils.setCSSscale(this.canvas,this.config.cssScaleX,this.config.cssScaleY)},t.prototype.add=function(e,i){if(Array.isArray(e))for(var s=e,r=0;r<s.length;r++)this.add(s[r],!1);else if(e instanceof w.Vertex)this.drawables.push(e),this.vertices.push(e);else if(e instanceof p.Line)this.drawables.push(e),this.vertices.push(e.a),this.vertices.push(e.b);else if(e instanceof b.Vector)this.drawables.push(e),this.vertices.push(e.a),this.vertices.push(e.b);else if(e instanceof x.VEllipse)this.vertices.push(e.center),this.vertices.push(e.axis),this.drawables.push(e),e.center.listeners.addDragListener((function(t){e.axis.add(t.params.dragAmount)}));else if(e instanceof m.VEllipseSector)this.vertices.push(e.ellipse.center),this.vertices.push(e.ellipse.axis),this.drawables.push(e),e.ellipse.center.listeners.addDragListener((function(t){e.ellipse.axis.add(t.params.dragAmount)}));else if(e instanceof l.Circle)this.vertices.push(e.center),this.drawables.push(e);else if(e instanceof c.CircleSector)this.vertices.push(e.circle.center),this.drawables.push(e);else if(e instanceof g.Polygon)for(this.drawables.push(e),r=0;r<e.vertices.length;r++)this.vertices.push(e.vertices[r]);else if(e instanceof v.Triangle)this.drawables.push(e),this.vertices.push(e.a),this.vertices.push(e.b),this.vertices.push(e.c);else if(e instanceof a.BezierPath){this.drawables.push(e);var n=e;for(r=0;r<n.bezierCurves.length;r++)e.adjustCircular||0!=r||this.vertices.push(n.bezierCurves[r].startPoint),this.vertices.push(n.bezierCurves[r].endPoint),this.vertices.push(n.bezierCurves[r].startControlPoint),this.vertices.push(n.bezierCurves[r].endControlPoint),n.bezierCurves[r].startControlPoint.attr.selectable=!1,n.bezierCurves[r].endControlPoint.attr.selectable=!1;t.utils.enableBezierPathAutoAdjust(e)}else{if(!(e instanceof y.PBImage))throw"Cannot add drawable of unrecognized type: "+typeof e+".";this.vertices.push(e.upperLeft),this.vertices.push(e.lowerRight),this.drawables.push(e),e.upperLeft.listeners.addDragListener((function(t){e.lowerRight.add(t.params.dragAmount)})),e.lowerRight.attr.selectable=!1}(i||void 0===i)&&this.redraw()},t.prototype.remove=function(t,e,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)this.remove(t[s],!1,i);e&&this.redraw()}else for(t instanceof w.Vertex&&(this.removeVertex(t,!1),e&&this.redraw()),s=0;s<this.drawables.length;s++)if(this.drawables[s]===t){if(this.drawables.splice(s,1),i)if(t instanceof p.Line)this.removeVertex(t.a,!1),this.removeVertex(t.b,!1);else if(t instanceof b.Vector)this.removeVertex(t.a,!1),this.removeVertex(t.b,!1);else if(t instanceof x.VEllipse)this.removeVertex(t.center,!1),this.removeVertex(t.axis,!1);else if(t instanceof m.VEllipseSector)this.removeVertex(t.ellipse.center),this.removeVertex(t.ellipse.axis);else if(t instanceof l.Circle)this.removeVertex(t.center,!1);else if(t instanceof c.CircleSector)this.removeVertex(t.circle.center,!1);else if(t instanceof g.Polygon)for(s=0;s<t.vertices.length;s++)this.removeVertex(t.vertices[s],!1);else if(t instanceof v.Triangle)this.removeVertex(t.a,!1),this.removeVertex(t.b,!1),this.removeVertex(t.c,!1);else if(t instanceof a.BezierPath)for(s=0;s<t.bezierCurves.length;s++)this.removeVertex(t.bezierCurves[s].startPoint,!1),this.removeVertex(t.bezierCurves[s].startControlPoint,!1),this.removeVertex(t.bezierCurves[s].endControlPoint,!1),s+1==t.bezierCurves.length&&this.removeVertex(t.bezierCurves[s].endPoint,!1);else t instanceof y.PBImage&&(this.removeVertex(t.upperLeft,!1),this.removeVertex(t.lowerRight,!1));e&&this.redraw()}},t.prototype.removeVertex=function(t,e){for(var i=0;i<this.vertices.length;i++)if(this.vertices[i]===t)return this.vertices.splice(i,1),void(e&&this.redraw())},t.prototype.removeAll=function(t){this.drawables=[],Boolean(t)||(this.vertices=[]),this.redraw()},t.prototype.getVertexNear=function(t,e){var i=this.locatePointNear(this.transformMousePosition(t.x,t.y),e/Math.min(this.config.cssScaleX,this.config.cssScaleY));if(i&&"vertex"==i.typeName)return this.vertices[i.vindex]},t.prototype.drawGrid=function(t){void 0===t&&(t=this.draw);var e=u.Grid.utils.mapRasterScale(this.config.rasterAdjustFactor,this.draw.scale.x)*this.config.rasterScaleX/this.config.cssScaleX,i=u.Grid.utils.mapRasterScale(this.config.rasterAdjustFactor,this.draw.scale.y)*this.config.rasterScaleY/this.config.cssScaleY,s={width:this.grid.size.x*e,height:this.grid.size.y*i},r=this.canvasSize.width/2,n=this.canvasSize.height/2,o=this.draw.offset.clone().inv();o.x=Math.round(o.x+r)/Math.round(s.width)*s.width/this.draw.scale.x+(this.draw.offset.x-r)/this.draw.scale.x%s.width,o.y=Math.round(o.y+n)/Math.round(s.height)*s.height/this.draw.scale.y+(this.draw.offset.y-n)/this.draw.scale.x%s.height,this.drawConfig.drawGrid&&(t.setCurrentClassName(null),this.config.rasterGrid?(t.setCurrentId("raster"),t.raster(o,this.canvasSize.width/this.draw.scale.x,this.canvasSize.height/this.draw.scale.y,s.width,s.height,"rgba(0,128,255,0.125)")):(t.setCurrentId("grid"),t.grid(o,this.canvasSize.width/this.draw.scale.x,this.canvasSize.height/this.draw.scale.y,s.width,s.height,"rgba(0,128,255,0.095)")))},t.prototype.drawOrigin=function(t){t.setCurrentId("origin"),t.crosshair({x:0,y:0},10,"#000000")},t.prototype._handleColor=function(t,e){return t.attr.isSelected?this.drawConfig.selectedVertex.color:t.attr.draggable?e:"rgba(128,128,128,0.5)"},t.prototype.drawDrawables=function(t,e,i){for(var s in this.drawables){var r=this.drawables[s];this.draw.setCurrentId(r.uid),this.fill.setCurrentId(r.uid),this.draw.setCurrentClassName(r.className),this.draw.setCurrentClassName(r.className),this.drawDrawable(r,t,e,i)}},t.prototype.drawDrawable=function(t,e,i,s){if(t instanceof a.BezierPath)for(var r in t.bezierCurves)i.cubicBezier(t.bezierCurves[r].startPoint,t.bezierCurves[r].endPoint,t.bezierCurves[r].startControlPoint,t.bezierCurves[r].endControlPoint,this.drawConfig.bezier.color,this.drawConfig.bezier.lineWidth),this.drawConfig.drawBezierHandlePoints&&this.drawConfig.drawHandlePoints?(t.bezierCurves[r].startPoint.attr.bezierAutoAdjust||(t.bezierCurves[r].startPoint.attr.visible&&(i.setCurrentId(t.uid+"_h0"),i.setCurrentClassName(t.className+"-start-handle"),i.diamondHandle(t.bezierCurves[r].startPoint,7,this._handleColor(t.bezierCurves[r].startPoint,this.drawConfig.vertex.color))),t.bezierCurves[r].startPoint.attr.renderTime=e),t.bezierCurves[r].endPoint.attr.bezierAutoAdjust||(t.bezierCurves[r].endPoint.attr.visible&&(i.setCurrentId(t.uid+"_h1"),i.setCurrentClassName(t.className+"-end-handle"),i.diamondHandle(t.bezierCurves[r].endPoint,7,this._handleColor(t.bezierCurves[r].endPoint,this.drawConfig.vertex.color))),t.bezierCurves[r].endPoint.attr.renderTime=e),t.bezierCurves[r].startControlPoint.attr.visible&&(i.setCurrentId(t.uid+"_h2"),i.setCurrentClassName(t.className+"-start-control-handle"),i.circleHandle(t.bezierCurves[r].startControlPoint,3,this._handleColor(t.bezierCurves[r].startControlPoint,"#008888"))),t.bezierCurves[r].endControlPoint.attr.visible&&(i.setCurrentId(t.uid+"_h3"),i.setCurrentClassName(t.className+"-end-control-handle"),i.circleHandle(t.bezierCurves[r].endControlPoint,3,this._handleColor(t.bezierCurves[r].endControlPoint,"#008888"))),t.bezierCurves[r].startControlPoint.attr.renderTime=e,t.bezierCurves[r].endControlPoint.attr.renderTime=e):(t.bezierCurves[r].startPoint.attr.renderTime=e,t.bezierCurves[r].endPoint.attr.renderTime=e,t.bezierCurves[r].startControlPoint.attr.renderTime=e,t.bezierCurves[r].endControlPoint.attr.renderTime=e),this.drawConfig.drawBezierHandleLines&&this.drawConfig.drawHandleLines&&(i.setCurrentId(t.uid+"_l0"),i.setCurrentClassName(t.className+"-start-line"),i.line(t.bezierCurves[r].startPoint,t.bezierCurves[r].startControlPoint,this.drawConfig.bezier.handleLine.color,this.drawConfig.bezier.handleLine.lineWidth),i.setCurrentId(t.uid+"_l1"),i.setCurrentClassName(t.className+"-end-line"),i.line(t.bezierCurves[r].endPoint,t.bezierCurves[r].endControlPoint,this.drawConfig.bezier.handleLine.color,this.drawConfig.bezier.handleLine.lineWidth));else if(t instanceof g.Polygon){if(i.polygon(t,this.drawConfig.polygon.color,this.drawConfig.polygon.lineWidth),!this.drawConfig.drawHandlePoints)for(var n in t.vertices)t.vertices[n].attr.renderTime=e}else if(t instanceof v.Triangle)i.polyline([t.a,t.b,t.c],!1,this.drawConfig.triangle.color,this.drawConfig.triangle.lineWidth),this.drawConfig.drawHandlePoints||(t.a.attr.renderTime=t.b.attr.renderTime=t.c.attr.renderTime=e);else if(t instanceof x.VEllipse)this.drawConfig.drawHandleLines&&(i.setCurrentId(t.uid+"_e0"),i.setCurrentClassName(t.className+"-v-line"),i.line(t.center.clone().add(0,t.signedRadiusV()).rotate(t.rotation,t.center),t.axis,"#c8c8c8"),i.setCurrentId(t.uid+"_e1"),i.setCurrentClassName(t.className+"-h-line"),i.line(t.center.clone().add(t.signedRadiusH(),0).rotate(t.rotation,t.center),t.axis,"#c8c8c8")),i.setCurrentId(t.uid),i.setCurrentClassName(""+t.className),i.ellipse(t.center,t.radiusH(),t.radiusV(),this.drawConfig.ellipse.color,this.drawConfig.ellipse.lineWidth,t.rotation),this.drawConfig.drawHandlePoints||(t.center.attr.renderTime=e,t.axis.attr.renderTime=e);else if(t instanceof m.VEllipseSector){i.setCurrentId(t.uid),i.setCurrentClassName(""+t.className);var o=m.VEllipseSector.ellipseSectorUtils.describeSVGArc(t.ellipse.center.x,t.ellipse.center.y,t.ellipse.radiusH(),t.ellipse.radiusV(),t.startAngle,t.endAngle,t.ellipse.rotation,{moveToStart:!0});i.path(o,this.drawConfig.ellipseSector.color,this.drawConfig.ellipseSector.lineWidth)}else t instanceof l.Circle?i.circle(t.center,t.radius,this.drawConfig.circle.color,this.drawConfig.circle.lineWidth):t instanceof c.CircleSector?i.circleArc(t.circle.center,t.circle.radius,t.startAngle,t.endAngle,this.drawConfig.circleSector.color,this.drawConfig.circleSector.lineWidth):t instanceof w.Vertex?!this.drawConfig.drawVertices||t.attr.selectable&&t.attr.draggable||!t.attr.visible||(i.circleHandle(t,7,this.drawConfig.vertex.color),t.attr.renderTime=e):t instanceof p.Line?(i.line(t.a,t.b,this.drawConfig.line.color,this.drawConfig.line.lineWidth),this.drawConfig.drawHandlePoints&&t.a.attr.selectable||(t.a.attr.renderTime=e),this.drawConfig.drawHandlePoints&&t.b.attr.selectable||(t.b.attr.renderTime=e)):t instanceof b.Vector?(i.arrow(t.a,t.b,this.drawConfig.vector.color),this.drawConfig.drawHandlePoints&&t.b.attr.selectable&&t.b.attr.visible?(i.setCurrentId(t.uid+"_h0"),i.setCurrentClassName(t.className+"-handle"),i.circleHandle(t.b,3,"#a8a8a8")):t.b.attr.renderTime=e,this.drawConfig.drawHandlePoints&&t.a.attr.selectable||(t.a.attr.renderTime=e),this.drawConfig.drawHandlePoints&&t.b.attr.selectable||(t.b.attr.renderTime=e)):t instanceof y.PBImage?(this.drawConfig.drawHandleLines&&(i.setCurrentId(t.uid+"_l0"),i.setCurrentClassName(t.className+"-line"),i.line(t.upperLeft,t.lowerRight,this.drawConfig.image.color,this.drawConfig.image.lineWidth)),s.setCurrentId(t.uid),s.image(t.image,t.upperLeft,t.lowerRight.clone().sub(t.upperLeft)),this.drawConfig.drawHandlePoints&&(i.setCurrentId(t.uid+"_h0"),i.setCurrentClassName(t.className+"-lower-right"),i.circleHandle(t.lowerRight,3,this.drawConfig.image.color),t.lowerRight.attr.renderTime=e)):console.error("Cannot draw object. Unknown class.");i.setCurrentClassName(null),i.setCurrentId(null),s.setCurrentClassName(null),s.setCurrentId(null)},t.prototype.drawSelectPolygon=function(t){null!=this.selectPolygon&&this.selectPolygon.vertices.length>0&&(t.setCurrentId(this.selectPolygon.uid),t.polygon(this.selectPolygon,"#888888"),t.crosshair(this.selectPolygon.vertices[0],3,"#008888"))},t.prototype.drawVertices=function(t,e){for(var i in this.vertices)this.drawConfig.drawVertices&&this.vertices[i].attr.renderTime!=t&&this.vertices[i].attr.visible&&(e.setCurrentId(this.vertices[i].uid),e.squareHandle(this.vertices[i],5,this._handleColor(this.vertices[i],"rgb(0,128,192)")),this.vertices[i].attr.renderTime=t)},t.prototype.redraw=function(){var t=this.renderTime++;this.draw.beginDrawCycle(t),this.fill.beginDrawCycle(t),this.config.preClear&&this.config.preClear(),this.clear(),this.config.preDraw&&this.config.preDraw(this.draw,this.fill),this.drawAll(t,this.draw,this.fill),this.config.postDraw&&this.config.postDraw(this.draw,this.fill),this.draw.endDrawCycle(t),this.fill.endDrawCycle(t)},t.prototype.drawAll=function(t,e,i){this.drawGrid(e),this.config.drawOrigin&&this.drawOrigin(e),this.drawDrawables(t,e,i),this.drawVertices(t,e),this.drawSelectPolygon(e),e.setCurrentId(void 0),e.setCurrentClassName(void 0)},t.prototype.clear=function(){this.draw.clear(this.config.backgroundColor)},t.prototype.clearSelection=function(t){for(var e in this.vertices)this.vertices[e].attr.isSelected=!1;return t&&this.redraw(),this},t.prototype.viewport=function(){return new h.Bounds(this.transformMousePosition(0,0),this.transformMousePosition(this.canvasSize.width*this.config.cssScaleX,this.canvasSize.height*this.config.cssScaleY))},t.prototype.saveFile=function(){this.hooks.saveFile(this)},t.prototype.getFProp=function(t,e){return parseFloat(globalThis.getComputedStyle(t,null).getPropertyValue(e))},t.prototype.getAvailableContainerSpace=function(){var t=this,e=t.canvas.parentNode;t.canvas.style.display="none";var i=this.getFProp(e,"padding")||0,s=this.getFProp(t.canvas,"border-width")||0,r=this.getFProp(e,"padding-left")||i,n=this.getFProp(e,"padding-right")||i,o=this.getFProp(e,"padding-top")||i,a=this.getFProp(e,"padding-bottom")||i,h=this.getFProp(t.canvas,"border-left-width")||s,l=this.getFProp(t.canvas,"border-right-width")||s,c=this.getFProp(t.canvas,"border-top-width")||s,u=this.getFProp(t.canvas,"border-bottom-width")||s,d=e.clientWidth,p=e.clientHeight;return t.canvas.style.display="block",{width:d-r-n-h-l,height:p-o-a-c-u}},t.prototype.resizeCanvas=function(){var t=this,e=this,i=function(i,s){i*=e.config.canvasWidthFactor,s*=e.config.canvasHeightFactor,e.canvasSize.width=i,e.canvasSize.height=s,e.canvas instanceof HTMLCanvasElement?(e.canvas.width=i,e.canvas.height=s):e.canvas instanceof SVGElement?(t.canvas.setAttribute("viewBox","0 0 "+i+" "+s),t.canvas.setAttribute("width",""+i),t.canvas.setAttribute("height",""+s),t.draw.setSize(e.canvasSize),t.eventCatcher.style.width=i+"px",t.eventCatcher.style.height=s+"px"):console.error("Error: cannot resize canvas element because it seems neither be a HTMLCanvasElement nor an SVGElement."),e.config.autoAdjustOffset&&e.adjustOffset(!1)};if(e.config.fullSize&&!e.config.fitToParent){var s=globalThis.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=globalThis.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;e.canvas.style.position="absolute",e.canvas.style.width=e.config.canvasWidthFactor*s+"px",e.canvas.style.height=e.config.canvasWidthFactor*r+"px",e.canvas.style.top="0px",e.canvas.style.left="0px",i(s,r)}else if(e.config.fitToParent){e.canvas.style.position="absolute";var n=this.getAvailableContainerSpace();e.canvas.style.width=e.config.canvasWidthFactor*n.width+"px",e.canvas.style.height=e.config.canvasHeightFactor*n.height+"px",e.canvas.style.top=null,e.canvas.style.left=null,i(n.width,n.height)}else e.canvas.style.width=null,e.canvas.style.height=null,i(e.config.defaultCanvasWidth,e.config.defaultCanvasHeight);e.config.redrawOnResize&&e.redraw()},t.prototype.selectVerticesInPolygon=function(t){for(var e in this.vertices)this.vertices[e].attr.selectable&&t.containsVert(this.vertices[e])&&(this.vertices[e].attr.isSelected=!0)},t.prototype.locatePointNear=function(e,i){var s=this;void 0===i&&(i=7),i/=s.draw.scale.x;for(var r=0;r<s.vertices.length;r++){var n=s.vertices[r];if((n.attr.draggable||n.attr.selectable)&&n.distance(e)<i)return new t.Draggable(n,t.Draggable.VERTEX).setVIndex(r)}return null},t.prototype.handleClick=function(e){var i=this,s=this.locatePointNear(i.transformMousePosition(e.params.pos.x,e.params.pos.y),t.DEFAULT_CLICK_TOLERANCE/Math.min(i.config.cssScaleX,i.config.cssScaleY));if(s)i.vertices[s.vindex].listeners.fireClickEvent(e),this.keyHandler&&this.keyHandler.isDown("shift")?("bpath"==s.typeName?(r=i.paths[s.pindex].bezierCurves[s.cindex].getPointByID(s.pid)).attr.selectable&&(r.attr.isSelected=!r.attr.isSelected):"vertex"==s.typeName&&(r=i.vertices[s.vindex]).attr.selectable&&(r.attr.isSelected=!r.attr.isSelected),i.redraw()):this.keyHandler.isDown("y")&&(i.vertices[s.vindex].attr.bezierAutoAdjust=!i.vertices[s.vindex].attr.bezierAutoAdjust,i.redraw());else if(null!=i.selectPolygon){var r=i.transformMousePosition(e.params.pos.x,e.params.pos.y);i.selectPolygon.vertices.push(new w.Vertex(r.x,r.y)),i.redraw()}},t.prototype.transformMousePosition=function(t,e){return{x:(t/this.config.cssScaleX-this.config.offsetX)/this.config.scaleX,y:(e/this.config.cssScaleY-this.config.offsetY)/this.config.scaleY}},t.prototype.revertMousePosition=function(t,e){return{x:t/this.config.cssScaleX+this.config.offsetX,y:e/this.config.cssScaleY+this.config.offsetY}},t.prototype.getDraggedElementCount=function(){return this.draggedElements.length},t.prototype.mouseDownHandler=function(e){var i=this;if(0==e.button){var s=i.locatePointNear(i.transformMousePosition(e.params.pos.x,e.params.pos.y),t.DEFAULT_CLICK_TOLERANCE/Math.min(i.config.cssScaleX,i.config.cssScaleY));if(s){if("vertex"==s.typeName&&i.vertices[s.vindex].attr.isSelected)for(var r=0;r<i.vertices.length;r++)i.vertices[r].attr.isSelected&&(i.draggedElements.push(new t.Draggable(i.vertices[r],t.Draggable.VERTEX).setVIndex(r)),i.vertices[r].listeners.fireDragStartEvent(e));else{if(!i.vertices[s.vindex].attr.draggable)return;i.draggedElements.push(s),"bpath"==s.typeName?i.paths[s.pindex].bezierCurves[s.cindex].getPointByID(s.pid).listeners.fireDragStartEvent(e):"vertex"==s.typeName&&i.vertices[s.vindex].listeners.fireDragStartEvent(e)}i.redraw()}}},t.prototype.mouseDragHandler=function(t){var e=this,i={x:t.params.dragAmount.x,y:t.params.dragAmount.y};if(t.params.dragAmount.x/=e.config.cssScaleX,t.params.dragAmount.y/=e.config.cssScaleY,this.keyHandler.isDown("alt")||this.keyHandler.isDown("spacebar"))e.setOffset(e.draw.offset.clone().add(t.params.dragAmount)),e.redraw();else for(var s in t.params.dragAmount.x/=e.draw.scale.x,t.params.dragAmount.y/=e.draw.scale.y,e.draggedElements){var r=e.draggedElements[s];if("bpath"==r.typeName)e.paths[r.pindex].moveCurvePoint(r.cindex,r.pid,new w.Vertex(t.params.dragAmount.x,t.params.dragAmount.y)),e.paths[r.pindex].bezierCurves[r.cindex].getPointByID(r.pid).listeners.fireDragEvent(t);else if("vertex"==r.typeName){if(!e.vertices[r.vindex].attr.draggable)continue;e.vertices[r.vindex].add(t.params.dragAmount),e.vertices[r.vindex].listeners.fireDragEvent(t)}}t.params.dragAmount.x=i.x,t.params.dragAmount.y=i.y,e.redraw()},t.prototype.mouseUpHandler=function(t){var e=this;if(0==t.button){for(var i in t.params.wasDragged||e.handleClick(t),e.draggedElements){var s=e.draggedElements[i];"bpath"==s.typeName?e.paths[s.pindex].bezierCurves[s.cindex].getPointByID(s.pid).listeners.fireDragEndEvent(t):"vertex"==s.typeName&&e.vertices[s.vindex].listeners.fireDragEndEvent(t)}e.draggedElements=[],e.redraw()}},t.prototype.mouseWheelHandler=function(t){var e=1.25,i=this,s=t;s.deltaY<0?i.setZoom(i.config.scaleX*e,i.config.scaleY*e,new w.Vertex(t.params.pos.x,t.params.pos.y)):s.deltaY>0&&i.setZoom(i.config.scaleX/e,i.config.scaleY/e,new w.Vertex(t.params.pos.x,t.params.pos.y)),t.preventDefault(),i.redraw()},t.prototype.adjustOffset=function(t){this.draw.offset.x=this.fill.offset.x=this.config.offsetX=this.canvasSize.width*(this.config.offsetAdjustXPercent/100),this.draw.offset.y=this.fill.offset.y=this.config.offsetY=this.canvasSize.height*(this.config.offsetAdjustYPercent/100),t&&this.redraw()},t.prototype.setOffset=function(t){this.draw.offset.set(t),this.fill.offset.set(t),this.config.offsetX=t.x,this.config.offsetY=t.y},t.prototype.setZoom=function(t,e,i){var s=this.transformMousePosition(i.x,i.y);this.draw.scale.x=this.fill.scale.x=this.config.scaleX=Math.max(t,.01),this.draw.scale.y=this.fill.scale.y=this.config.scaleY=Math.max(e,.01);var r=this.transformMousePosition(i.x,i.y),n=this.draw.offset.x+(r.x-s.x)*this.draw.scale.x,o=this.draw.offset.y+(r.y-s.y)*this.draw.scale.y;this.setOffset({x:n,y:o})},t.prototype.installInputListeners=function(){var e=this;if(this.config.enableMouse?new f.MouseHandler(this.eventCatcher?this.eventCatcher:this.canvas).down((function(t){e.mouseDownHandler(t)})).drag((function(t){e.mouseDragHandler(t)})).up((function(t){e.mouseUpHandler(t)})):e.console.log("Mouse interaction disabled."),this.config.enableMouseWheel?new f.MouseHandler(this.eventCatcher?this.eventCatcher:this.canvas).wheel((function(t){e.mouseWheelHandler(t)})):e.console.log("Mouse wheel interaction disabled."),this.config.enableTouch){var i=function(t){var i=e.canvas.getBoundingClientRect();return{x:t.x-i.left,y:t.y-i.top}};if("function"==typeof globalThis.AlloyFinger||"function"==typeof globalThis.createAlloyFinger)try{var r=null,n=null,o=null,a=null,h=function(){r=null,n=null,o=null,a=null,e.draggedElements=[]},l={touchStart:function(s){if(1==s.touches.length&&(r=new w.Vertex(i({x:s.touches[0].clientX,y:s.touches[0].clientY})),n=new w.Vertex(i({x:s.touches[0].clientX,y:s.touches[0].clientY})),(o=e.locatePointNear(e.transformMousePosition(r.x,r.y),t.DEFAULT_TOUCH_TOLERANCE/Math.min(e.config.cssScaleX,e.config.cssScaleY)))&&"vertex"==o.typeName)){var a=e.vertices[o.vindex],h={params:{isTouchEvent:!0,dragAmount:{x:0,y:0},wasDragged:!1,mouseDownPos:n.clone(),mouseDragPos:n.clone(),vertex:a}};e.draggedElements=[o],a.listeners.fireDragStartEvent(h)}},touchMove:function(t){if(1==t.touches.length&&o){t.preventDefault(),t.stopPropagation();var s=i({x:t.touches[0].clientX,y:t.touches[0].clientY}),a=e.transformMousePosition(s.x,s.y),h=new w.Vertex(e.transformMousePosition(r.x,r.y)).difference(a);if("vertex"==o.typeName){if(!e.vertices[o.vindex].attr.draggable)return;e.vertices[o.vindex].add(h);var l=e.vertices[o.vindex],c={isTouchEvent:!0,params:{dragAmount:h.clone(),wasDragged:!0,mouseDownPos:n.clone(),mouseDragPos:n.clone().add(h),vertex:l}};l.listeners.fireDragEvent(c),e.redraw()}r=new w.Vertex(s)}else 2==t.touches.length&&(t.preventDefault(),t.stopPropagation(),e.setOffset(e.draw.offset.clone().addXY(t.deltaX,t.deltaY)),e.redraw())},touchEnd:function(t){if(o&&"vertex"==o.typeName){var i=e.vertices[o.vindex],s={isTouchEvent:!0,params:{dragAmount:{x:0,y:0},wasDragged:!1,mouseDownPos:n.clone(),mouseDragPos:n.clone(),vertex:i}};r&&n&&n.distance(r)<.001?i.listeners.fireClickEvent(s):i.listeners.fireDragEndEvent(s)}h()},touchCancel:function(t){h()},multipointStart:function(t){a=e.draw.scale.clone()},multipointEnd:function(t){a=null},pinch:function(t){var i=new w.Vertex(t.touches.item(0).clientX,t.touches.item(0).clientY),s=new w.Vertex(t.touches.item(1).clientX,t.touches.item(1).clientY),r=new p.Line(i,s).vertAt(.5);e.setZoom(a.x*t.zoom,a.y*t.zoom,r),e.redraw()}};window.createAlloyFinger?window.createAlloyFinger(this.eventCatcher?this.eventCatcher:this.canvas,l):new s.default(this.eventCatcher?this.eventCatcher:this.canvas,l)}catch(t){console.error("Failed to initialize AlloyFinger!"),console.error(t)}else globalThis.Touchy&&"function"==typeof globalThis.Touchy?console.error("[Deprecation] Found Touchy which is not supported any more. Please use AlloyFinger instead."):console.warn("Cannot initialize the touch handler. AlloyFinger is missig. Did you include it?")}else e.console.log("Touch interaction disabled.");this.config.enableKeys?this.keyHandler=new d.KeyHandler({trackAll:!0}).down("escape",(function(){e.clearSelection(!0)})).down("shift",(function(){e.selectPolygon=new g.Polygon,e.redraw()})).up("shift",(function(){null!=e.selectPolygon&&(e.selectVerticesInPolygon(e.selectPolygon),e.selectPolygon=null,e.redraw())})):e.console.log("Keyboard interaction disabled.")},t.prototype.createGUI=function(t){if(globalThis.utils&&"function"==typeof globalThis.utils.createGUI)return globalThis.utils.createGUI(this,t);throw"Cannot create dat.GUI instance; did you load the ./utils/creategui helper function an the dat.GUI library?"},t.DEFAULT_CANVAS_WIDTH=1024,t.DEFAULT_CANVAS_HEIGHT=768,t.DEFAULT_CLICK_TOLERANCE=8,t.DEFAULT_TOUCH_TOLERANCE=32,t.Draggable=((e=function(){function e(t,e){this.item=t,this.typeName=e}return e.prototype.isVertex=function(){return this.typeName==t.Draggable.VERTEX},e.prototype.setVIndex=function(t){return this.vindex=t,this},e}()).VERTEX="vertex",e),t.utils={safeMergeByKeys:function(t,e){for(var i in e)if(e.hasOwnProperty(i))if(t.hasOwnProperty(i)){var s=typeof t[i];try{"boolean"==s?t[i]=!!JSON.parse(e[i]):"number"==s?t[i]=1*JSON.parse(e[i]):("function"==s&&e[i],t[i]=e[i])}catch(t){console.error("error in key ",i,e[i],t)}}else t[i]=e[i];return t},setCSSscale:function(t,e,i){t.style["transform-origin"]="0 0",t.style.transform=1==e&&1==i?null:"scale("+e+","+i+")"},fetch:{val:function(t,e,i){return t.hasOwnProperty(e)?void 0===t[e]?i:t[e]:i},num:function(t,e,i){if(!t.hasOwnProperty(e))return i;if("number"==typeof t[e])return t[e];try{return 1*JSON.parse(t[e])}catch(t){return i}},bool:function(t,e,i){if(!t.hasOwnProperty(e))return i;if("boolean"==typeof t[e])return t[e];try{return!!JSON.parse(t[e])}catch(t){return i}},func:function(t,e,i){return t.hasOwnProperty(e)?"function"!=typeof t[e]?i:t[e]:i}},enableBezierPathAutoAdjust:function(t){for(var e=0;e<t.bezierCurves.length;e++)t.bezierCurves[e].startPoint.listeners.addDragListener((function(e){var i=t.locateCurveByStartPoint(e.params.vertex);t.bezierCurves[i].startPoint.addXY(-e.params.dragAmount.x,-e.params.dragAmount.y),t.moveCurvePoint(1*i,t.START_POINT,e.params.dragAmount),t.updateArcLengths()})),t.bezierCurves[e].startControlPoint.listeners.addDragListener((function(e){var i=t.locateCurveByStartControlPoint(e.params.vertex);t.bezierCurves[i].startPoint.attr.bezierAutoAdjust&&(t.adjustPredecessorControlPoint(1*i,!0,!1),t.updateArcLengths())})),t.bezierCurves[e].endControlPoint.listeners.addDragListener((function(e){var i=t.locateCurveByEndControlPoint(e.params.vertex);t.bezierCurves[i%t.bezierCurves.length].endPoint.attr.bezierAutoAdjust&&(t.adjustSuccessorControlPoint(1*i,!0,!1),t.updateArcLengths())})),e+1==t.bezierCurves.length&&t.bezierCurves[t.bezierCurves.length-1].endPoint.listeners.addDragListener((function(e){if(!t.adjustCircular){var i=t.locateCurveByEndPoint(e.params.vertex);t.moveCurvePoint(1*i,t.END_CONTROL_POINT,new w.Vertex({x:e.params.dragAmount.x,y:e.params.dragAmount.y}))}t.updateArcLengths()}))}},t}();e.H4=P},661:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Polygon=void 0;var s=i(126),r=i(262),n=i(197),o=i(421),a=function(){function t(t,e){this.className="Polygon",this.uid=n.UIDGenerator.next(),void 0===t&&(t=[]),this.vertices=t,this.isOpen=e}return t.prototype.addVertex=function(t){this.vertices.push(t)},t.prototype.getVertexAt=function(t){return t<0?this.vertices[this.vertices.length-Math.abs(t)%this.vertices.length]:this.vertices[t%this.vertices.length]},t.prototype.move=function(t){for(var e in this.vertices)this.vertices[e].add(t);return this},t.prototype.containsVert=function(t){for(var e=!1,i=0,s=this.vertices.length-1;i<this.vertices.length;s=i++){var r=this.vertices[i].x,n=this.vertices[i].y,o=this.vertices[s].x,a=this.vertices[s].y;n>t.y!=a>t.y&&t.x<(o-r)*(t.y-n)/(a-n)+r&&(e=!e)}return e},t.prototype.area=function(){return t.utils.area(this.vertices)},t.prototype.signedArea=function(){return t.utils.signedArea(this.vertices)},t.prototype.isClockwise=function(){return t.utils.signedArea(this.vertices)<0},t.prototype.scale=function(t,e){for(var i in this.vertices)"function"==typeof this.vertices[i].scale?this.vertices[i].scale(t,e):console.log("There seems to be a null vertex!",this.vertices[i]);return this},t.prototype.rotate=function(t,e){for(var i in this.vertices)this.vertices[i].rotate(t,e);return this},t.prototype.getBounds=function(){return r.Bounds.computeFromVertices(this.vertices)},t.prototype.toQuadraticBezierData=function(){if(this.vertices.length<3)return[];var t=[],e=this.vertices[0],i=this.vertices[1],s=new o.Vertex(e.x+(i.x-e.x)/2,e.y+(i.y-e.y)/2);t.push(s);for(var r=this.isOpen?this.vertices.length:this.vertices.length+1,n=1;n<r;n++)e=this.vertices[n%this.vertices.length],i=this.vertices[(n+1)%this.vertices.length],s=new o.Vertex(e.x+(i.x-e.x)/2,e.y+(i.y-e.y)/2),t.push(e),t.push(s),e=i;return t},t.prototype.toQuadraticBezierSVGString=function(){var t=this.toQuadraticBezierData();if(0==t.length)return"";for(var e=["M "+t[0].x+" "+t[0].y],i=1;i<t.length;i+=2)e.push("Q "+t[i].x+" "+t[i].y+", "+t[i+1].x+" "+t[i+1].y);return e.join(" ")},t.prototype.toCubicBezierData=function(t){if(void 0===t&&(t=1),this.vertices.length<3)return[];var e=[],i=this.vertices[0],s=this.vertices[1],r=new o.Vertex(i.x+(s.x-i.x)/2,i.y+(s.y-i.y)/2);e.push(r);for(var n=this.isOpen?this.vertices.length-1:this.vertices.length,a=0;a<n;a++){i=this.vertices[a%this.vertices.length],s=this.vertices[(a+1)%this.vertices.length];var h=this.vertices[(a+2)%this.vertices.length],l=new o.Vertex(i.x+(s.x-i.x)/2,i.y+(s.y-i.y)/2),c=new o.Vertex(s.x+(h.x-s.x)/2,s.y+(h.y-s.y)/2),u=new o.Vertex(l.x+(s.x-l.x)*t,l.y+(s.y-l.y)*t),d=new o.Vertex(c.x+(s.x-c.x)*t,c.y+(s.y-c.y)*t);e.push(u),e.push(d),e.push(c)}return e},t.prototype.toCubicBezierSVGString=function(t){var e=this.toCubicBezierData(t);if(0==e.length)return"";for(var i=["M "+e[0].x+" "+e[0].y],s=1;s<e.length;s+=3)i.push("C "+e[s].x+" "+e[s].y+", "+e[s+1].x+" "+e[s+1].y+", "+e[s+2].x+" "+e[s+2].y);return i.join(" ")},t.prototype.toCubicBezierPath=function(t){for(var e=this.toCubicBezierData(t),i=[],r=0;r+3<e.length;r+=3)i.push([e[r],e[r+3],e[r+1],e[r+2]]);return s.BezierPath.fromArray(i)},t.prototype.toSVGString=function(t){t=t||{};var e=[];if(e.push("<path"),t.className&&e.push(' class="'+t.className+'"'),e.push(' d="'),this.vertices.length>0){e.push("M "),e.push(this.vertices[0].x.toString()),e.push(" "),e.push(this.vertices[0].y.toString());for(var i=1;i<this.vertices.length;i++)e.push(" L "),e.push(this.vertices[i].x.toString()),e.push(" "),e.push(this.vertices[i].y.toString());this.isOpen||e.push(" Z")}return e.push('" />'),e.join("")},t.utils={area:function(t){for(var e=0,i=0,s=t.length;i<s;i++)e+=t[i].x*t[(i+1)%s].y*.5,e-=t[(i+1)%s].x*t[i].y*.5;return Math.abs(e)},signedArea:function(t){for(var e=0,i=t.length,s=0;s<i;s++){var r=(s+1)%i;e+=(t[r].x-t[s].x)*(t[s].y+t[r].y)}return e}},t}();e.Polygon=a},212:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Triangle=void 0;var s=i(262),r=i(913),n=i(831),o=i(661),a=i(197),h=i(421),l=i(22),c=function(){function t(t,e,i){this.className="Triangle",this.uid=a.UIDGenerator.next(),this.a=t,this.b=e,this.c=i,this.calcCircumcircle()}return t.fromArray=function(e){if(e.length<3)throw"Cannot create triangle from array with less than three vertices ("+e.length+")";return new t(e[0],e[1],e[2])},t.prototype.getArea=function(){return Math.abs(t.utils.signedArea(this.a.x,this.a.y,this.b.x,this.b.y,this.c.x,this.c.y))},t.prototype.getCentroid=function(){return new h.Vertex((this.a.x+this.b.x+this.c.x)/3,(this.a.y+this.b.y+this.c.y)/3)},t.prototype.scaleToCentroid=function(t){var e=this.getCentroid();return this.a.scale(t,e),this.b.scale(t,e),this.c.scale(t,e),this},t.prototype.getCircumcircle=function(){return this.calcCircumcircle(),new r.Circle(this.center.clone(),this.radius)},t.prototype.isAdjacent=function(t){var e=this.a.equals(t.a)||this.a.equals(t.b)||this.a.equals(t.c),i=this.b.equals(t.a)||this.b.equals(t.b)||this.b.equals(t.c),s=this.c.equals(t.a)||this.c.equals(t.b)||this.c.equals(t.c);return e&&i||e&&s||i&&s},t.prototype.getThirdVertex=function(t,e){return this.a.equals(t)&&this.b.equals(e)||this.a.equals(e)&&this.b.equals(t)?this.c:this.b.equals(t)&&this.c.equals(e)||this.b.equals(e)&&this.c.equals(t)?this.a:this.b},t.prototype.calcCircumcircle=function(){var e,i,s=this.b.x-this.a.x,r=this.b.y-this.a.y,n=this.c.x-this.a.x,o=this.c.y-this.a.y,a=s*(this.a.x+this.b.x)+r*(this.a.y+this.b.y),l=n*(this.a.x+this.c.x)+o*(this.a.y+this.c.y),c=2*(s*(this.c.y-this.b.y)-r*(this.c.x-this.b.x));if(Math.abs(c)<t.EPSILON){var u=this.bounds();this.center=new h.Vertex((u.min.x+u.max.x)/2,(u.min.y+u.max.y)/2),e=this.center.x-u.min.x,i=this.center.y-u.min.y}else{var d=(o*a-r*l)/c,p=(s*l-n*a)/c;this.center=new h.Vertex(d,p),e=this.center.x-this.a.x,i=this.center.y-this.a.y}this.radius_squared=e*e+i*i,this.radius=Math.sqrt(this.radius_squared)},t.prototype.inCircumcircle=function(t){var e=this.center.x-t.x,i=this.center.y-t.y;return e*e+i*i<=this.radius_squared},t.prototype.bounds=function(){return new s.Bounds(new h.Vertex(t.utils.min3(this.a.x,this.b.x,this.c.x),t.utils.min3(this.a.y,this.b.y,this.c.y)),new h.Vertex(t.utils.max3(this.a.x,this.b.x,this.c.x),t.utils.max3(this.a.y,this.b.y,this.c.y)))},t.prototype.toPolygon=function(){return new o.Polygon([this.a,this.b,this.c])},t.prototype.determinant=function(){return(this.b.y-this.a.y)*(this.c.x-this.b.x)-(this.c.y-this.b.y)*(this.b.x-this.a.x)},t.prototype.containsPoint=function(e){return t.utils.pointIsInTriangle(e.x,e.y,this.a.x,this.a.y,this.b.x,this.b.y,this.c.x,this.c.y)},t.prototype.getIncircularTriangle=function(){var e=new n.Line(this.a,this.b),i=new n.Line(this.b,this.c),s=new n.Line(this.c,this.a),r=l.geomutils.nsectAngle(this.b,this.a,this.c,2)[0],o=l.geomutils.nsectAngle(this.c,this.b,this.a,2)[0],a=r.intersection(o);return new t(e.getClosestPoint(a),i.getClosestPoint(a),s.getClosestPoint(a))},t.prototype.getIncircle=function(){return this.getIncircularTriangle().getCircumcircle()},t.prototype.getIncenter=function(){return this.center&&this.radius||this.calcCircumcircle(),this.center.clone()},t.prototype.toString=function(){return"{ a : "+this.a.toString()+", b : "+this.b.toString()+", c : "+this.c.toString()+"}"},t.prototype.toSVGString=function(t){t=t||{};var e=[];e.push("<path"),t.className&&e.push(' class="'+t.className+'"'),e.push(' d="');var i=[this.a,this.b,this.c];if(i.length>0){e.push("M "),e.push(i[0].x),e.push(" "),e.push(i[0].y);for(var s=1;s<i.length;s++)e.push(" L "),e.push(i[s].x),e.push(" "),e.push(i[s].y);e.push(" Z")}return e.push('" />'),e.join("")},t.EPSILON=1e-6,t.utils={max3:function(t,e,i){return t>=e&&t>=i?t:e>=t&&e>=i?e:i},min3:function(t,e,i){return t<=e&&t<=i?t:e<=t&&e<=i?e:i},signedArea:function(t,e,i,s,r,n){return.5*(-s*r+e*(-i+r)+t*(s-n)+i*n)},pointIsInTriangle:function(e,i,s,r,n,o,a,h){var l=t.utils.signedArea(s,r,n,o,a,h),c=1/(2*l)*(r*a-s*h+(h-r)*e+(s-a)*i),u=1/(2*l)*(s*o-r*n+(r-o)*e+(n-s)*i);return c>0&&u>0&&1-c-u>0}},t}();e.Triangle=c},197:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UIDGenerator=void 0;var i=function(){function t(){}return t.next=function(){return""+t.current++},t.current=0,t}();e.UIDGenerator=i},112:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VEllipse=void 0;var s=i(831),r=i(73),n=i(421),o=i(197),a=i(510),h=function(){function t(t,e,i){this.className="VEllipse",this.uid=o.UIDGenerator.next(),this.center=t,this.axis=e,this.rotation=i||0}return t.prototype.clone=function(){return new t(this.center.clone(),this.axis.clone(),this.rotation)},t.prototype.radiusH=function(){return Math.abs(this.signedRadiusH())},t.prototype.signedRadiusH=function(){return new n.Vertex(this.axis).rotate(-this.rotation,this.center).x-this.center.x},t.prototype.radiusV=function(){return Math.abs(this.signedRadiusV())},t.prototype.signedRadiusV=function(){return new n.Vertex(this.axis).rotate(-this.rotation,this.center).y-this.center.y},t.prototype.scale=function(t){return this.axis.scale(t,this.center),this},t.prototype.rotate=function(t){return this.axis.rotate(t,this.center),this.rotation+=t,this},t.prototype.vertAt=function(e){var i=this.radiusH(),s=this.radiusV();return new n.Vertex(t.utils.polarToCartesian(this.center.x,this.center.y,i,s,e)).rotate(this.rotation,this.center)},t.prototype.normalAt=function(t,e){var i=this.vertAt(t),n=this.getFoci(),o=new s.Line(i,n[0]).angle(),a=o+(new s.Line(i,n[1]).angle()-o)/2,h=i.clone().addX(50).clone().rotate(a,i),l=i.clone().addX(50).clone().rotate(Math.PI+a,i);return this.center.distance(h)<this.center.distance(l)?new r.Vector(i,l):new r.Vector(i,h)},t.prototype.tangentAt=function(t,e){var i=this.normalAt(t,e);return i.b.rotate(Math.PI/2,i.a),i},t.prototype.perimeter=function(){var t=this.radiusH(),e=this.radiusV();return Math.PI*(3*(t+e)-Math.sqrt((3*t+e)*(t+3*e)))},t.prototype.getFoci=function(){var t=this.radiusH(),e=this.radiusV(),i=t*t-e*e,s=Math.sqrt(Math.abs(i));return i<0?[this.center.clone().addY(s).rotate(this.rotation,this.center),this.center.clone().addY(-s).rotate(this.rotation,this.center)]:[this.center.clone().addX(s).rotate(this.rotation,this.center),this.center.clone().addX(-s).rotate(this.rotation,this.center)]},t.prototype.getEquidistantVertices=function(e){for(var i=t.utils.equidistantVertAngles(this.radiusH(),this.radiusV(),e),s=[],r=0;r<i.length;r++)s.push(this.vertAt(i[r]));return s},t.prototype.toCubicBezier=function(e,i){var s=4*Math.max(1,e||3);i=void 0===i?.666666:i;for(var r=this.radiusH(),n=this.radiusV(),o=[],h=t.utils.equidistantVertAngles(r,n,s),l=h[0],c=this.vertAt(l),u=0;u<h.length;u++){var d=h[(u+1)%h.length],p=this.vertAt(d);if(Math.abs(n)<1e-4||Math.abs(r)<1e-4){var f=c.difference(p),y=new a.CubicBezierCurve(c.clone(),p.clone(),c.clone().addXY(.333*f.x,.333*f.y),p.clone().addXY(.333*-f.x,.333*-f.y));o.push(y)}else{var g=this.tangentAt(l),v=this.tangentAt(d),x=g.intersection(v),m=c.difference(x),b=p.difference(x);y=new a.CubicBezierCurve(c.clone(),p.clone(),c.clone().add(m.scale(i)),p.clone().add(b.scale(i))),o.push(y)}c=p,l=d}return o},t.prototype.toSVGString=function(t){t=t||{};var e=[];return e.push("<ellipse"),t.className&&e.push(' class="'+t.className+'"'),e.push(' cx="'+this.center.x+'"'),e.push(' cy="'+this.center.y+'"'),e.push(' rx="'+this.axis.x+'"'),e.push(' ry="'+this.axis.y+'"'),e.push(" />"),e.join("")},t.utils={polarToCartesian:function(t,e,i,s,r){var n=Math.sin(Math.PI/2-r),o=Math.cos(Math.PI/2-r);return{x:t+i*s*n/Math.sqrt(Math.pow(i*o,2)+Math.pow(s*n,2)),y:e+i*s*o/Math.sqrt(Math.pow(i*o,2)+Math.pow(s*n,2))}},phiToTheta:function(t,e,i){var s=Math.tan(i),r=s*s;return-Math.PI/2+i+Math.atan((t-e)*s/(e+t*r))},equidistantVertAngles:function(e,i,s){for(var r=[],n=0;n<s;n++){var o=Math.PI/2+2*Math.PI/s*n,a=t.utils.phiToTheta(e,i,o);r[n]=a}return r}},t}();e.VEllipse=h},965:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VEllipseSector=void 0;var s=i(510),r=i(22),n=i(831),o=i(197),a=i(112),h=i(421),l=function(){function t(t,e,i){this.className="VEllipseSector",this.uid=o.UIDGenerator.next(),this.ellipse=t,this.startAngle=r.geomutils.wrapMinMax(e,0,2*Math.PI),this.endAngle=r.geomutils.wrapMinMax(i,0,2*Math.PI)}return t.prototype.toCubicBezier=function(e,i){var r=4*Math.max(1,e||3);i=void 0===i?.666666:i;for(var n=this.ellipse.radiusH(),o=this.ellipse.radiusV(),a=t.ellipseSectorUtils.normalizeAngle(this.startAngle),h=t.ellipseSectorUtils.normalizeAngle(this.endAngle),l=t.ellipseSectorUtils.equidistantVertAngles(n,o,a,h,r),c=[],u=(l=[a].concat(l).concat([h]))[0],d=this.ellipse.vertAt(u),p=0;p+1<l.length;p++){var f=l[(p+1)%l.length],y=this.ellipse.vertAt(f),g=this.ellipse.tangentAt(u),v=this.ellipse.tangentAt(f);if(Math.abs(o)<1e-4||Math.abs(n)<1e-4){var x=d.difference(y),m=new s.CubicBezierCurve(d.clone(),y.clone(),d.clone().addXY(.333*x.x,.333*x.y),y.clone().addXY(.333*-x.x,.333*-x.y));c.push(m)}else{var b=g.intersection(v),w=d.difference(b),C=y.difference(b);m=new s.CubicBezierCurve(d.clone(),y.clone(),d.clone().add(w.scale(i)),y.clone().add(C.scale(i))),c.push(m)}d=y,u=f}return c},t.ellipseSectorUtils={describeSVGArc:function(t,e,i,s,n,o,l,c){void 0===c&&(c={moveToStart:!0}),void 0===l&&(l=0),n=r.geomutils.wrapMax(n,2*Math.PI),o=r.geomutils.wrapMax(o,2*Math.PI);var u=new h.Vertex(a.VEllipse.utils.polarToCartesian(t,e,i,s,o)),d=new h.Vertex(a.VEllipse.utils.polarToCartesian(t,e,i,s,n));u.rotate(l,{x:t,y:e}),d.rotate(l,{x:t,y:e});var p,f=o-n;p=f<0?Math.abs(f)<Math.PI?1:0:Math.abs(f)>Math.PI?1:0;var y=[];c.moveToStart&&y.push("M",d.x,d.y);var g=180/Math.PI;return y.push("A",i,s,l*g,p,1,u.x,u.y),y},equidistantVertAngles:function(e,i,s,r,n){for(var o=(o=(o=a.VEllipse.utils.equidistantVertAngles(e,i,n)).map((function(e){return t.ellipseSectorUtils.normalizeAngle(e)}))).filter((function(t){return s<r?t>=s&&t<=r:t>=s||t<=r&&t>=0})),h=t.ellipseSectorUtils.findClosestToStartAngle(s,r,o),l=[],c=0;c<o.length;c++)l.push(o[(h+c)%o.length]);return l},findClosestToStartAngle:function(t,e,i){if(t>e)for(var s=i.length,n=0;n<s;n++){var o=r.geomutils.wrapMinMax(i[n],0,2*Math.PI);if(o>=t&&o>=e)return n}return 0},normalizeAngle:function(t){return t<0?2*Math.PI+t:t},endpointToCenterParameters:function(e,i,s,r,o,l,c,u,d){var p=Math.abs,f=Math.sin,y=Math.cos,g=Math.sqrt,v=function(t){return t*t},x=f(o),m=y(o),b=m*(e-u)/2+x*(i-d)/2,w=-x*(e-u)/2+m*(i-d)/2,C=v(b),P=v(w),T=v(s),S=v(r),A=C/T+P/S;A>1?(s=g(A)*p(s),r=g(A)*p(r)):(s=p(s),r=p(r));var _=l===c?-1:1,N=g((T*S-T*P-S*C)/(T*P+S*C))*_,M=N*(s*w)/r,z=N*(-r*b)/s,L=m*M-x*z+(e+u)/2,E=x*M+m*z+(i+d)/2,V=new h.Vertex(L,E),D=V.clone().addXY(s,r),I=new a.VEllipse(V,D,0);return I.rotate(o),new t(I,new n.Line(I.center,new h.Vertex(e,i)).angle()-o,new n.Line(I.center,new h.Vertex(u,d)).angle()-o)}},t}();e.VEllipseSector=l},73:function(t,e,i){var s,r=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.Vector=void 0;var n=i(72),o=i(421),a=function(t){function e(i,s){var r=t.call(this,i,s,(function(t,i){return new e(t,i)}))||this;return r.className="Vector",r}return r(e,t),e.prototype.perp=function(){var t=this.clone();return t.sub(this.a),(t=new e(new o.Vertex,new o.Vertex(-t.b.y,t.b.x))).a.add(this.a),t.b.add(this.a),t},e.prototype.inverse=function(){var t=this.a;return this.a=this.b,this.b=t,this},e.prototype.inv=function(){return this.b.x=this.a.x-(this.b.x-this.a.x),this.b.y=this.a.y-(this.b.y-this.a.y),this},e.prototype.intersection=function(t){var e=this.denominator(t);if(0==e)return null;var i=this.a.y-t.a.y,s=this.a.x-t.a.x,r=(t.b.x-t.a.x)*i-(t.b.y-t.a.y)*s,n=(this.b.x-this.a.x)*i-(this.b.y-this.a.y)*s;return i=r/e,s=n/e,new o.Vertex(this.a.x+i*(this.b.x-this.a.x),this.a.y+i*(this.b.y-this.a.y))},e.prototype.toSVGString=function(t){t=t||{};var i=[],s=e.utils.buildArrowHead(this.a,this.b,8,1,1);i.push("<g"),t.className&&i.push(' class="'+t.className+'"'),i.push(">"),i.push("   <line"),i.push(' x1="'+this.a.x+'"'),i.push(' y1="'+this.a.y+'"'),i.push(' x2="'+s[0].x+'"'),i.push(' y2="'+s[0].y+'"'),i.push(" />"),i.push('   <polygon points="');for(var r=0;r<s.length;r++)r>0&&i.push(" "),i.push(s[r].x+","+s[r].y);return i.push('"/>'),i.push("</g>"),i.join("")},e.utils={buildArrowHead:function(t,e,i,s,r){var n=Math.atan2((e.y-t.y)*r,(e.x-t.x)*s),a=[];return a.push(new o.Vertex(e.x*s-i*Math.cos(n),e.y*r-i*Math.sin(n))),a.push(new o.Vertex(e.x*s-1.35*i*Math.cos(n-Math.PI/8),e.y*r-1.35*i*Math.sin(n-Math.PI/8))),a.push(new o.Vertex(e.x*s,e.y*r)),a.push(new o.Vertex(e.x*s-1.35*i*Math.cos(n+Math.PI/8),e.y*r-1.35*i*Math.sin(n+Math.PI/8))),a}},e}(n.VertTuple);e.Vector=a},72:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VertTuple=void 0;var s=i(421),r=i(197),n=function(){function t(t,e,i){this.uid=r.UIDGenerator.next(),this.a=t,this.b=e,this.factory=i}return t.prototype.length=function(){return Math.sqrt(Math.pow(this.b.x-this.a.x,2)+Math.pow(this.b.y-this.a.y,2))},t.prototype.setLength=function(t){return this.scale(t/this.length())},t.prototype.sub=function(t){return this.a.sub(t),this.b.sub(t),this},t.prototype.add=function(t){return this.a.add(t),this.b.add(t),this},t.prototype.normalize=function(){return this.b.set(this.a.x+(this.b.x-this.a.x)/this.length(),this.a.y+(this.b.y-this.a.y)/this.length()),this},t.prototype.scale=function(t){return this.b.set(this.a.x+(this.b.x-this.a.x)*t,this.a.y+(this.b.y-this.a.y)*t),this},t.prototype.moveTo=function(t){var e=this.a.difference(t);return this.a.add(e),this.b.add(e),this},t.prototype.angle=function(t){null!=t&&void 0!==t||(t=this.factory(new s.Vertex(0,0),new s.Vertex(100,0)));var e=this.b.clone().sub(this.a),i=t.b.clone().sub(t.a);return Math.atan2(i.x,i.y)-Math.atan2(e.x,e.y)},t.prototype.vertAt=function(t){return new s.Vertex(this.a.x+(this.b.x-this.a.x)*t,this.a.y+(this.b.y-this.a.y)*t)},t.prototype.denominator=function(t){return(t.b.y-t.a.y)*(this.b.x-this.a.x)-(t.b.x-t.a.x)*(this.b.y-this.a.y)},t.prototype.colinear=function(t){return Math.abs(this.denominator(t))<s.Vertex.EPSILON},t.prototype.getClosestT=function(e){var i=t.vtutils.dist2(this.a,this.b);return 0===i?0:((e.x-this.a.x)*(this.b.x-this.a.x)+(e.y-this.a.y)*(this.b.y-this.a.y))/i},t.prototype.hasPoint=function(e,i){var r=this.getClosestT(e);return void 0!==i&&i?Math.sqrt(t.vtutils.dist2(e,this.vertAt(r)))<s.Vertex.EPSILON&&r>=0&&r<=1:r>=0&&r<=1},t.prototype.getClosestPoint=function(t){var e=this.getClosestT(t);return this.vertAt(e)},t.prototype.pointDistance=function(e){return Math.sqrt(t.vtutils.dist2(e,this.vertAt(this.getClosestT(e))))},t.prototype.clone=function(){return this.factory(this.a.clone(),this.b.clone())},t.prototype.toString=function(){return"{ a : "+this.a.toString()+", b : "+this.b.toString()+" }"},t.vtutils={dist2:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)}},t}();e.VertTuple=n},421:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Vertex=void 0;var s=i(861),r=i(197),n=i(76),o=function(){function t(t,e){if(this.className="Vertex",this.uid=r.UIDGenerator.next(),void 0===t)this.x=0,this.y=0;else if("number"==typeof t&&"number"==typeof e)this.x=t,this.y=e;else{var i=t;"number"==typeof i.x&&"number"==typeof i.y?(this.x=i.x,this.y=i.y):(this.x="number"==typeof t?t:void 0===t?0:NaN,this.y="number"==typeof e?e:void 0===e?0:NaN)}this.attr=new s.VertexAttr,this.listeners=new n.VertexListeners(this)}return t.prototype.set=function(t,e){if("number"==typeof t&&"number"==typeof e)this.x=t,this.y=e;else{var i=t;"number"==typeof i.x&&"number"==typeof i.y?(this.x=i.x,this.y=i.y):(this.x="number"==typeof t?t:void 0===t?0:NaN,this.y="number"==typeof e?e:void 0===e?0:NaN)}return this},t.prototype.setX=function(t){return this.x=t,this},t.prototype.setY=function(t){return this.y=t,this},t.prototype.invX=function(){return this.x=-this.x,this},t.prototype.invY=function(){return this.y=-this.y,this},t.prototype.add=function(t,e){if("number"==typeof t&&"number"==typeof e)this.x+=t,this.y+=e;else{var i=t;if("number"==typeof i.x&&"number"==typeof i.y)this.x+=i.x,this.y+=i.y;else{if("number"!=typeof t)throw"Cannot add "+typeof t+" to numeric x component!";if(this.x+=t,"number"!=typeof e)throw"Cannot add "+typeof e+" to numeric y component!";this.y+=e}}return this},t.prototype.addXY=function(t,e){return this.x+=t,this.y+=e,this},t.prototype.addX=function(t){return this.x+=t,this},t.prototype.addY=function(t){return this.y+=t,this},t.prototype.sub=function(t,e){if("number"==typeof t&&"number"==typeof e)this.x-=t,this.y-=e;else{var i=t;if("number"==typeof i.x&&"number"==typeof i.y)this.x-=i.x,this.y-=i.y;else{if("number"!=typeof t)throw"Cannot add "+typeof t+" to numeric x component!";if(this.x-=t,"number"!=typeof e)throw"Cannot add "+typeof e+" to numeric y component!";this.y-=e}}return this},t.prototype.equals=function(e){var i=Math.abs(this.x-e.x)<t.EPSILON,s=Math.abs(this.y-e.y)<t.EPSILON;return i&&s},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.distance=function(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))},t.prototype.angle=function(t){var e=void 0===t?Math.PI/2-Math.atan2(this.x,this.y):Math.PI/2-Math.atan2(t.x-this.x,t.y-this.y);return e<0?2*Math.PI+e:e},t.prototype.difference=function(e){return new t(e.x-this.x,e.y-this.y)},t.prototype.scale=function(e,i){return i&&void 0!==i||(i=new t(0,0)),this.x=i.x+(this.x-i.x)*e,this.y=i.y+(this.y-i.y)*e,this},t.prototype.rotate=function(e,i){i&&void 0!==i||(i={x:0,y:0}),this.sub(i),e+=Math.atan2(this.y,this.x);var s=this.distance(t.ZERO);return this.x=s*Math.cos(e),this.y=s*Math.sin(e),this.add(i),this},t.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.prototype.inv=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.prototype.toSVGString=function(t){t=t||{};var e=[];return e.push("<circle"),t.className&&e.push(' class="'+t.className+'"'),e.push(' cx="'+this.x+'"'),e.push(' cy="'+this.y+'"'),e.push(' r="2"'),e.push(" />"),e.join("")},t.randomVertex=function(e){return new t(e.min.x+Math.random()*(e.max.x-e.min.x),e.min.y+Math.random()*(e.max.y-e.min.y))},t.ZERO=new t(0,0),t.EPSILON=1e-6,t.utils={buildArrowHead:function(e,i,s,r,n){var o=Math.atan2((i.y-e.y)*n,(i.x-e.x)*r),a=[];return a.push(new t(i.x*r-s*Math.cos(o),i.y*n-s*Math.sin(o))),a.push(new t(i.x*r-1.35*s*Math.cos(o-Math.PI/8),i.y*n-1.35*s*Math.sin(o-Math.PI/8))),a.push(new t(i.x*r,i.y*n)),a.push(new t(i.x*r-1.35*s*Math.cos(o+Math.PI/8),i.y*n-1.35*s*Math.sin(o+Math.PI/8))),a}},t}();e.Vertex=o},861:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VertexAttr=void 0;var i=function(){function t(){for(var e in this.draggable=!0,this.selectable=!0,this.isSelected=!1,this.visible=!0,t.model)this[e]=t.model[e]}return t.model={draggable:!0,selectable:!0,isSelected:!1,visible:!0},t}();e.VertexAttr=i},76:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VertexListeners=void 0;var i=function(){function t(t){this.click=[],this.drag=[],this.dragStart=[],this.dragEnd=[],this.vertex=t}return t.prototype.addClickListener=function(e){return t._addListener(this.click,e),this},t.prototype.removeClickListener=function(e){return this.click=t._removeListener(this.click,e),this},t.prototype.addDragListener=function(e){return t._addListener(this.drag,e),this},t.prototype.removeDragListener=function(e){return this.drag=t._removeListener(this.drag,e),this},t.prototype.addDragStartListener=function(e){return t._addListener(this.dragStart,e),this},t.prototype.removeDragStartListener=function(e){return this.dragStart=t._removeListener(this.dragStart,e),this},t.prototype.addDragEndListener=function(e){return t._addListener(this.dragEnd,e),this},t.prototype.removeDragEndListener=function(e){return this.dragEnd=t._removeListener(this.dragEnd,e),this},t.prototype.fireClickEvent=function(e){t._fireEvent(this,this.click,e)},t.prototype.fireDragEvent=function(e){t._fireEvent(this,this.drag,e)},t.prototype.fireDragStartEvent=function(e){t._fireEvent(this,this.dragStart,e)},t.prototype.fireDragEndEvent=function(e){t._fireEvent(this,this.dragEnd,e)},t._fireEvent=function(t,e,i){var s=i;for(var r in void 0===s.params?s.params={vertex:t.vertex}:s.params.vertex=t.vertex,e)e[r](s)},t._addListener=function(t,e){for(var i in t)if(t[i]==e)return!1;return t.push(e),!0},t._removeListener=function(t,e){for(var i=0;i<t.length;i++)if(t[i]==e)return t.splice(i,1);return t},t}();e.VertexListeners=i},149:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.drawutils=void 0;var s=i(510),r=i(421),n=i(829),o=function(){function t(t,e){this.ctx=t,this.offset=new r.Vertex(0,0),this.scale=new r.Vertex(1,1),this.fillShapes=e}return t.prototype.beginDrawCycle=function(t){},t.prototype.endDrawCycle=function(t){},t.prototype.setConfiguration=function(t){this.ctx.globalCompositeOperation=t.blendMode},t.prototype.setCurrentId=function(t){},t.prototype.setCurrentClassName=function(t){},t.prototype.line=function(t,e,i,s){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+e.x*this.scale.x,this.offset.y+e.y*this.scale.y),this.ctx.strokeStyle=i,this.ctx.lineWidth=s||1,this.ctx.stroke(),this.ctx.restore()},t.prototype.arrow=function(t,e,i,s){this.ctx.save(),this.ctx.beginPath();var n=r.Vertex.utils.buildArrowHead(t,e,8,this.scale.x,this.scale.y);this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y);for(var o=0;o<n.length;o++)this.ctx.lineTo(this.offset.x+n[o].x,this.offset.y+n[o].y);this.ctx.lineTo(this.offset.x+n[0].x,this.offset.y+n[0].y),this.ctx.lineWidth=s||1,this._fillOrDraw(i),this.ctx.restore()},t.prototype.image=function(t,e,i){t.complete&&t.naturalWidth&&(this.ctx.save(),this.ctx.drawImage(t,0,0,t.naturalWidth-1,t.naturalHeight-1,this.offset.x+e.x*this.scale.x,this.offset.y+e.y*this.scale.y,i.x*this.scale.x,i.y*this.scale.y),this.ctx.restore())},t.prototype.rect=function(t,e,i,s,r){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x+e)*this.scale.x,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x+e)*this.scale.x,this.offset.y+(t.y+i)*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+(t.y+i)*this.scale.y),this.ctx.closePath(),this.ctx.lineWidth=r||1,this._fillOrDraw(s),this.ctx.restore()},t.prototype._fillOrDraw=function(t){this.fillShapes?(this.ctx.fillStyle=t,this.ctx.fill()):(this.ctx.strokeStyle=t,this.ctx.stroke())},t.prototype.cubicBezier=function(t,e,i,r,n,o){t instanceof s.CubicBezierCurve?this.cubicBezier(t.startPoint,t.endPoint,t.startControlPoint,t.endControlPoint,n,o):(this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y),this.ctx.bezierCurveTo(this.offset.x+i.x*this.scale.x,this.offset.y+i.y*this.scale.y,this.offset.x+r.x*this.scale.x,this.offset.y+r.y*this.scale.y,this.offset.x+e.x*this.scale.x,this.offset.y+e.y*this.scale.y),this.ctx.lineWidth=o||2,this._fillOrDraw(n),this.ctx.restore())},t.prototype.quadraticBezier=function(t,e,i,s,r){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y),this.ctx.quadraticCurveTo(this.offset.x+e.x*this.scale.x,this.offset.y+e.y*this.scale.y,this.offset.x+i.x*this.scale.x,this.offset.y+i.y*this.scale.y),this.ctx.lineWidth=r||2,this._fillOrDraw(s),this.ctx.restore()},t.prototype.cubicBezierPath=function(t,e,i){if(t&&0!=t.length){var s,r,n;this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t[0].x*this.scale.x,this.offset.y+t[0].y*this.scale.y);for(var o=1;o<t.length;o+=3)r=t[o],n=t[o+1],s=t[o+2],this.ctx.bezierCurveTo(this.offset.x+r.x*this.scale.x,this.offset.y+r.y*this.scale.y,this.offset.x+n.x*this.scale.x,this.offset.y+n.y*this.scale.y,this.offset.x+s.x*this.scale.x,this.offset.y+s.y*this.scale.y);this.ctx.closePath(),this.ctx.lineWidth=i||1,this._fillOrDraw(e),this.ctx.restore()}},t.prototype.handle=function(t,e){this.point(t,"rgb(0,32,192)"),this.square(e,5,"rgba(0,128,192,0.5)")},t.prototype.handleLine=function(t,e){this.line(t,e,"rgb(192,192,192)")},t.prototype.dot=function(t,e){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(Math.round(this.offset.x+this.scale.x*t.x),Math.round(this.offset.y+this.scale.y*t.y)),this.ctx.lineTo(Math.round(this.offset.x+this.scale.x*t.x+1),Math.round(this.offset.y+this.scale.y*t.y+1)),this.ctx.closePath(),this.ctx.lineWidth=1,this._fillOrDraw(e),this.ctx.restore()},t.prototype.point=function(t,e){this.ctx.beginPath(),this.ctx.arc(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,3,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.lineWidth=1,this._fillOrDraw(e)},t.prototype.circle=function(t,e,i,s){this.ctx.beginPath(),this.ctx.ellipse(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,e*this.scale.x,e*this.scale.y,0,0,2*Math.PI),this.ctx.closePath(),this.ctx.lineWidth=s||1,this._fillOrDraw(i)},t.prototype.circleArc=function(t,e,i,s,r,n,o){o&&o.asSegment||this.ctx.beginPath(),this.ctx.ellipse(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,e*this.scale.x,e*this.scale.y,0,i,s,!1),o&&o.asSegment||(this.ctx.lineWidth=n||1,this._fillOrDraw(r||"#000000"))},t.prototype.ellipse=function(t,e,i,s,r,n){void 0===n&&(n=0),this.ctx.beginPath(),this.ctx.ellipse(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,e*this.scale.x,i*this.scale.y,n,0,2*Math.PI),this.ctx.closePath(),this.ctx.lineWidth=r||1,this._fillOrDraw(s)},t.prototype.square=function(t,e,i,s){this.ctx.beginPath(),this.ctx.rect(this.offset.x+(t.x-e/2)*this.scale.x,this.offset.y+(t.y-e/2)*this.scale.y,e*this.scale.x,e*this.scale.y),this.ctx.closePath(),this.ctx.lineWidth=s||1,this._fillOrDraw(i)},t.prototype.grid=function(t,e,i,s,r,n){this.ctx.beginPath();for(var o=-Math.ceil(.5*i/r)*r,a=i/2,h=-Math.ceil(.5*e/s)*s;h<e/2;h+=s)this.ctx.moveTo(this.offset.x+(t.x+h)*this.scale.x,this.offset.y+(t.y+o)*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x+h)*this.scale.x,this.offset.y+(t.y+a)*this.scale.y);for(var l=-Math.ceil(.5*e/s)*s,c=e/2,u=-Math.ceil(.5*i/r)*r;u<i/2;u+=r)this.ctx.moveTo(this.offset.x+(t.x+l)*this.scale.x-4,this.offset.y+(t.y+u)*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x+c)*this.scale.x+4,this.offset.y+(t.y+u)*this.scale.y);this.ctx.strokeStyle=n,this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.closePath()},t.prototype.raster=function(t,e,i,s,r,n){this.ctx.save(),this.ctx.beginPath();for(var o=-Math.ceil(.5*e/s)*s;o<e/2;o+=s)for(var a=-Math.ceil(.5*i/r)*r;a<i/2;a+=r)this.ctx.moveTo(this.offset.x+(t.x+o)*this.scale.x-4,this.offset.y+(t.y+a)*this.scale.y),this.ctx.lineTo(this.offset.x+(t.x+o)*this.scale.x+4,this.offset.y+(t.y+a)*this.scale.y),this.ctx.moveTo(this.offset.x+(t.x+o)*this.scale.x,this.offset.y+(t.y+a)*this.scale.y-4),this.ctx.lineTo(this.offset.x+(t.x+o)*this.scale.x,this.offset.y+(t.y+a)*this.scale.y+4);this.ctx.strokeStyle=n,this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore()},t.prototype.diamondHandle=function(t,e,i){this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x-e/2,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y-e/2),this.ctx.lineTo(this.offset.x+t.x*this.scale.x+e/2,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y+e/2),this.ctx.closePath(),this.ctx.lineWidth=1,this._fillOrDraw(i)},t.prototype.squareHandle=function(t,e,i){this.ctx.beginPath(),this.ctx.rect(this.offset.x+t.x*this.scale.x-e/2,this.offset.y+t.y*this.scale.y-e/2,e,e),this.ctx.closePath(),this.ctx.lineWidth=1,this._fillOrDraw(i)},t.prototype.circleHandle=function(t,e,i){e=e||3,this.ctx.beginPath(),this.ctx.arc(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y,e,0,2*Math.PI,!1),this.ctx.closePath(),this.ctx.lineWidth=1,this._fillOrDraw(i)},t.prototype.crosshair=function(t,e,i){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(this.offset.x+t.x*this.scale.x-e,this.offset.y+t.y*this.scale.y),this.ctx.lineTo(this.offset.x+t.x*this.scale.x+e,this.offset.y+t.y*this.scale.y),this.ctx.moveTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y-e),this.ctx.lineTo(this.offset.x+t.x*this.scale.x,this.offset.y+t.y*this.scale.y+e),this.ctx.strokeStyle=i,this.ctx.lineWidth=.5,this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore()},t.prototype.polygon=function(t,e,i){this.polyline(t.vertices,t.isOpen,e,i)},t.prototype.polyline=function(t,e,i,s){if(!(t.length<=1)){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=s||1,this.ctx.moveTo(this.offset.x+t[0].x*this.scale.x,this.offset.y+t[0].y*this.scale.y);for(var r=0;r<t.length;r++)this.ctx.lineTo(this.offset.x+t[r].x*this.scale.x,this.offset.y+t[r].y*this.scale.y);e||this.ctx.closePath(),this._fillOrDraw(i),this.ctx.closePath(),this.ctx.setLineDash([]),this.ctx.restore()}},t.prototype.text=function(t,e,i,s){s=s||{},this.ctx.save(),e=this.offset.x+e*this.scale.x,i=this.offset.y+i*this.scale.y;var r=s.color||"black";this.fillShapes?(this.ctx.fillStyle=r,this.ctx.fillText(t,e,i)):(this.ctx.strokeStyle=r,this.ctx.strokeText(t,e,i)),this.ctx.restore()},t.prototype.label=function(t,e,i,s,r){this.ctx.save(),this.ctx.translate(e,i),void 0!==s&&this.ctx.rotate(s),this.ctx.fillStyle=r||"black",this.fillShapes?this.ctx.fillText(t,0,0):this.ctx.strokeText(t,0,0),this.ctx.restore()},t.prototype.path=function(t,e,i,s){var r=s&&s.inplace?t:n.drawutilssvg.copyPathData(t);n.drawutilssvg.transformPathData(r,this.offset,this.scale),this.ctx.strokeStyle=e,this.ctx.lineWidth=i||1,this.fillShapes?(this.ctx.fillStyle=e,this.ctx.fill(new Path2D(r.join(" ")))):(this.ctx.strokeStyle=e,this.ctx.stroke(new Path2D(r.join(" "))))},t.prototype.clear=function(t){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)},t}();e.drawutils=o},349:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.drawutilsgl=void 0;var s=i(421),r=function(){function t(e,i){this.gl=e,this.offset=new s.Vertex(0,0),this.scale=new s.Vertex(1,1),this.fillShapes=i,this._zindex=0,null!=e&&void 0!==e&&(this.glutils=new n(e),this._vertShader=this.glutils.compileShader(t.vertCode,this.gl.VERTEX_SHADER),this._fragShader=this.glutils.compileShader(t.fragCode,this.gl.FRAGMENT_SHADER),this._program=this.glutils.makeProgram(this._vertShader,this._fragShader),this.vertex_buffer=this.gl.createBuffer(),console.log("gl initialized"))}return t.prototype._x2rel=function(t){return(this.scale.x*t+this.offset.x)/this.gl.canvas.width*2-1},t.prototype._y2rel=function(t){return(this.offset.y-this.scale.y*t)/this.gl.canvas.height*2-1},t.prototype.copyInstance=function(e){var i=new t(null,e);return i.gl=this.gl,i.glutils=this.glutils,i._vertShader=this._vertShader,i._fragShader=this._fragShader,i._program=this._program,i},t.prototype.beginDrawCycle=function(t){this._zindex=0,this.renderTime=t},t.prototype.endDrawCycle=function(t){},t.prototype.setConfiguration=function(t){},t.prototype.setCurrentId=function(t){this.curId=t},t.prototype.setCurrentClassName=function(t){},t.prototype.line=function(t,e,i){var s=new Float32Array(6);s[0]=this._x2rel(t.x),s[1]=this._y2rel(t.y),s[2]=this._zindex,s[3]=this._x2rel(e.x),s[4]=this._y2rel(e.y),s[5]=this._zindex,this._zindex+=.001,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertex_buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,s,this.gl.STATIC_DRAW);var r=this.gl.getAttribLocation(this._program,"position");this.gl.vertexAttribPointer(r,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(r),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);var n=this.gl.getUniformLocation(this._program,"uRotationVector");this.gl.uniform2fv(n,[0,1]),this.gl.lineWidth(5),this.gl.drawArrays(this.gl.LINES,0,s.length/3)},t.prototype.arrow=function(t,e,i){},t.prototype.image=function(t,e,i){},t.prototype._fillOrDraw=function(t){},t.prototype.cubicBezier=function(t,e,i,s,r,n){},t.prototype.cubicBezierPath=function(t,e,i){},t.prototype.handle=function(t,e){},t.prototype.handleLine=function(t,e){},t.prototype.dot=function(t,e){},t.prototype.point=function(t,e){},t.prototype.circle=function(t,e,i,s){},t.prototype.circleArc=function(t,e,i,s,r,n){},t.prototype.ellipse=function(t,e,i,s,r,n){},t.prototype.square=function(t,e,i,s){},t.prototype.grid=function(t,e,i,s,r,n){},t.prototype.raster=function(t,e,i,s,r,n){},t.prototype.diamondHandle=function(t,e,i){},t.prototype.squareHandle=function(t,e,i){},t.prototype.circleHandle=function(t,e,i){},t.prototype.crosshair=function(t,e,i){},t.prototype.polygon=function(t,e,i){for(var s=new Float32Array(3*t.vertices.length),r=0;r<t.vertices.length;r++)s[3*r+0]=this._x2rel(t.vertices[r].x),s[3*r+1]=this._y2rel(t.vertices[r].y),s[3*r+2]=this._zindex;this._zindex+=.001,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertex_buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,s,this.gl.STATIC_DRAW);var n=this.gl.getAttribLocation(this._program,"position");this.gl.vertexAttribPointer(n,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(n),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);var o=this.gl.getUniformLocation(this._program,"uRotationVector");this.gl.uniform2fv(o,[0,1]),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,s.length/3)},t.prototype.polyline=function(t,e,i,s){},t.prototype.text=function(t,e,i,s){},t.prototype.label=function(t,e,i,s){},t.prototype.path=function(t,e,i,s){},t.prototype.clear=function(t){this.gl.clearColor(1,1,1,1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)},t.vertCode="\n    precision mediump float;\n\n    attribute vec3 position;\n\n    uniform vec2 uRotationVector;\n\n    void main(void) {\n\tvec2 rotatedPosition = vec2(\n\t    position.x * uRotationVector.y +\n\t\tposition.y * uRotationVector.x,\n\t    position.y * uRotationVector.y -\n\t\tposition.x * uRotationVector.x\n\t);\n\n\tgl_Position = vec4(rotatedPosition, position.z, 1.0);\n    }",t.fragCode="\n    precision highp float;\n\n    void main(void) {\n\tgl_FragColor = vec4(0.0,0.75,1.0,1.0);\n    }",t}();e.drawutilsgl=r;var n=function(){function t(t){this.gl=t}return t.prototype.bufferData=function(t){var e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),e},t.prototype.compileShader=function(t,e){var i=this.gl.createShader(e);return this.gl.shaderSource(i,t),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(console.warn("Error in shader:"+this.gl.getShaderInfoLog(i)),this.gl.deleteShader(i),null)},t.prototype.makeProgram=function(t,e){var i=this.gl.createProgram();return this.gl.attachShader(i,t),this.gl.attachShader(i,e),this.gl.linkProgram(i),this.gl.useProgram(i),this.gl.detachShader(i,t),this.gl.detachShader(i,e),this.gl.deleteShader(t),this.gl.deleteShader(e),i},t}()},829:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.drawutilssvg=void 0;var s=i(946),r=i(510),n=i(421),o=function(){function t(t,e,i,s,r,o,a,h,l){this.svgNode=t,this.offset=new n.Vertex(0,0).set(e),this.scale=new n.Vertex(1,1).set(i),this.fillShapes=r,this.isSecondary=a,this.drawlibConfiguration={},this.cache=new Map,this.setSize(s),a?(this.gNode=h,this.bufferGNode=l):(this.addStyleDefs(o),this.gNode=this.createSVGNode("g"),this.bufferGNode=this.createSVGNode("g"),this.svgNode.appendChild(this.gNode))}return t.prototype.addStyleDefs=function(t){var e=this.createSVGNode("style");this.svgNode.appendChild(e);var i={polygon:"Polygon",triangle:"Triangle",ellipse:"Ellipse",ellipseSector:"EllipseSector",circle:"Circle",circleSector:"CircleSector",vertex:"Vertex",line:"Line",vector:"Vector",image:"Image"},s=[];for(var r in i){var n=i[r],o=t[r];s.push("."+n+" { fill : none; stroke: "+o.color+"; stroke-width: "+o.lineWidth+"px }")}e.innerHTML=s.join("\n")},t.prototype.findElement=function(t,e){var i=this.cache.get(t);return i&&i.nodeName.toUpperCase()===e.toUpperCase()?(this.cache.delete(t),i):null},t.prototype.createSVGNode=function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)},t.prototype.makeNode=function(t){var e=this.findElement(this.curId,t);return e||(e=this.createSVGNode(t)),this.drawlibConfiguration.blendMode&&(e.style["mix-blend-mode"]=this.drawlibConfiguration.blendMode),e},t.prototype._bindFillDraw=function(t,e,i,s){return this.curClassName?t.setAttribute("class",this.curClassName+" "+e):t.setAttribute("class",e),t.setAttribute("fill",this.fillShapes?i:"none"),t.setAttribute("stroke",this.fillShapes?"none":i),t.setAttribute("stroke-width",""+(s||1)),this.curId&&t.setAttribute("id",""+this.curId),t.parentNode||this.bufferGNode.appendChild(t),t},t.prototype.setSize=function(t){this.canvasSize=t,this.svgNode.setAttribute("viewBox","0 0 "+this.canvasSize.width+" "+this.canvasSize.height),this.svgNode.setAttribute("width",""+this.canvasSize.width),this.svgNode.setAttribute("height",""+this.canvasSize.height)},t.prototype.copyInstance=function(e){return new t(this.svgNode,this.offset,this.scale,this.canvasSize,e,null,!0,this.gNode,this.bufferGNode)},t.prototype.setConfiguration=function(t){this.drawlibConfiguration=t},t.prototype.setCurrentId=function(t){this.curId=t},t.prototype.setCurrentClassName=function(t){this.curClassName=t},t.prototype.beginDrawCycle=function(t){this.cache.clear();for(var e=0;e<this.bufferGNode.childNodes.length;e++){var i=this.bufferGNode.childNodes[e];this.cache.set(i.getAttribute("id"),i)}this.removeAllChildNodes()},t.prototype.endDrawCycle=function(t){this.isSecondary||this.svgNode.replaceChild(this.bufferGNode,this.gNode);var e=this.gNode;this.gNode=this.bufferGNode,this.bufferGNode=e},t.prototype._x=function(t){return this.offset.x+this.scale.x*t},t.prototype._y=function(t){return this.offset.y+this.scale.y*t},t.prototype.line=function(t,e,i,s){var r=this.makeNode("line");return r.setAttribute("x1",""+this._x(t.x)),r.setAttribute("y1",""+this._y(t.y)),r.setAttribute("x2",""+this._x(e.x)),r.setAttribute("y2",""+this._y(e.y)),this._bindFillDraw(r,"line",i,s||1)},t.prototype.arrow=function(t,e,i,s){for(var r=this.makeNode("path"),o=n.Vertex.utils.buildArrowHead(t,e,8,this.scale.x,this.scale.y),a=["M",this._x(t.x),this._y(t.y)],h=0;h<=o.length;h++)a.push("L"),a.push(this.offset.x+o[h%o.length].x),a.push(this.offset.y+o[h%o.length].y);return r.setAttribute("d",a.join(" ")),this._bindFillDraw(r,"arrow",i,s||1)},t.prototype.image=function(t,e,i){var s=this,r=this.makeNode("image"),n=function(t){if(t.naturalWidth){var n=i.x/t.naturalWidth,o=i.y/t.naturalHeight;r.setAttribute("width",""+t.naturalWidth*s.scale.x),r.setAttribute("height",""+t.naturalHeight*s.scale.y),r.setAttribute("display",null),r.setAttribute("transform","translate("+s._x(e.x)+" "+s._y(e.y)+") scale("+n+" "+o+")")}};return t.addEventListener("load",(function(e){n(t)})),r.setAttribute("x","0"),r.setAttribute("y","0"),r.setAttribute("display","none"),n(t),r.setAttribute("href",t.src),this._bindFillDraw(r,"image",null,null)},t.prototype.cubicBezier=function(t,e,i,s,n,o){if(t instanceof r.CubicBezierCurve)return this.cubicBezier(t.startPoint,t.endPoint,t.startControlPoint,t.endControlPoint,n,o);var a=this.makeNode("path"),h=["M",this._x(t.x),this._y(t.y),"C",this._x(i.x),this._y(i.y),this._x(s.x),this._y(s.y),this._x(e.x),this._y(e.y)];return a.setAttribute("d",h.join(" ")),this._bindFillDraw(a,"cubierBezier",n,o)},t.prototype.cubicBezierPath=function(t,e,i){var s=this.makeNode("path");if(!t||0==t.length)return s;for(var r,n,o,a=["M",this._x(t[0].x),this._y(t[0].y)],h=1;h<t.length;h+=3)n=t[h],o=t[h+1],r=t[h+2],a.push("C",this._x(n.x),this._y(n.y),this._x(o.x),this._y(o.y),this._x(r.x),this._y(r.y));return s.setAttribute("d",a.join(" ")),this._bindFillDraw(s,"cubicBezierPath",e,i||1)},t.prototype.handle=function(t,e){this.point(t,"rgb(0,32,192)"),this.square(e,5,"rgba(0,128,192,0.5)")},t.prototype.handleLine=function(t,e){this.line(t,e,"rgb(192,192,192)")},t.prototype.dot=function(t,e){var i=this.makeNode("line");return this._bindFillDraw(i,"dot",e,1)},t.prototype.point=function(t,e){var i=this.makeNode("circle");return i.setAttribute("cx",""+this._x(t.x)),i.setAttribute("cy",""+this._y(t.y)),i.setAttribute("r","3"),this._bindFillDraw(i,"point",e,1)},t.prototype.circle=function(t,e,i,s){var r=this.makeNode("circle");return r.setAttribute("cx",""+this._x(t.x)),r.setAttribute("cy",""+this._y(t.y)),r.setAttribute("r",""+e*this.scale.x),this._bindFillDraw(r,"circle",i,s||1)},t.prototype.circleArc=function(t,e,i,r,n,o){var a=this.makeNode("path"),h=s.CircleSector.circleSectorUtils.describeSVGArc(this._x(t.x),this._y(t.y),e*this.scale.x,i,r);return a.setAttribute("d",h.join(" ")),this._bindFillDraw(a,"circleArc",n,o||1)},t.prototype.ellipse=function(t,e,i,s,r,n){void 0===n&&(n=0);var o=this.makeNode("ellipse");return o.setAttribute("cx",""+this._x(t.x)),o.setAttribute("cy",""+this._y(t.y)),o.setAttribute("rx",""+e*this.scale.x),o.setAttribute("ry",""+i*this.scale.y),o.setAttribute("transform","rotate("+180*n/Math.PI+" "+this._x(t.x)+" "+this._y(t.y)+")"),this._bindFillDraw(o,"ellipse",s,r||1)},t.prototype.square=function(t,e,i,s){var r=this.makeNode("rectangle");return r.setAttribute("x",""+this._x(t.x-e/2)),r.setAttribute("y",""+this._y(t.y-e/2)),r.setAttribute("width",""+e*this.scale.x),r.setAttribute("height",""+e*this.scale.y),this._bindFillDraw(r,"square",i,s||1)},t.prototype.grid=function(t,e,i,s,r,n){for(var o=this.makeNode("path"),a=[],h=-Math.ceil(.5*i/r)*r,l=i/2,c=-Math.ceil(.5*e/s)*s;c<e/2;c+=s)a.push("M",this._x(t.x+c),this._y(t.y+h)),a.push("L",this._x(t.x+c),this._y(t.y+l));for(var u=-Math.ceil(.5*e/s)*s,d=e/2,p=-Math.ceil(.5*i/r)*r;p<i/2;p+=r)a.push("M",this._x(t.x+u),this._y(t.y+p)),a.push("L",this._x(t.x+d),this._y(t.y+p));return o.setAttribute("d",a.join(" ")),this._bindFillDraw(o,"grid",n,1)},t.prototype.raster=function(t,e,i,s,r,n){for(var o=this.makeNode("path"),a=[],h=-Math.ceil(.5*e/s)*s;h<e/2;h+=s)for(var l=-Math.ceil(.5*i/r)*r;l<i/2;l+=r)a.push("M",this._x(t.x+h)-4,this._y(t.y+l)),a.push("L",this._x(t.x+h)+4,this._y(t.y+l)),a.push("M",this._x(t.x+h),this._y(t.y+l)-4),a.push("L",this._x(t.x+h),this._y(t.y+l)+4);return o.setAttribute("d",a.join(" ")),this._bindFillDraw(o,"raster",n,1)},t.prototype.diamondHandle=function(t,e,i){var s=this.makeNode("path"),r=["M",this._x(t.x)-e/2,this._y(t.y),"L",this._x(t.x),this._y(t.y)-e/2,"L",this._x(t.x)+e/2,this._y(t.y),"L",this._x(t.x),this._y(t.y)+e/2,"Z"];return s.setAttribute("d",r.join(" ")),this._bindFillDraw(s,"diamondHandle",i,1)},t.prototype.squareHandle=function(t,e,i){var s=this.makeNode("rect");return s.setAttribute("x",""+(this._x(t.x)-e/2)),s.setAttribute("y",""+(this._y(t.y)-e/2)),s.setAttribute("width",""+e),s.setAttribute("height",""+e),this._bindFillDraw(s,"squareHandle",i,1)},t.prototype.circleHandle=function(t,e,i){e=e||3;var s=this.makeNode("circle");return s.setAttribute("cx",""+this._x(t.x)),s.setAttribute("cy",""+this._y(t.y)),s.setAttribute("r",""+e),this._bindFillDraw(s,"circleHandle",i,1)},t.prototype.crosshair=function(t,e,i){var s=this.makeNode("path"),r=["M",this._x(t.x)-e,this._y(t.y),"L",this._x(t.x)+e,this._y(t.y),"M",this._x(t.x),this._y(t.y)-e,"L",this._x(t.x),this._y(t.y)+e];return s.setAttribute("d",r.join(" ")),this._bindFillDraw(s,"crosshair",i,.5)},t.prototype.polygon=function(t,e,i){return this.polyline(t.vertices,t.isOpen,e,i)},t.prototype.polyline=function(t,e,i,s){var r=this.makeNode("path");if(0==t.length)return r;for(var n=["M",this._x(t[0].x),this._y(t[0].y)],o=t.length,a=1;a<o;a++)n.push("L",this._x(t[a].x),this._y(t[a].y));return e||n.push("Z"),r.setAttribute("d",n.join(" ")),this._bindFillDraw(r,"polyline",i,s||1)},t.prototype.text=function(t,e,i,s){var r=(s=s||{}).color||"black",n=this.makeNode("text");return n.setAttribute("x",""+this._x(e)),n.setAttribute("y",""+this._y(i)),n.innerHTML=t,this._bindFillDraw(n,"text",r,1)},t.prototype.label=function(t,e,i,s){var r=this.makeNode("text");return r.setAttribute("transform","translate("+this.offset.x+","+this.offset.y+"), rotate("+s/Math.PI*180+")"),r.innerHTML=t,this._bindFillDraw(r,"label","black",null)},t.prototype.path=function(e,i,s,r){var n=this.makeNode("path"),o=r&&r.inplace?e:t.copyPathData(e);return t.transformPathData(o,this.offset,this.scale),n.setAttribute("d",o.join(" ")),this._bindFillDraw(n,"path",i,s)},t.prototype.clear=function(t){if(!this.isSecondary){this.curId="background",this.curClassName=void 0;var e=this.makeNode("rect");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width",""+this.canvasSize.width),e.setAttribute("height",""+this.canvasSize.height),this._bindFillDraw(e,this.curId,null,null),e.setAttribute("fill",void 0===t?"none":t),this.curId=void 0}},t.prototype.removeAllChildNodes=function(){for(;this.bufferGNode.lastChild;)this.bufferGNode.removeChild(this.bufferGNode.lastChild)},t.createSvg=function(){return document.createElementNS("http://www.w3.org/2000/svg","svg")},t.copyPathData=function(t){for(var e=new Array(t.length),i=0,s=t.length;i<s;i++)e[i]=t[i];return e},t.transformPathData=function(t,e,i){for(var s=function(s){t[s]=e.x+i.x*Number(t[s])},r=function(s){t[s]=e.y+i.y*Number(t[s])},n=function(e){t[e]=i.x*Number(t[e])},o=function(e){t[e]=i.y*Number(t[e])},a=0,h={x:NaN,y:NaN},l=function(e){h.x=Number(t[e]),h.y=Number(t[e+1])};a<t.length;)switch(t[a]){case"M":case"L":case"T":s(a+1),r(a+2),l(a+1),a+=3;break;case"m":case"l":case"t":n(a+1),o(a+2),l(a+1),a+=3;break;case"H":s(a+1),h.x=Number(t[a+1]),a+=2;break;case"h":n(a+1),h.x=Number(t[a+1]),a+=2;break;case"V":r(a+1),h.y=Number(t[a+1]),a+=2;break;case"v":o(a+1),h.y=Number(t[a+1]),a+=2;break;case"C":s(a+1),r(a+2),s(a+3),r(a+4),s(a+5),r(a+6),l(a+5),a+=7;break;case"c":n(a+1),o(a+2),n(a+3),o(a+4),n(a+5),o(a+6),l(a+5),a+=7;break;case"S":case"Q":s(a+1),r(a+2),s(a+3),r(a+4),l(a+3),a+=5;break;case"s":case"q":n(a+1),o(a+2),n(a+3),o(a+4),l(a+3),a+=5;break;case"A":n(a+1),o(a+2),s(a+6),r(a+7),l(a+6),(i.x<0&&i.y>=0||i.x>=0&&i.y<0)&&(t[a+5]=t[a+5]?0:1),a+=8;break;case"a":n(a+1),o(a+2),n(a+6),o(a+7),l(a+6),a+=8;break;case"z":case"Z":a++;break;default:a++}},t.HEAD_XML=['<?xml version="1.0" encoding="UTF-8" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" ','         "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">',""].join("\n"),t}();e.drawutilssvg=o},22:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.geomutils=void 0;var s=i(831),r=i(212);e.geomutils={nsectAngle:function(t,e,i,n){var o=new r.Triangle(t,e,i),a=new s.Line(t,e),h=new s.Line(t,i),l=a.angle(h),c=o.determinant()>0;l<0&&(l=2*Math.PI+l),c||(l=-1*(2*Math.PI-l));for(var u=Math.max(a.length(),h.length())/a.length(),d=[],p=1;p<n;p++)d.push(new s.Line(t,e.clone().rotate(l/n*-p,t)).scale(u));return d},wrapMax:function(t,e){return(e+t%e)%e},wrapMinMax:function(t,i,s){return i+e.geomutils.wrapMax(t-i,s-i)}}}},e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={exports:{}};return t[s].call(r.exports,r,r.exports,i),r.exports}i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},globalThis.UIDGenerator=i(197).UIDGenerator,globalThis.VertexAttr=i(861).VertexAttr,globalThis.VertexListeners=i(76).VertexListeners,globalThis.Vertex=i(421).Vertex,globalThis.Bounds=i(262).Bounds,globalThis.Grid=i(843).Grid,globalThis.Line=i(831).Line,globalThis.Vector=i(73).Vector,globalThis.CubicBezierCurve=i(510).CubicBezierCurve,globalThis.BezierPath=i(126).BezierPath,globalThis.Polygon=i(661).Polygon,globalThis.Triangle=i(212).Triangle,globalThis.VEllipse=i(112).VEllipse,globalThis.Circle=i(913).Circle,globalThis.CircleSector=i(946).CircleSector,globalThis.PBImage=i(699).PBImage,globalThis.MouseHandler=i(293).MouseHandler,globalThis.KeyHandler=i(909).KeyHandler,globalThis.drawutils=i(149).drawutils,globalThis.drawutilssvg=i(829).drawutilssvg,globalThis.geomutils=i(22).geomutils,globalThis.PlotBoilerplate=i(919).H4})();
//# sourceMappingURL=plotboilerplate.browser.min.js.map